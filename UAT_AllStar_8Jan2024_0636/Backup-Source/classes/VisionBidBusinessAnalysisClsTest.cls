@isTest
public class VisionBidBusinessAnalysisClsTest {
    static testmethod void  test(){
        Profile p = [SELECT Id FROM Profile WHERE Name='Standard User'];
        User u = new User(Alias = 'standt', Email='testmmm@testorg.com', EmailEncodingKey='UTF-8', LastName='Testing', LanguageLocaleKey='en_US', LocaleSidKey='en_US', ProfileId = p.Id, TimeZoneSidKey='America/Los_Angeles', UserName='testmmm@testorg.com', Division='Rx');
        insert u;
        Account acc = new Account();
        acc.Name = 'Test Account';
        acc.Owner = u;
        insert acc;
        Product_Family__c pf = new Product_Family__c();
        pf.Name = 'Test Family';
        insert pf;
        Product2 prod = new Product2();
        prod.Name = 'Test Product';
        prod.ProductCode = '1234567';
        prod.Phoenix_Rx_SRx_OTC__c = 'Rx';
        prod.Family = 'Test Family';
        insert prod;    
        Product2 prod2 = new Product2();
        prod2.Name = 'Test Product2';
        prod2.ProductCode = '1234568';
        prod2.Phoenix_Rx_SRx_OTC__c = 'SRx';
        prod2.Family = 'Test Family2';
        insert prod2; 
        
        Phoenix_Contract__c cont = new Phoenix_Contract__c();
        cont.Name = 'Test';
        cont.Phoenix_Contract_Number__c = '1234';
        cont.Phoenix_Customer__c = acc.Id;
        insert cont;
        
        
        Phoenix_Customer_Response_Line__c crLine = new Phoenix_Customer_Response_Line__c();
        crLine.Phoenix_Award_Position__c = 'P1';
        //crLine.Customer_Response_Duration__r= system.today();
        insert crLine;
        Phoenix_Bid__c bid = new Phoenix_Bid__c();
        bid.Phoenix_Bid_Name__c = 'Test Bid';
        bid.Phoenix_Bid_Type__c = 'Product Addition';
        bid.OwnerId = u.Id;
        bid.Phoenix_Customer_Type__c = 'Net Indirect Pricing';
        bid.Phoenix_Customer__c = acc.id;
        bid.Phoenix_Approval_Status__c = 'Customer\'s Update';
        bid.Phoenix_Bid_Submitted_Date__c = system.today();
        bid.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid;

        Phoenix_Bid_Line_Item__c bidLine = new Phoenix_Bid_Line_Item__c();
        bidLine.Phoenix_Bid__c = bid.id;
        bidLine.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine.Phoenix_Product__c = prod.Id;
        bidLine.Phoenix_Contract__c = cont.Id;
        bidLine.Phoenix_Bid_Status__c = '';
        bidLine.Phoenix_Proposed_Sales__c = 1000;
        bidLine.Phoenix_Current_Direct_Price__c = 100;
        insert bidLine;
        Phoenix_Bid_Line_Item__c bidLine12 = new Phoenix_Bid_Line_Item__c();
        bidLine12.Phoenix_Bid__c = bid.id;
        bidLine12.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine12.Phoenix_Product__c = prod.Id;
        bidLine12.Phoenix_Contract__c = cont.Id;
        bidLine12.Phoenix_Bid_Status__c = '';
        bidLine12.Phoenix_Proposed_Sales__c = 1000;
        bidLine12.Phoenix_Current_Direct_Price__c = 0;
        bidLine12.Phoenix_Current_Indirect_Price__c = 0;
        insert bidLine12;
        Phoenix_Customer_Response__c custResponse1 = new Phoenix_Customer_Response__c();
        custResponse1.Phoenix_Bid_No__c = bid.Id;
        insert custResponse1;
        Phoenix_Customer_Response_Line__c custResponseLine11 = new Phoenix_Customer_Response_Line__c();
        custResponseLine11.Phoenix_Bid__c = bid.Id;
        custResponseLine11.Phoenix_Bid_Line_Item__c = bidLine12.Id;
        custResponseLine11.Phoenix_Bid_Status__c = 'Awarded';
        custResponseLine11.Phoenix_Customer_Response__c = custResponse1.Id;
        insert custResponseLine11;
        Phoenix_BidLineItemExtn__c bidExtnObj = new Phoenix_BidLineItemExtn__c();
        bidExtnObj.Phoenix_Bid_Line_Item__c = bidLine.Id;
        bidExtnObj.Vision_Category__c = 'No Effect';
        insert bidExtnObj;
        
        Phoenix_Bid__c bid31 = new Phoenix_Bid__c();
        bid31.Phoenix_Bid_Name__c = 'Test Bid3';
        bid31.Phoenix_Bid_Type__c = 'OTC New Product';
        bid31.Phoenix_Customer__c = acc.id;
        bid31.Phoenix_Approval_Status__c = 'Closed';
        bid31.Phoenix_Customer_Type__c = 'Net Indirect Pricing';
        bid31.Phoenix_Bid_Submitted_Date__c = system.today();
        bid31.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid31;
        Phoenix_Bid_Line_Item__c bidLine31 = new Phoenix_Bid_Line_Item__c();
        bidLine31.Phoenix_Bid__c = bid31.id;
        bidLine31.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine31.Phoenix_Customer_Approval_OTC__c = '';
        bidLine31.Phoenix_Product__c = prod.Id;
        bidLine31.Phoenix_Contract__c = cont.Id;
        bidLine31.Phoenix_Bid_Status__c = '';
        bidLine31.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine31;
        Phoenix_Bid_Line_Item__c bidLine41 = new Phoenix_Bid_Line_Item__c();
        bidLine41.Phoenix_Bid__c = bid31.id;
        bidLine41.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine41.Phoenix_Customer_Approval_OTC__c = 'Not Approved';
        bidLine41.Phoenix_Product__c = prod.Id;
        bidLine41.Phoenix_Contract__c = cont.Id;
        bidLine41.Phoenix_Bid_Status__c = 'Awarded';
        bidLine41.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine41;
        Phoenix_BidLineItemExtn__c bidExtnObj31 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj31.Phoenix_Bid_Line_Item__c = bidLine31.Id;
        bidExtnObj31.Vision_Category__c = 'No Effect';
        insert bidExtnObj31;
        Phoenix_BidLineItemExtn__c bidExtnObj41 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj41.Phoenix_Bid_Line_Item__c = bidLine41.Id;
        bidExtnObj41.Vision_Category__c = 'No Effect';
        insert bidExtnObj41;
        
        Phoenix_Customer_Response__c custResponse = new Phoenix_Customer_Response__c();
        custResponse.Phoenix_Bid_No__c = bid.Id;
        insert custResponse;
        Phoenix_Customer_Response_Line__c custResponseLine = new Phoenix_Customer_Response_Line__c();
        custResponseLine.Phoenix_Bid__c = bid.Id;
        custResponseLine.Phoenix_Bid_Line_Item__c = bidLine.Id;
        custResponseLine.Bid_Line_Item_Extn__c = bidExtnObj.Id;
        custResponseLine.Phoenix_Bid_Status__c = 'Awarded';
        custResponseLine.Phoenix_Customer_Response__c = custResponse.Id;
        insert custResponseLine;
        
        Phoenix_Bid__c bid2 = new Phoenix_Bid__c();
        bid2.Phoenix_Bid_Name__c = 'Test Bid2';
        bid2.Phoenix_Bid_Type__c = 'Product Discontinuation Process';
        bid2.Phoenix_Customer__c = acc.id;
        bid2.OwnerId = u.Id;
        bid2.Phoenix_Approval_Status__c = 'Closed';
        bid2.Phoenix_Bid_Submitted_Date__c = system.today();
        bid2.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid2;
        Phoenix_Bid_Line_Item__c bidLine2 = new Phoenix_Bid_Line_Item__c();
        bidLine2.Phoenix_Bid__c = bid2.id;
        bidLine2.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine2.Phoenix_Product__c = prod.Id;
        bidLine2.Phoenix_Bid_Status__c = 'Awarded';
        bidLine2.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine2;
        Phoenix_BidLineItemExtn__c bidExtnObj2 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj2.Phoenix_Bid_Line_Item__c = bidLine2.Id;
        bidExtnObj2.Vision_Category__c = 'No Effect';
        bidExtnObj2.Vision_Effective_Date_of_Removal__c = '11/20/2022';
        insert bidExtnObj2;
        Phoenix_Bid__c bid3 = new Phoenix_Bid__c();
        bid3.Phoenix_Bid_Name__c = 'Test Bid3';
        bid3.Phoenix_Bid_Type__c = 'OTC New Product';
        bid3.Phoenix_Customer__c = acc.id;
        bid3.Phoenix_Customer_Type__c = 'Net Indirect Pricing';
        bid3.OwnerId = u.Id;
        bid3.Phoenix_Approval_Status__c = 'Cus';
        bid3.Phoenix_Bid_Submitted_Date__c = system.today();
        bid3.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid3;
        Phoenix_Bid_Line_Item__c bidLine3 = new Phoenix_Bid_Line_Item__c();
        bidLine3.Phoenix_Bid__c = bid3.id;
        bidLine3.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine3.Phoenix_Customer_Approval_OTC__c = '';
        bidLine3.Phoenix_Product__c = prod.Id;
        bidLine3.Phoenix_Contract__c = cont.Id;
        bidLine3.Phoenix_Bid_Status__c = 'Awarded';
        bidLine3.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine3;
        Phoenix_Bid_Line_Item__c bidLine4 = new Phoenix_Bid_Line_Item__c();
        bidLine4.Phoenix_Bid__c = bid3.id;
        bidLine4.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine4.Phoenix_Customer_Approval_OTC__c = '';
        bidLine4.Phoenix_Product__c = prod.Id;
        bidLine4.Phoenix_Contract__c = cont.Id;
        bidLine4.Phoenix_Bid_Status__c = 'Awarded';
        bidLine4.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine4;
        Phoenix_BidLineItemExtn__c bidExtnObj3 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj3.Phoenix_Bid_Line_Item__c = bidLine3.Id;
        bidExtnObj3.Vision_Category__c = 'No Effect';
        insert bidExtnObj3;
        Phoenix_BidLineItemExtn__c bidExtnObj4 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj4.Phoenix_Bid_Line_Item__c = bidLine4.Id;
        bidExtnObj4.Vision_Category__c = 'No Effect';
        insert bidExtnObj4;        
        
        List<String> selectedBidIds = new List<String>();
        selectedBidIds.add(bid.Id);
        selectedBidIds.add(bid2.Id);
        selectedBidIds.add(bid3.Id);
        Phoenix_NPR_Data__c npr = new Phoenix_NPR_Data__c();
        npr.Phoenix_Account__c = acc.Id;
        npr.Phoenix_Contract__c = cont.Id;
        npr.Phoenix_Product__c = prod2.Id;
        npr.Phoenix_12Months_Sales_Unit__c = 40;
        npr.Phoenix_Dead_Net_Tracking_GR__c = 60;
        insert npr;
        List<String> selections = new List<String>{'Rx', 'SRx', 'OTC'};
        Date d1=Date.newInstance(2022,01,01);
        Date d2=Date.newInstance(2022,12,31);
        
        VisionBidBusinessAnalysisCls.getData(acc.Id, acc.Id, selections, d1, d2, 'All', 'Bid Submitted Date', 'Salesperson', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Bid Submitted Date', 'Salesperson', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'SRx', 'Bid Closed Date', 'Salesperson', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(acc.Owner.Id, acc.Id, selections, d1, d2, 'All', 'Bid Submitted Date', 'Account Director', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Bid Submitted Date', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(acc.Owner.Id, null, selections, d1, d2, 'SRx', 'Bid Closed Date', 'Product Director', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Customer Response Date', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Submitted/Closed', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Pending', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Sent to Customer Date', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Internal Rejections', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getFamilies(prod.Family);
        //VisionBidBusinessAnalysisCls.testCov();
    }

    static testmethod void  test2(){
        Account acc = new Account();
        acc.Name = 'Test Account';
        insert acc;
        Profile p = [SELECT Id FROM Profile WHERE Name='Standard User'];
        User u = new User(Alias = 'standt', Email='testmmm@testorg.com', 
                          EmailEncodingKey='UTF-8', LastName='Testing', LanguageLocaleKey='en_US', 
                          LocaleSidKey='en_US', ProfileId = p.Id, 
                          TimeZoneSidKey='America/Los_Angeles', UserName='testmmm@testorg.com', Division='Rx');
        insert u;
        Product2 prod = new Product2();
        prod.Name = 'Test Product';
        prod.ProductCode = '1234567';
        prod.Phoenix_Rx_SRx_OTC__c = 'Rx';
        insert prod;    
        Product2 prod2 = new Product2();
        prod2.Name = 'Test Product2';
        prod2.ProductCode = '1234568';
        prod2.Phoenix_Rx_SRx_OTC__c = 'SRx';
        insert prod2; 
        
        Phoenix_Contract__c cont = new Phoenix_Contract__c();
        cont.Name = 'Test';
        cont.Phoenix_Contract_Number__c = '1234';
        cont.Phoenix_Customer__c = acc.Id;
        insert cont;
        
        Phoenix_Customer_Response_Line__c crLine = new Phoenix_Customer_Response_Line__c();
        crLine.Phoenix_Award_Position__c = 'P1';
        //crLine.Customer_Response_Duration__r= system.today();
        insert crLine;
        Phoenix_Bid__c bid2 = new Phoenix_Bid__c();
        bid2.Phoenix_Bid_Name__c = 'Test Bid2';
        bid2.Phoenix_Bid_Type__c = 'Product Discontinuation Process';
        bid2.Phoenix_Customer__c = acc.id;
        bid2.OwnerId = u.Id;
        bid2.Phoenix_Approval_Status__c = 'Closed';
        bid2.Phoenix_Bid_Submitted_Date__c = system.today();
        bid2.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid2;
        Phoenix_Bid_Line_Item__c bidLine2 = new Phoenix_Bid_Line_Item__c();
        bidLine2.Phoenix_Bid__c = bid2.id;
        bidLine2.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine2.Phoenix_Product__c = prod.Id;
        bidLine2.Phoenix_Bid_Status__c = 'Awarded';
        bidLine2.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine2;
        Phoenix_BidLineItemExtn__c bidExtnObj2 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj2.Phoenix_Bid_Line_Item__c = bidLine2.Id;
        bidExtnObj2.Vision_Category__c = 'No Effect';
        bidExtnObj2.Vision_Effective_Date_of_Removal__c = '11/20/2022';
        insert bidExtnObj2;
        Phoenix_Bid__c bid5 = new Phoenix_Bid__c();
        bid5.Phoenix_Bid_Name__c = 'Test Bid';
        bid5.Phoenix_Bid_Type__c = 'Product Addition';
        bid5.OwnerId = u.Id;
        bid5.Phoenix_Customer_Type__c = 'BASE/DSH';
        bid5.Phoenix_Customer__c = acc.id;
        bid5.Phoenix_Approval_Status__c = 'Closed';
        bid5.Phoenix_Bid_Submitted_Date__c = system.today();
        bid5.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid5;
        Phoenix_Bid_Line_Item__c bidLine5 = new Phoenix_Bid_Line_Item__c();
        bidLine5.Phoenix_Bid__c = bid5.id;
        bidLine5.Phoenix_Product__c = prod.Id;
        bidLine5.Phoenix_Contract__c = cont.Id;
        bidLine5.Phoenix_Bid_Status__c = '';
        bidLine5.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine5;
        Phoenix_BidLineItemExtn__c bidExtnObj5 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj5.Phoenix_Bid_Line_Item__c = bidLine5.Id;
        bidExtnObj5.Vision_Category__c = 'No Effect';
        insert bidExtnObj5;
        
        Phoenix_Customer_Response__c custResponse5 = new Phoenix_Customer_Response__c();
        custResponse5.Phoenix_Bid_No__c = bid5.Id;
        insert custResponse5;
        Phoenix_Customer_Response_Line__c custResponseLine5 = new Phoenix_Customer_Response_Line__c();
        custResponseLine5.Phoenix_Bid__c = bid5.Id;
        custResponseLine5.Phoenix_Bid_Line_Item__c = bidLine5.Id;
        custResponseLine5.Bid_Line_Item_Extn__c = bidExtnObj5.Id;
        custResponseLine5.Phoenix_Bid_Status__c = 'Declined by Customer';
        custResponseLine5.Phoenix_Customer_Response__c = custResponse5.Id;
        insert custResponseLine5;
        
        
        Phoenix_NPR_Data__c npr = new Phoenix_NPR_Data__c();
        npr.Phoenix_Account__c = acc.Id;
        npr.Phoenix_Contract__c = cont.Id;
        npr.Phoenix_Product__c = prod2.Id;
        npr.Phoenix_12Months_Sales_Unit__c = 40;
        npr.Phoenix_Dead_Net_Tracking_GR__c = 60;
        insert npr;
        List<String> selectedBidIds = new List<String>();
        selectedBidIds.add(bid2.Id);
        selectedBidIds.add(bid5.Id);
        
        List<String> selections = new List<String>{'Rx', 'SRx', 'OTC'};
        Date d1=Date.newInstance(2022,01,01);
        Date d2=Date.newInstance(2022,12,31);
        
        VisionBidBusinessAnalysisCls.getData(acc.Id, acc.Id, selections, d1, d2, 'All', 'Bid Submitted Date', 'Account Director', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Bid Submitted Date', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'SRx', 'Bid Closed Date', 'Account Director', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(acc.Id, acc.Id, selections, d1, d2, 'All', 'Bid Submitted Date', 'Salesperson', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(acc.Id, acc.Id, selections, d1, d2, 'All', 'Bid Submitted Date', 'Product Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(acc.Id, acc.Id, selections, d1, d2, 'All', 'Bid Submitted Date', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Bid Submitted Date', 'Salesperson', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'SRx', 'Bid Closed Date', 'Salesperson', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'SRx', 'Bid Closed Date', 'Salesperson', prod.Family, false, selectedBidIds);
    }
    
    static testmethod void  test3(){
        Account acc = new Account();
        acc.Name = 'Test Account';
        insert acc;
        Profile p = [SELECT Id FROM Profile WHERE Name='Standard User'];
        User u = new User(Alias = 'standt', Email='testmmm@testorg.com', 
                          EmailEncodingKey='UTF-8', LastName='Testing', LanguageLocaleKey='en_US', 
                          LocaleSidKey='en_US', ProfileId = p.Id, 
                          TimeZoneSidKey='America/Los_Angeles', UserName='testmmm@testorg.com', Division='Rx');
        insert u;
        Product2 prod = new Product2();
        prod.Name = 'Test Product';
        prod.ProductCode = '1234567';
        prod.Phoenix_Rx_SRx_OTC__c = 'Rx';
        insert prod;    
        Product2 prod2 = new Product2();
        prod2.Name = 'Test Product2';
        prod2.ProductCode = '1234568';
        prod2.Phoenix_Rx_SRx_OTC__c = 'SRx';
        insert prod2; 
        
        Phoenix_Contract__c cont = new Phoenix_Contract__c();
        cont.Name = 'Test';
        cont.Phoenix_Contract_Number__c = '1234';
        cont.Phoenix_Customer__c = acc.Id;
        insert cont;
        Phoenix_Customer_Response_Line__c crLine = new Phoenix_Customer_Response_Line__c();
        crLine.Phoenix_Award_Position__c = 'P1';
        //crLine.Customer_Response_Duration__r= system.today();
        insert crLine;
        
        Phoenix_Bid__c bid2 = new Phoenix_Bid__c();
        bid2.Phoenix_Bid_Name__c = 'Test Bid2';
        bid2.Phoenix_Bid_Type__c = 'Price Change';
        bid2.Phoenix_Customer__c = acc.id;
        bid2.OwnerId = u.Id;
        bid2.Phoenix_Approval_Status__c = 'Closed';
        bid2.Phoenix_Bid_Submitted_Date__c = system.today();
        bid2.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid2;
        Phoenix_Bid_Line_Item__c bidLine2 = new Phoenix_Bid_Line_Item__c();
        bidLine2.Phoenix_Bid__c = bid2.id;
        bidLine2.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine2.Phoenix_Product__c = prod.Id;
        bidLine2.Phoenix_Bid_Status__c = 'Awarded';
        bidLine2.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine2;
        Phoenix_BidLineItemExtn__c bidExtnObj2 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj2.Phoenix_Bid_Line_Item__c = bidLine2.Id;
        bidExtnObj2.Vision_Category__c = 'No Effect';
        bidExtnObj2.Vision_Effective_Date_of_Removal__c = '11/20/2022';
        insert bidExtnObj2;
        Phoenix_Bid__c bid6 = new Phoenix_Bid__c();
        bid6.Phoenix_Bid_Name__c = 'Test Bid';
        bid6.Phoenix_Bid_Type__c = 'Product Addition';
        bid6.Phoenix_Customer_Type__c = 'ROS';
        bid6.OwnerId = u.Id;
        bid6.Phoenix_Customer__c = acc.id;
        bid6.Phoenix_Approval_Status__c = 'Closed';
        bid6.Phoenix_Bid_Submitted_Date__c = system.today();
        bid6.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid6;
        Phoenix_Bid_Line_Item__c bidLine6 = new Phoenix_Bid_Line_Item__c();
        bidLine6.Phoenix_Bid__c = bid6.id;
        bidLine6.Phoenix_Product__c = prod.Id;
        bidLine6.Phoenix_Contract__c = cont.Id;
        bidLine6.Phoenix_Bid_Status__c = 'Awarded';
        bidLine6.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine6;
        Phoenix_BidLineItemExtn__c bidExtnObj6 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj6.Phoenix_Bid_Line_Item__c = bidLine6.Id;
        bidExtnObj6.Vision_Category__c = 'No Effect';
        insert bidExtnObj6;
        
        Phoenix_Customer_Response__c custResponse6 = new Phoenix_Customer_Response__c();
        custResponse6.Phoenix_Bid_No__c = bid6.Id;
        insert custResponse6;
        Phoenix_Customer_Response_Line__c custResponseLine6 = new Phoenix_Customer_Response_Line__c();
        custResponseLine6.Phoenix_Bid__c = bid6.Id;
        custResponseLine6.Phoenix_Bid_Line_Item__c = bidLine6.Id;
        custResponseLine6.Bid_Line_Item_Extn__c = bidExtnObj6.Id;
        custResponseLine6.Phoenix_Bid_Status__c = 'Awarded';
        custResponseLine6.Phoenix_Customer_Response__c = custResponse6.Id;
        insert custResponseLine6;
        
        
        Phoenix_NPR_Data__c npr = new Phoenix_NPR_Data__c();
        npr.Phoenix_Account__c = acc.Id;
        npr.Phoenix_Contract__c = cont.Id;
        npr.Phoenix_Product__c = prod2.Id;
        npr.Phoenix_12Months_Sales_Unit__c = 40;
        npr.Phoenix_Dead_Net_Tracking_GR__c = 60;
        insert npr;
        List<String> selectedBidIds = new List<String>();
        selectedBidIds.add(bid2.Id);
        selectedBidIds.add(bid6.Id);
        List<String> selections = new List<String>{'Rx', 'SRx', 'OTC'};
        Date d1=Date.newInstance(2022,01,01);
        Date d2=Date.newInstance(2022,12,31);
        
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Bid Submitted Date', 'Salesperson', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'SRx', 'Bid Closed Date', 'Salesperson', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Bid Submitted Date', 'Account Director', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'SRx', 'Bid Closed Date', 'Account Director', prod.Family, false, selectedBidIds);
    }
    static testmethod void  test4(){
        Account acc = new Account();
        acc.Name = 'Test Account';
        insert acc;
        Profile p = [SELECT Id FROM Profile WHERE Name='Standard User'];
        User u = new User(Alias = 'standt', Email='testmmm@testorg.com', 
                          EmailEncodingKey='UTF-8', LastName='Testing', LanguageLocaleKey='en_US', 
                          LocaleSidKey='en_US', ProfileId = p.Id, 
                          TimeZoneSidKey='America/Los_Angeles', UserName='testmmm@testorg.com', Division='Rx');
        insert u;
        Product2 prod = new Product2();
        prod.Name = 'Test Product';
        prod.ProductCode = '1234567';
        prod.Phoenix_Rx_SRx_OTC__c = 'Rx';
        insert prod;    
        Product2 prod2 = new Product2();
        prod2.Name = 'Test Product2';
        prod2.ProductCode = '1234568';
        prod2.Phoenix_Rx_SRx_OTC__c = 'SRx';
        insert prod2; 
        
        Phoenix_Contract__c cont = new Phoenix_Contract__c();
        cont.Name = 'Test';
        cont.Phoenix_Contract_Number__c = '1234';
        cont.Phoenix_Customer__c = acc.Id;
        insert cont;
        Phoenix_Customer_Response_Line__c crLine = new Phoenix_Customer_Response_Line__c();
        crLine.Phoenix_Award_Position__c = 'P1';
        //crLine.Customer_Response_Duration__r= system.today();
        insert crLine;
                
        Phoenix_Bid__c bid2 = new Phoenix_Bid__c();
        bid2.Phoenix_Bid_Name__c = 'Test Bid2';
        bid2.Phoenix_Bid_Type__c = 'Product Discontinuation Process';
        bid2.Phoenix_Customer__c = acc.id;
        bid2.OwnerId = u.Id;
        bid2.Phoenix_Approval_Status__c = 'Closed';
        bid2.Phoenix_Bid_Submitted_Date__c = system.today();
        bid2.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid2;
        Phoenix_Bid_Line_Item__c bidLine2 = new Phoenix_Bid_Line_Item__c();
        bidLine2.Phoenix_Bid__c = bid2.id;
        bidLine2.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine2.Phoenix_Product__c = prod.Id;
        bidLine2.Phoenix_Bid_Status__c = 'Awarded';
        bidLine2.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine2;
        Phoenix_BidLineItemExtn__c bidExtnObj2 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj2.Phoenix_Bid_Line_Item__c = bidLine2.Id;
        bidExtnObj2.Vision_Category__c = 'No Effect';
        bidExtnObj2.Vision_Effective_Date_of_Removal__c = '11/20/2022';
        insert bidExtnObj2;
        Phoenix_Bid__c bid7 = new Phoenix_Bid__c();
        bid7.Phoenix_Bid_Name__c = 'Test Bid';
        bid7.Phoenix_Bid_Type__c = 'Product Addition';
        bid7.Phoenix_Customer_Type__c = 'RXSS';
        bid7.Phoenix_Customer__c = acc.id;
        bid7.OwnerId = u.Id;
        bid7.Phoenix_Approval_Status__c = 'Closed';
        bid7.Phoenix_Bid_Submitted_Date__c = system.today();
        bid7.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid7;
        Phoenix_Bid_Line_Item__c bidLine7 = new Phoenix_Bid_Line_Item__c();
        bidLine7.Phoenix_Bid__c = bid7.id;
        bidLine7.Phoenix_Product__c = prod.Id;
        bidLine7.Phoenix_Contract__c = cont.Id;
        bidLine7.Phoenix_Bid_Status__c = 'Awarded';
        bidLine7.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine7;
        Phoenix_BidLineItemExtn__c bidExtnObj7 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj7.Phoenix_Bid_Line_Item__c = bidLine7.Id;
        bidExtnObj7.Vision_Category__c = 'No Effect';
        insert bidExtnObj7;
        
        Phoenix_Customer_Response__c custResponse7 = new Phoenix_Customer_Response__c();
        custResponse7.Phoenix_Bid_No__c = bid7.Id;
        insert custResponse7;
        Phoenix_Customer_Response_Line__c custResponseLine7 = new Phoenix_Customer_Response_Line__c();
        custResponseLine7.Phoenix_Bid__c = bid7.Id;
        custResponseLine7.Phoenix_Bid_Line_Item__c = bidLine7.Id;
        custResponseLine7.Bid_Line_Item_Extn__c = bidExtnObj7.Id;
        custResponseLine7.Phoenix_Bid_Status__c = 'Awarded';
        custResponseLine7.Phoenix_Customer_Response__c = custResponse7.Id;
        insert custResponseLine7;
        
        
        Phoenix_NPR_Data__c npr = new Phoenix_NPR_Data__c();
        npr.Phoenix_Account__c = acc.Id;
        npr.Phoenix_Contract__c = cont.Id;
        npr.Phoenix_Product__c = prod2.Id;
        npr.Phoenix_12Months_Sales_Unit__c = 40;
        npr.Phoenix_Dead_Net_Tracking_GR__c = 60;
        insert npr;
        
        List<String> selectedBidIds = new List<String>();
        selectedBidIds.add(bid2.Id);
        selectedBidIds.add(bid7.Id);
        List<String> selections = new List<String>{'Rx', 'SRx', 'OTC'};
        Date d1=Date.newInstance(2022,01,01);
        Date d2=Date.newInstance(2022,12,31);
        
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Bid Submitted Date', 'Salesperson', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'SRx', 'Bid Closed Date', 'Salesperson', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Bid Submitted Date', 'Account Director', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'SRx', 'Bid Closed Date', 'Account Director', prod.Family, true, selectedBidIds);
        
    }
    
    static testmethod void  test5(){
        Account acc = new Account();
        acc.Name = 'Test Account';
        insert acc;
        Profile p = [SELECT Id FROM Profile WHERE Name='Standard User'];
        User u = new User(Alias = 'standt', Email='testmmm@testorg.com', 
                          EmailEncodingKey='UTF-8', LastName='Testing', LanguageLocaleKey='en_US', 
                          LocaleSidKey='en_US', ProfileId = p.Id, 
                          TimeZoneSidKey='America/Los_Angeles', UserName='testmmm@testorg.com', Division='Rx');
        insert u;
        Product2 prod = new Product2();
        prod.Name = 'Test Product';
        prod.ProductCode = '1234567';
        prod.Phoenix_Rx_SRx_OTC__c = 'Rx';
        insert prod;    
        Product2 prod2 = new Product2();
        prod2.Name = 'Test Product2';
        prod2.ProductCode = '1234568';
        prod2.Phoenix_Rx_SRx_OTC__c = 'SRx';
        insert prod2; 
        
        Phoenix_Contract__c cont = new Phoenix_Contract__c();
        cont.Name = 'Test';
        cont.Phoenix_Contract_Number__c = '1234';
        cont.Phoenix_Customer__c = acc.Id;
        insert cont;
        Phoenix_Customer_Response_Line__c crLine = new Phoenix_Customer_Response_Line__c();
        crLine.Phoenix_Award_Position__c = 'P1';
        //crLine.Customer_Response_Duration__r= system.today();
        insert crLine;
                
        Phoenix_Bid__c bid2 = new Phoenix_Bid__c();
        bid2.Phoenix_Bid_Name__c = 'Test Bid2';
        bid2.Phoenix_Bid_Type__c = 'Product Discontinuation Process';
        bid2.Phoenix_Customer__c = acc.id;
        bid2.OwnerId = u.Id;
        bid2.Phoenix_Approval_Status__c = 'Closed';
        bid2.Phoenix_Bid_Submitted_Date__c = system.today();
        bid2.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid2;
        Phoenix_Bid_Line_Item__c bidLine2 = new Phoenix_Bid_Line_Item__c();
        bidLine2.Phoenix_Bid__c = bid2.id;
        bidLine2.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine2.Phoenix_Product__c = prod.Id;
        bidLine2.Phoenix_Bid_Status__c = 'Awarded';
        bidLine2.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine2;
        Phoenix_BidLineItemExtn__c bidExtnObj2 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj2.Phoenix_Bid_Line_Item__c = bidLine2.Id;
        bidExtnObj2.Vision_Category__c = 'No Effect';
        bidExtnObj2.Vision_Effective_Date_of_Removal__c = '11/20/2022';
        insert bidExtnObj2;
        Phoenix_Bid__c bid7 = new Phoenix_Bid__c();
        bid7.Phoenix_Bid_Name__c = 'Test Bid';
        bid7.Phoenix_Bid_Type__c = 'Product Addition';
        bid7.Phoenix_Customer_Type__c = 'ClarusOne';
        bid7.Phoenix_Customer__c = acc.id;
        bid7.OwnerId = u.Id;
        bid7.Phoenix_Approval_Status__c = 'Closed';
        bid7.Phoenix_Bid_Submitted_Date__c = system.today();
        bid7.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid7;
        Phoenix_Bid_Line_Item__c bidLine7 = new Phoenix_Bid_Line_Item__c();
        bidLine7.Phoenix_Bid__c = bid7.id;
        bidLine7.Phoenix_Product__c = prod.Id;
        bidLine7.Phoenix_Contract__c = cont.Id;
        bidLine7.Phoenix_Bid_Status__c = 'Awarded';
        bidLine7.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine7;
        Phoenix_BidLineItemExtn__c bidExtnObj7 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj7.Phoenix_Bid_Line_Item__c = bidLine7.Id;
        bidExtnObj7.Vision_Category__c = 'No Effect';
        insert bidExtnObj7;
        
        Phoenix_Customer_Response__c custResponse7 = new Phoenix_Customer_Response__c();
        custResponse7.Phoenix_Bid_No__c = bid7.Id;
        insert custResponse7;
        Phoenix_Customer_Response_Line__c custResponseLine7 = new Phoenix_Customer_Response_Line__c();
        custResponseLine7.Phoenix_Bid__c = bid7.Id;
        custResponseLine7.Phoenix_Bid_Line_Item__c = bidLine7.Id;
        custResponseLine7.Bid_Line_Item_Extn__c = bidExtnObj7.Id;
        custResponseLine7.Phoenix_Bid_Status__c = 'Awarded';
        custResponseLine7.Phoenix_Customer_Response__c = custResponse7.Id;
        insert custResponseLine7;
        
        
        Phoenix_NPR_Data__c npr = new Phoenix_NPR_Data__c();
        npr.Phoenix_Account__c = acc.Id;
        npr.Phoenix_Contract__c = cont.Id;
        npr.Phoenix_Product__c = prod2.Id;
        npr.Phoenix_12Months_Sales_Unit__c = 40;
        npr.Phoenix_Dead_Net_Tracking_GR__c = 60;
        insert npr;
                
        List<String> selectedBidIds = new List<String>();
        selectedBidIds.add(bid2.Id);
        selectedBidIds.add(bid7.Id);
        List<String> selections = new List<String>{'Rx', 'SRx', 'OTC'};
            Date d1=Date.newInstance(2022,01,01);
        Date d2=Date.newInstance(2022,12,31);
        
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Bid Submitted Date', 'Salesperson', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'SRx', 'Bid Closed Date', 'Salesperson', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Bid Submitted Date', 'Account Director', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'SRx', 'Bid Closed Date', 'Account Director', prod.Family, true, selectedBidIds);
        
    }
    
    static testmethod void  test6(){
        Account acc = new Account();
        acc.Name = 'Test Account';
        insert acc;
        Profile p = [SELECT Id FROM Profile WHERE Name='Standard User'];
        User u = new User(Alias = 'standt', Email='testmmm@testorg.com', 
                          EmailEncodingKey='UTF-8', LastName='Testing', LanguageLocaleKey='en_US', 
                          LocaleSidKey='en_US', ProfileId = p.Id, 
                          TimeZoneSidKey='America/Los_Angeles', UserName='testmmm@testorg.com', Division='Rx');
        insert u;
        Product2 prod = new Product2();
        prod.Name = 'Test Product';
        prod.ProductCode = '1234567';
        prod.Phoenix_Rx_SRx_OTC__c = 'Rx';
        insert prod;    
        Product2 prod2 = new Product2();
        prod2.Name = 'Test Product2';
        prod2.ProductCode = '1234568';
        prod2.Phoenix_Rx_SRx_OTC__c = 'SRx';
        insert prod2; 
        
        Phoenix_Contract__c cont = new Phoenix_Contract__c();
        cont.Name = 'Test';
        cont.Phoenix_Contract_Number__c = '1234';
        cont.Phoenix_Customer__c = acc.Id;
        insert cont;
                
        
        Phoenix_Bid__c bid7 = new Phoenix_Bid__c();
        bid7.Phoenix_Bid_Name__c = 'Test Bid';
        bid7.Phoenix_Bid_Type__c = 'Product Addition';
        bid7.Phoenix_Customer_Type__c = 'Sams Club';
        bid7.Phoenix_Customer__c = acc.id;
        bid7.OwnerId = u.Id;
        bid7.Phoenix_Approval_Status__c = 'Closed';
        bid7.Phoenix_Bid_Submitted_Date__c = system.today();
        bid7.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid7;
        Phoenix_Bid_Line_Item__c bidLine7 = new Phoenix_Bid_Line_Item__c();
        bidLine7.Phoenix_Bid__c = bid7.id;
        bidLine7.Phoenix_Product__c = prod.Id;
        bidLine7.Phoenix_Contract__c = cont.Id;
        bidLine7.Phoenix_Bid_Status__c = 'Awarded';
        bidLine7.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine7;
        Phoenix_BidLineItemExtn__c bidExtnObj7 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj7.Phoenix_Bid_Line_Item__c = bidLine7.Id;
        bidExtnObj7.Vision_Category__c = 'No Effect';
        insert bidExtnObj7;
        
        Phoenix_Customer_Response__c custResponse7 = new Phoenix_Customer_Response__c();
        custResponse7.Phoenix_Bid_No__c = bid7.Id;
        insert custResponse7;
        Phoenix_Customer_Response_Line__c custResponseLine7 = new Phoenix_Customer_Response_Line__c();
        custResponseLine7.Phoenix_Bid__c = bid7.Id;
        custResponseLine7.Phoenix_Bid_Line_Item__c = bidLine7.Id;
        custResponseLine7.Bid_Line_Item_Extn__c = bidExtnObj7.Id;
        custResponseLine7.Phoenix_Bid_Status__c = 'Awarded';
        custResponseLine7.Phoenix_Customer_Response__c = custResponse7.Id;
        insert custResponseLine7;
        
        
        Phoenix_NPR_Data__c npr = new Phoenix_NPR_Data__c();
        npr.Phoenix_Account__c = acc.Id;
        npr.Phoenix_Contract__c = cont.Id;
        npr.Phoenix_Product__c = prod2.Id;
        npr.Phoenix_12Months_Sales_Unit__c = 40;
        npr.Phoenix_Dead_Net_Tracking_GR__c = 60;
        insert npr;
                
        List<String> selectedBidIds = new List<String>();
        selectedBidIds.add(bid7.Id);
        List<String> selections = new List<String>{'Rx', 'SRx', 'OTC'};
        Date d1=Date.newInstance(2022,01,01);
        Date d2=Date.newInstance(2022,12,31);
        
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Bid Submitted Date', 'Account Director', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'SRx', 'Bid Closed Date', 'Account Director', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Bid Submitted Date', 'Salesperson', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'SRx', 'Bid Closed Date', 'Salesperson', prod.Family, true, selectedBidIds);
        
    }
    
    static testmethod void  test7(){
        Account acc = new Account();
        acc.Name = 'Test Account';
        insert acc;
        Profile p = [SELECT Id FROM Profile WHERE Name='Standard User'];
        User u = new User(Alias = 'standt', Email='testmmm@testorg.com', 
                          EmailEncodingKey='UTF-8', LastName='Testing', LanguageLocaleKey='en_US', 
                          LocaleSidKey='en_US', ProfileId = p.Id, 
                          TimeZoneSidKey='America/Los_Angeles', UserName='testmmm@testorg.com', Division='Rx');
        insert u;
        Product2 prod = new Product2();
        prod.Name = 'Test Product';
        prod.ProductCode = '1234567';
        prod.Phoenix_Rx_SRx_OTC__c = 'Rx';
        insert prod;    
        Product2 prod2 = new Product2();
        prod2.Name = 'Test Product2';
        prod2.ProductCode = '1234568';
        prod2.Phoenix_Rx_SRx_OTC__c = 'SRx';
        insert prod2; 
        
        Phoenix_Contract__c cont = new Phoenix_Contract__c();
        cont.Name = 'Test';
        cont.Phoenix_Contract_Number__c = '1234';
        cont.Phoenix_Customer__c = acc.Id;
        insert cont;
                
        
        Phoenix_Bid__c bid7 = new Phoenix_Bid__c();
        bid7.Phoenix_Bid_Name__c = 'Test Bid';
        bid7.Phoenix_Bid_Type__c = 'Product Addition';
        bid7.Phoenix_Customer_Type__c = 'Humana Indirect retail';
        bid7.Phoenix_Customer__c = acc.id;
        bid7.OwnerId = u.Id;
        bid7.Phoenix_Approval_Status__c = 'Closed';
        bid7.Phoenix_Bid_Submitted_Date__c = system.today();
        bid7.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid7;
        Phoenix_Bid_Line_Item__c bidLine7 = new Phoenix_Bid_Line_Item__c();
        bidLine7.Phoenix_Bid__c = bid7.id;
        bidLine7.Phoenix_Product__c = prod.Id;
        bidLine7.Phoenix_Contract__c = cont.Id;
        bidLine7.Phoenix_Bid_Status__c = 'Awarded';
        bidLine7.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine7;
        Phoenix_BidLineItemExtn__c bidExtnObj7 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj7.Phoenix_Bid_Line_Item__c = bidLine7.Id;
        bidExtnObj7.Vision_Category__c = 'No Effect';
        insert bidExtnObj7;
        
        Phoenix_Customer_Response__c custResponse7 = new Phoenix_Customer_Response__c();
        custResponse7.Phoenix_Bid_No__c = bid7.Id;
        insert custResponse7;
        Phoenix_Customer_Response_Line__c custResponseLine7 = new Phoenix_Customer_Response_Line__c();
        custResponseLine7.Phoenix_Bid__c = bid7.Id;
        custResponseLine7.Phoenix_Bid_Line_Item__c = bidLine7.Id;
        custResponseLine7.Bid_Line_Item_Extn__c = bidExtnObj7.Id;
        custResponseLine7.Phoenix_Bid_Status__c = 'Awarded';
        custResponseLine7.Phoenix_Customer_Response__c = custResponse7.Id;
        insert custResponseLine7;
        
        
        Phoenix_NPR_Data__c npr = new Phoenix_NPR_Data__c();
        npr.Phoenix_Account__c = acc.Id;
        npr.Phoenix_Contract__c = cont.Id;
        npr.Phoenix_Product__c = prod2.Id;
        npr.Phoenix_12Months_Sales_Unit__c = 40;
        npr.Phoenix_Dead_Net_Tracking_GR__c = 60;
        insert npr;
        
        List<String> selectedBidIds = new List<String>();
        selectedBidIds.add(bid7.Id);
        List<String> selections = new List<String>{'Rx', 'SRx', 'OTC'};
        Date d1=Date.newInstance(2022,01,01);
        Date d2=Date.newInstance(2022,12,31);
        
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Bid Submitted Date', 'Salesperson', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'SRx', 'Bid Closed Date', 'Salesperson', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Bid Submitted Date', 'Account Director', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'SRx', 'Bid Closed Date', 'Account Director', prod.Family, true, selectedBidIds);
        
    }
    //Added by Shashirekha
    static testmethod void  test8(){
        Profile p = [SELECT Id FROM Profile WHERE Name='Standard User'];
        User u = new User(Alias = 'standt', Email='testmmm@testorg.com', EmailEncodingKey='UTF-8', LastName='Testing', LanguageLocaleKey='en_US', LocaleSidKey='en_US', ProfileId = p.Id, TimeZoneSidKey='America/Los_Angeles', UserName='testmmm@testorg.com', Division='Rx');
        insert u;
        Account acc = new Account();
        acc.Name = 'Test Account';
        acc.Owner = u;
        insert acc;
        Product_Family__c pf = new Product_Family__c();
        pf.Name = 'Test Family';
        insert pf;
        Product2 prod = new Product2();
        prod.Name = 'Test Product';
        prod.ProductCode = '1234567';
        prod.Phoenix_Rx_SRx_OTC__c = 'Rx';
        prod.Family = 'Test Family';
        insert prod;    
        Product2 prod2 = new Product2();
        prod2.Name = 'Test Product2';
        prod2.ProductCode = '1234568';
        prod2.Phoenix_Rx_SRx_OTC__c = 'SRx';
        prod2.Family = 'Test Family2';
        insert prod2; 
        
        Phoenix_Contract__c cont = new Phoenix_Contract__c();
        cont.Name = 'Test';
        cont.Phoenix_Contract_Number__c = '1234';
        cont.Phoenix_Customer__c = acc.Id;
        insert cont;
        
        
        Phoenix_Customer_Response_Line__c crLine = new Phoenix_Customer_Response_Line__c();
        crLine.Phoenix_Award_Position__c = 'P1';
        //crLine.Customer_Response_Duration__r= system.today();
        crLine.Phoenix_Bid_Status__c = 'Declined by Customer' ;
        insert crLine;
        Phoenix_Bid__c bid = new Phoenix_Bid__c();
        bid.Phoenix_Bid_Name__c = 'Test Bid';
        bid.Phoenix_Bid_Type__c = 'Price Change';
        bid.OwnerId = u.Id;
        bid.Phoenix_Customer_Type__c = 'Direct';
        bid.Phoenix_Customer__c = acc.id;
        bid.Phoenix_Approval_Status__c = 'Customer\'s Update';
        bid.Phoenix_Bid_Submitted_Date__c = system.today();
        bid.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid;

        Phoenix_Bid_Line_Item__c bidLine = new Phoenix_Bid_Line_Item__c();
        bidLine.Phoenix_Bid__c = bid.id;
        bidLine.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine.Phoenix_Product__c = prod.Id;
        bidLine.Phoenix_Contract__c = cont.Id;
        bidLine.Phoenix_Bid_Status__c = '';
        bidLine.Phoenix_Proposed_Sales__c = 1000;
        bidLine.Phoenix_Current_Direct_Price__c = 100;
        insert bidLine;
        Phoenix_Bid_Line_Item__c bidLine12 = new Phoenix_Bid_Line_Item__c();
        bidLine12.Phoenix_Bid__c = bid.id;
        bidLine12.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine12.Phoenix_Product__c = prod.Id;
        bidLine12.Phoenix_Contract__c = cont.Id;
        bidLine12.Phoenix_Bid_Status__c = '';
        bidLine12.Phoenix_Proposed_Sales__c = 1000;
        bidLine12.Phoenix_Current_Direct_Price__c = 1;
        bidLine12.Phoenix_Current_Indirect_Price__c = 0;
        insert bidLine12;
        Phoenix_Customer_Response__c custResponse1 = new Phoenix_Customer_Response__c();
        custResponse1.Phoenix_Bid_No__c = bid.Id;
        insert custResponse1;
        Phoenix_Customer_Response_Line__c custResponseLine11 = new Phoenix_Customer_Response_Line__c();
        custResponseLine11.Phoenix_Bid__c = bid.Id;
        custResponseLine11.Phoenix_Bid_Line_Item__c = bidLine12.Id;
        custResponseLine11.Phoenix_Bid_Status__c = 'Awarded';
        custResponseLine11.Phoenix_Customer_Response__c = custResponse1.Id;
        insert custResponseLine11;
        Phoenix_BidLineItemExtn__c bidExtnObj = new Phoenix_BidLineItemExtn__c();
        bidExtnObj.Phoenix_Bid_Line_Item__c = bidLine.Id;
        bidExtnObj.Vision_Category__c = 'No Effect';
        insert bidExtnObj;
        
        Phoenix_Bid__c bid31 = new Phoenix_Bid__c();
        bid31.Phoenix_Bid_Name__c = 'Test Bid3';
        bid31.Phoenix_Bid_Type__c = 'Price Change';
        bid31.Phoenix_Customer__c = acc.id;
        bid31.Phoenix_Approval_Status__c = 'Customer\'s Update';
        bid31.Phoenix_Customer_Type__c = 'Direct';
        bid31.Phoenix_Bid_Submitted_Date__c = system.today();
        bid31.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid31;
        Phoenix_Bid_Line_Item__c bidLine31 = new Phoenix_Bid_Line_Item__c();
        bidLine31.Phoenix_Bid__c = bid31.id;
        bidLine31.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine31.Phoenix_Customer_Approval_OTC__c = '';
        bidLine31.Phoenix_Product__c = prod.Id;
        bidLine31.Phoenix_Contract__c = cont.Id;
        bidLine31.Phoenix_Bid_Status__c = 'In Process';
        bidLine31.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine31;
        Phoenix_Bid_Line_Item__c bidLine41 = new Phoenix_Bid_Line_Item__c();
        bidLine41.Phoenix_Bid__c = bid31.id;
        bidLine41.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine41.Phoenix_Customer_Approval_OTC__c = '';
        bidLine41.Phoenix_Product__c = prod.Id;
        bidLine41.Phoenix_Contract__c = cont.Id;
        bidLine41.Phoenix_Bid_Status__c = 'Awarded';
        bidLine41.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine41;
        Phoenix_BidLineItemExtn__c bidExtnObj31 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj31.Phoenix_Bid_Line_Item__c = bidLine31.Id;
        bidExtnObj31.Vision_Category__c = 'No Effect';
        insert bidExtnObj31;
        Phoenix_BidLineItemExtn__c bidExtnObj41 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj41.Phoenix_Bid_Line_Item__c = bidLine41.Id;
        bidExtnObj41.Vision_Category__c = 'No Effect';
        insert bidExtnObj41;
        
        Phoenix_Customer_Response__c custResponse = new Phoenix_Customer_Response__c();
        custResponse.Phoenix_Bid_No__c = bid.Id;
        insert custResponse;
        Phoenix_Customer_Response_Line__c custResponseLine = new Phoenix_Customer_Response_Line__c();
        custResponseLine.Phoenix_Bid__c = bid.Id;
        custResponseLine.Phoenix_Bid_Line_Item__c = bidLine.Id;
        custResponseLine.Bid_Line_Item_Extn__c = bidExtnObj.Id;
        custResponseLine.Phoenix_Bid_Status__c = 'Declined by Customer';
        custResponseLine.Phoenix_Customer_Response__c = custResponse.Id;
        insert custResponseLine;
        
        Phoenix_Bid__c bid2 = new Phoenix_Bid__c();
        bid2.Phoenix_Bid_Name__c = 'Test Bid2';
        bid2.Phoenix_Bid_Type__c = 'Price Change';
        bid2.Phoenix_Customer__c = acc.id;
        bid2.OwnerId = u.Id;
        bid2.Phoenix_Approval_Status__c = 'Closed';
        bid2.Phoenix_Bid_Submitted_Date__c = system.today();
        bid2.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid2;
        Phoenix_Bid_Line_Item__c bidLine2 = new Phoenix_Bid_Line_Item__c();
        bidLine2.Phoenix_Bid__c = bid2.id;
        bidLine2.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine2.Phoenix_Product__c = prod.Id;
        bidLine2.Phoenix_Bid_Status__c = 'Awarded';
        bidLine2.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine2;
        Phoenix_BidLineItemExtn__c bidExtnObj2 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj2.Phoenix_Bid_Line_Item__c = bidLine2.Id;
        bidExtnObj2.Vision_Category__c = 'No Effect';
        bidExtnObj2.Vision_Effective_Date_of_Removal__c = '11/20/2022';
        insert bidExtnObj2;
        Phoenix_Bid__c bid3 = new Phoenix_Bid__c();
        bid3.Phoenix_Bid_Name__c = 'Test Bid3';
        bid3.Phoenix_Bid_Type__c = 'Price Change';
        bid3.Phoenix_Customer__c = acc.id;
        bid3.Phoenix_Customer_Type__c = 'Direct';
        bid3.OwnerId = u.Id;
        bid3.Phoenix_Approval_Status__c = 'Cus';
        bid3.Phoenix_Bid_Submitted_Date__c = system.today();
        bid3.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid3;
        Phoenix_Bid_Line_Item__c bidLine3 = new Phoenix_Bid_Line_Item__c();
        bidLine3.Phoenix_Bid__c = bid3.id;
        bidLine3.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine3.Phoenix_Customer_Approval_OTC__c = '';
        bidLine3.Phoenix_Product__c = prod.Id;
        bidLine3.Phoenix_Contract__c = cont.Id;
        bidLine3.Phoenix_Bid_Status__c = 'Awarded';
        bidLine3.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine3;
        Phoenix_Bid_Line_Item__c bidLine4 = new Phoenix_Bid_Line_Item__c();
        bidLine4.Phoenix_Bid__c = bid3.id;
        bidLine4.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine4.Phoenix_Customer_Approval_OTC__c = '';
        bidLine4.Phoenix_Product__c = prod.Id;
        bidLine4.Phoenix_Contract__c = cont.Id;
        bidLine4.Phoenix_Bid_Status__c = 'Awarded';
        bidLine4.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine4;
        Phoenix_BidLineItemExtn__c bidExtnObj3 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj3.Phoenix_Bid_Line_Item__c = bidLine3.Id;
        bidExtnObj3.Vision_Category__c = 'No Effect';
        insert bidExtnObj3;
        Phoenix_BidLineItemExtn__c bidExtnObj4 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj4.Phoenix_Bid_Line_Item__c = bidLine4.Id;
        bidExtnObj4.Vision_Category__c = 'No Effect';
        insert bidExtnObj4;        
        
        List<String> selectedBidIds = new List<String>();
        selectedBidIds.add(bid.Id);
        selectedBidIds.add(bid2.Id);
        selectedBidIds.add(bid3.Id);
        Phoenix_NPR_Data__c npr = new Phoenix_NPR_Data__c();
        npr.Phoenix_Account__c = acc.Id;
        npr.Phoenix_Contract__c = cont.Id;
        npr.Phoenix_Product__c = prod2.Id;
        npr.Phoenix_12Months_Sales_Unit__c = 40;
        npr.Phoenix_Dead_Net_Tracking_GR__c = 60;
        insert npr;
        List<String> selections = new List<String>{'Rx', 'SRx', 'OTC'};
        Date d1=Date.newInstance(2022,01,01);
        Date d2=Date.newInstance(2022,12,31);
        
        VisionBidBusinessAnalysisCls.getData(acc.Id, acc.Id, selections, d1, d2, 'All', 'Bid Submitted Date', 'Salesperson', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Bid Submitted Date', 'Salesperson', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'SRx', 'Bid Closed Date', 'Salesperson', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(acc.Owner.Id, acc.Id, selections, d1, d2, 'All', 'Bid Submitted Date', 'Account Director', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Bid Submitted Date', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(acc.Owner.Id, null, selections, d1, d2, 'SRx', 'Bid Closed Date', 'Product Director', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Customer Response Date', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Submitted/Closed', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Pending', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Sent to Customer Date', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Internal Rejections', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getFamilies(prod.Family);
        //VisionBidBusinessAnalysisCls.testCov();
    }
	static testmethod void  test9(){
        Profile p = [SELECT Id FROM Profile WHERE Name='Standard User'];
        User u = new User(Alias = 'standt', Email='testmmm@testorg.com', EmailEncodingKey='UTF-8', LastName='Testing', LanguageLocaleKey='en_US', LocaleSidKey='en_US', ProfileId = p.Id, TimeZoneSidKey='America/Los_Angeles', UserName='testmmm@testorg.com', Division='Rx');
        insert u;
        Account acc = new Account();
        acc.Name = 'Test Account';
        acc.Owner = u;
        insert acc;
        Product_Family__c pf = new Product_Family__c();
        pf.Name = 'Test Family';
        insert pf;
        Product2 prod = new Product2();
        prod.Name = 'Test Product';
        prod.ProductCode = '1234567';
        prod.Phoenix_Rx_SRx_OTC__c = 'Rx';
        prod.Family = 'Test Family';
        insert prod;    
        Product2 prod2 = new Product2();
        prod2.Name = 'Test Product2';
        prod2.ProductCode = '1234568';
        prod2.Phoenix_Rx_SRx_OTC__c = 'SRx';
        prod2.Family = 'Test Family2';
        insert prod2; 
        
        Phoenix_Contract__c cont = new Phoenix_Contract__c();
        cont.Name = 'Test';
        cont.Phoenix_Contract_Number__c = '1234';
        cont.Phoenix_Customer__c = acc.Id;
        insert cont;
        
        
        Phoenix_Customer_Response_Line__c crLine = new Phoenix_Customer_Response_Line__c();
        crLine.Phoenix_Award_Position__c = 'P1';
        //crLine.Customer_Response_Duration__r= system.today();
        insert crLine;
        Phoenix_Bid__c bid = new Phoenix_Bid__c();
        bid.Phoenix_Bid_Name__c = 'Test Bid';
        bid.Phoenix_Bid_Type__c = 'Price Change';
        bid.OwnerId = u.Id;
        bid.Phoenix_Customer_Type__c = 'Net Indirect Pricing';
        bid.Phoenix_Customer__c = acc.id;
        bid.Phoenix_Approval_Status__c = 'Customer\'s Update';
        bid.Phoenix_Bid_Submitted_Date__c = system.today();
        bid.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid;

        Phoenix_Bid_Line_Item__c bidLine = new Phoenix_Bid_Line_Item__c();
        bidLine.Phoenix_Bid__c = bid.id;
        bidLine.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine.Phoenix_Product__c = prod.Id;
        bidLine.Phoenix_Contract__c = cont.Id;
        bidLine.Phoenix_Bid_Status__c = '';
        bidLine.Phoenix_Proposed_Sales__c = 1000;
        bidLine.Phoenix_Current_Direct_Price__c = 100;
        insert bidLine;
        Phoenix_Bid_Line_Item__c bidLine12 = new Phoenix_Bid_Line_Item__c();
        bidLine12.Phoenix_Bid__c = bid.id;
        bidLine12.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine12.Phoenix_Product__c = prod.Id;
        bidLine12.Phoenix_Contract__c = cont.Id;
        bidLine12.Phoenix_Bid_Status__c = '';
        bidLine12.Phoenix_Proposed_Sales__c = 1000;
        bidLine12.Phoenix_Current_Direct_Price__c = 0;
        bidLine12.Phoenix_Current_Indirect_Price__c = 0;
        insert bidLine12;
        Phoenix_Customer_Response__c custResponse1 = new Phoenix_Customer_Response__c();
        custResponse1.Phoenix_Bid_No__c = bid.Id;
        insert custResponse1;
        Phoenix_Customer_Response_Line__c custResponseLine11 = new Phoenix_Customer_Response_Line__c();
        custResponseLine11.Phoenix_Bid__c = bid.Id;
        custResponseLine11.Phoenix_Bid_Line_Item__c = bidLine12.Id;
        custResponseLine11.Phoenix_Bid_Status__c = 'Awarded';
        custResponseLine11.Phoenix_Customer_Response__c = custResponse1.Id;
        insert custResponseLine11;
        Phoenix_BidLineItemExtn__c bidExtnObj = new Phoenix_BidLineItemExtn__c();
        bidExtnObj.Phoenix_Bid_Line_Item__c = bidLine.Id;
        bidExtnObj.Vision_Category__c = 'No Effect';
        insert bidExtnObj;
        
        Phoenix_Bid__c bid31 = new Phoenix_Bid__c();
        bid31.Phoenix_Bid_Name__c = 'Test Bid3';
        bid31.Phoenix_Bid_Type__c = 'Price Change';
        bid31.Phoenix_Customer__c = acc.id;
        bid31.Phoenix_Approval_Status__c = 'Customer\'s Update';
        bid31.Phoenix_Customer_Type__c = 'Net Indirect Pricing';
        bid31.Phoenix_Bid_Submitted_Date__c = system.today();
        bid31.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid31;
        Phoenix_Bid_Line_Item__c bidLine31 = new Phoenix_Bid_Line_Item__c();
        bidLine31.Phoenix_Bid__c = bid31.id;
        bidLine31.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine31.Phoenix_Customer_Approval_OTC__c = '';
        bidLine31.Phoenix_Product__c = prod.Id;
        bidLine31.Phoenix_Contract__c = cont.Id;
        bidLine31.Phoenix_Bid_Status__c = 'In Process';
        bidLine31.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine31;
        Phoenix_Bid_Line_Item__c bidLine41 = new Phoenix_Bid_Line_Item__c();
        bidLine41.Phoenix_Bid__c = bid31.id;
        bidLine41.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine41.Phoenix_Customer_Approval_OTC__c = '';
        bidLine41.Phoenix_Product__c = prod.Id;
        bidLine41.Phoenix_Contract__c = cont.Id;
        bidLine41.Phoenix_Bid_Status__c = 'Awarded';
        bidLine41.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine41;
        Phoenix_BidLineItemExtn__c bidExtnObj31 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj31.Phoenix_Bid_Line_Item__c = bidLine31.Id;
        bidExtnObj31.Vision_Category__c = 'No Effect';
        insert bidExtnObj31;
        Phoenix_BidLineItemExtn__c bidExtnObj41 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj41.Phoenix_Bid_Line_Item__c = bidLine41.Id;
        bidExtnObj41.Vision_Category__c = 'No Effect';
        insert bidExtnObj41;
        
        Phoenix_Customer_Response__c custResponse = new Phoenix_Customer_Response__c();
        custResponse.Phoenix_Bid_No__c = bid.Id;
        insert custResponse;
        Phoenix_Customer_Response_Line__c custResponseLine = new Phoenix_Customer_Response_Line__c();
        custResponseLine.Phoenix_Bid__c = bid.Id;
        custResponseLine.Phoenix_Bid_Line_Item__c = bidLine.Id;
        custResponseLine.Bid_Line_Item_Extn__c = bidExtnObj.Id;
        custResponseLine.Phoenix_Bid_Status__c = 'Declined by Customer';
        custResponseLine.Phoenix_Customer_Response__c = custResponse.Id;
        insert custResponseLine;
        
        Phoenix_Bid__c bid2 = new Phoenix_Bid__c();
        bid2.Phoenix_Bid_Name__c = 'Test Bid2';
        bid2.Phoenix_Bid_Type__c = 'Price Change';
        bid2.Phoenix_Customer__c = acc.id;
        bid2.OwnerId = u.Id;
        bid2.Phoenix_Approval_Status__c = 'Closed';
        bid2.Phoenix_Bid_Submitted_Date__c = system.today();
        bid2.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid2;
        Phoenix_Bid_Line_Item__c bidLine2 = new Phoenix_Bid_Line_Item__c();
        bidLine2.Phoenix_Bid__c = bid2.id;
        bidLine2.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine2.Phoenix_Product__c = prod.Id;
        bidLine2.Phoenix_Bid_Status__c = 'Awarded';
        bidLine2.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine2;
        Phoenix_BidLineItemExtn__c bidExtnObj2 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj2.Phoenix_Bid_Line_Item__c = bidLine2.Id;
        bidExtnObj2.Vision_Category__c = 'No Effect';
        bidExtnObj2.Vision_Effective_Date_of_Removal__c = '11/20/2022';
        insert bidExtnObj2;
        Phoenix_Bid__c bid3 = new Phoenix_Bid__c();
        bid3.Phoenix_Bid_Name__c = 'Test Bid3';
        bid3.Phoenix_Bid_Type__c = 'Price Change';
        bid3.Phoenix_Customer__c = acc.id;
        bid3.Phoenix_Customer_Type__c = 'Net Indirect Pricing';
        bid3.OwnerId = u.Id;
        bid3.Phoenix_Approval_Status__c = 'Cus';
        bid3.Phoenix_Bid_Submitted_Date__c = system.today();
        bid3.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid3;
        Phoenix_Bid_Line_Item__c bidLine3 = new Phoenix_Bid_Line_Item__c();
        bidLine3.Phoenix_Bid__c = bid3.id;
        bidLine3.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine3.Phoenix_Customer_Approval_OTC__c = '';
        bidLine3.Phoenix_Product__c = prod.Id;
        bidLine3.Phoenix_Contract__c = cont.Id;
        bidLine3.Phoenix_Bid_Status__c = 'Awarded';
        bidLine3.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine3;
        Phoenix_Bid_Line_Item__c bidLine4 = new Phoenix_Bid_Line_Item__c();
        bidLine4.Phoenix_Bid__c = bid3.id;
        bidLine4.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine4.Phoenix_Customer_Approval_OTC__c = '';
        bidLine4.Phoenix_Product__c = prod.Id;
        bidLine4.Phoenix_Contract__c = cont.Id;
        bidLine4.Phoenix_Bid_Status__c = 'Awarded';
        bidLine4.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine4;
        Phoenix_BidLineItemExtn__c bidExtnObj3 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj3.Phoenix_Bid_Line_Item__c = bidLine3.Id;
        bidExtnObj3.Vision_Category__c = 'No Effect';
        insert bidExtnObj3;
        Phoenix_BidLineItemExtn__c bidExtnObj4 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj4.Phoenix_Bid_Line_Item__c = bidLine4.Id;
        bidExtnObj4.Vision_Category__c = 'No Effect';
        insert bidExtnObj4;        
        
        List<String> selectedBidIds = new List<String>();
        selectedBidIds.add(bid.Id);
        selectedBidIds.add(bid2.Id);
        selectedBidIds.add(bid3.Id);
        Phoenix_NPR_Data__c npr = new Phoenix_NPR_Data__c();
        npr.Phoenix_Account__c = acc.Id;
        npr.Phoenix_Contract__c = cont.Id;
        npr.Phoenix_Product__c = prod2.Id;
        npr.Phoenix_12Months_Sales_Unit__c = 40;
        npr.Phoenix_Dead_Net_Tracking_GR__c = 60;
        insert npr;
        List<String> selections = new List<String>{'Rx', 'SRx', 'OTC'};
        Date d1=Date.newInstance(2022,01,01);
        Date d2=Date.newInstance(2022,12,31);
        
        VisionBidBusinessAnalysisCls.getData(acc.Id, acc.Id, selections, d1, d2, 'All', 'Bid Submitted Date', 'Salesperson', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Bid Submitted Date', 'Salesperson', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'SRx', 'Bid Closed Date', 'Salesperson', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(acc.Owner.Id, acc.Id, selections, d1, d2, 'All', 'Bid Submitted Date', 'Account Director', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Bid Submitted Date', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(acc.Owner.Id, null, selections, d1, d2, 'SRx', 'Bid Closed Date', 'Product Director', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Customer Response Date', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Submitted/Closed', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Pending', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Sent to Customer Date', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Internal Rejections', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getFamilies(prod.Family);
        //VisionBidBusinessAnalysisCls.testCov();
    }
     static testmethod void  test10(){
        Profile p = [SELECT Id FROM Profile WHERE Name='Standard User'];
        User u = new User(Alias = 'standt', Email='testmmm@testorg.com', EmailEncodingKey='UTF-8', LastName='Testing', LanguageLocaleKey='en_US', LocaleSidKey='en_US', ProfileId = p.Id, TimeZoneSidKey='America/Los_Angeles', UserName='testmmm@testorg.com', Division='Rx');
        insert u;
        Account acc = new Account();
        acc.Name = 'Test Account';
        acc.Owner = u;
        insert acc;
        Product_Family__c pf = new Product_Family__c();
        pf.Name = 'Test Family';
        insert pf;
        Product2 prod = new Product2();
        prod.Name = 'Test Product';
        prod.ProductCode = '1234567';
        prod.Phoenix_Rx_SRx_OTC__c = 'Rx';
        prod.Family = 'Test Family';
        insert prod;    
        Product2 prod2 = new Product2();
        prod2.Name = 'Test Product2';
        prod2.ProductCode = '1234568';
        prod2.Phoenix_Rx_SRx_OTC__c = 'SRx';
        prod2.Family = 'Test Family2';
        insert prod2; 
        
        Phoenix_Contract__c cont = new Phoenix_Contract__c();
        cont.Name = 'Test';
        cont.Phoenix_Contract_Number__c = '1234';
        cont.Phoenix_Customer__c = acc.Id;
        insert cont;
        
        
        Phoenix_Customer_Response_Line__c crLine = new Phoenix_Customer_Response_Line__c();
        crLine.Phoenix_Award_Position__c = 'P1';
        //crLine.Customer_Response_Duration__r= system.today();
        insert crLine;
        Phoenix_Bid__c bid = new Phoenix_Bid__c();
        bid.Phoenix_Bid_Name__c = 'Test Bid';
        bid.Phoenix_Bid_Type__c = 'Price Change';
        bid.OwnerId = u.Id;
        bid.Phoenix_Customer_Type__c = 'BASE/DSH';
        bid.Phoenix_Customer__c = acc.id;
        bid.Phoenix_Approval_Status__c = 'Customer\'s Update';
        bid.Phoenix_Bid_Submitted_Date__c = system.today();
        bid.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid;

        Phoenix_Bid_Line_Item__c bidLine = new Phoenix_Bid_Line_Item__c();
        bidLine.Phoenix_Bid__c = bid.id;
        bidLine.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine.Phoenix_Product__c = prod.Id;
        bidLine.Phoenix_Contract__c = cont.Id;
        bidLine.Phoenix_Bid_Status__c = '';
        bidLine.Phoenix_Proposed_Sales__c = 1000;
        bidLine.Phoenix_Current_Direct_Price__c = 100;
        insert bidLine;
        Phoenix_Bid_Line_Item__c bidLine12 = new Phoenix_Bid_Line_Item__c();
        bidLine12.Phoenix_Bid__c = bid.id;
        bidLine12.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine12.Phoenix_Product__c = prod.Id;
        bidLine12.Phoenix_Contract__c = cont.Id;
        bidLine12.Phoenix_Bid_Status__c = '';
        bidLine12.Phoenix_Proposed_Sales__c = 1000;
        bidLine12.Phoenix_Current_Direct_Price__c = 0;
        bidLine12.Phoenix_Current_Indirect_Price__c = 0;
        insert bidLine12;
        Phoenix_Customer_Response__c custResponse1 = new Phoenix_Customer_Response__c();
        custResponse1.Phoenix_Bid_No__c = bid.Id;
        insert custResponse1;
        Phoenix_Customer_Response_Line__c custResponseLine11 = new Phoenix_Customer_Response_Line__c();
        custResponseLine11.Phoenix_Bid__c = bid.Id;
        custResponseLine11.Phoenix_Bid_Line_Item__c = bidLine12.Id;
        custResponseLine11.Phoenix_Bid_Status__c = 'Awarded';
        custResponseLine11.Phoenix_Customer_Response__c = custResponse1.Id;
        insert custResponseLine11;
        Phoenix_BidLineItemExtn__c bidExtnObj = new Phoenix_BidLineItemExtn__c();
        bidExtnObj.Phoenix_Bid_Line_Item__c = bidLine.Id;
        bidExtnObj.Vision_Category__c = 'No Effect';
        insert bidExtnObj;
        
        Phoenix_Bid__c bid31 = new Phoenix_Bid__c();
        bid31.Phoenix_Bid_Name__c = 'Test Bid3';
        bid31.Phoenix_Bid_Type__c = 'Price Change';
        bid31.Phoenix_Customer__c = acc.id;
        bid31.Phoenix_Approval_Status__c = 'Customer\'s Update';
        bid31.Phoenix_Customer_Type__c = 'BASE/DSH';
        bid31.Phoenix_Bid_Submitted_Date__c = system.today();
        bid31.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid31;
        Phoenix_Bid_Line_Item__c bidLine31 = new Phoenix_Bid_Line_Item__c();
        bidLine31.Phoenix_Bid__c = bid31.id;
        bidLine31.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine31.Phoenix_Customer_Approval_OTC__c = '';
        bidLine31.Phoenix_Product__c = prod.Id;
        bidLine31.Phoenix_Contract__c = cont.Id;
        bidLine31.Phoenix_Bid_Status__c = 'In Process';
        bidLine31.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine31;
        Phoenix_Bid_Line_Item__c bidLine41 = new Phoenix_Bid_Line_Item__c();
        bidLine41.Phoenix_Bid__c = bid31.id;
        bidLine41.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine41.Phoenix_Customer_Approval_OTC__c = '';
        bidLine41.Phoenix_Product__c = prod.Id;
        bidLine41.Phoenix_Contract__c = cont.Id;
        bidLine41.Phoenix_Bid_Status__c = 'Awarded';
        bidLine41.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine41;
        Phoenix_BidLineItemExtn__c bidExtnObj31 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj31.Phoenix_Bid_Line_Item__c = bidLine31.Id;
        bidExtnObj31.Vision_Category__c = 'No Effect';
        insert bidExtnObj31;
        Phoenix_BidLineItemExtn__c bidExtnObj41 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj41.Phoenix_Bid_Line_Item__c = bidLine41.Id;
        bidExtnObj41.Vision_Category__c = 'No Effect';
        insert bidExtnObj41;
        
        Phoenix_Customer_Response__c custResponse = new Phoenix_Customer_Response__c();
        custResponse.Phoenix_Bid_No__c = bid.Id;
        insert custResponse;
        Phoenix_Customer_Response_Line__c custResponseLine = new Phoenix_Customer_Response_Line__c();
        custResponseLine.Phoenix_Bid__c = bid.Id;
        custResponseLine.Phoenix_Bid_Line_Item__c = bidLine.Id;
        custResponseLine.Bid_Line_Item_Extn__c = bidExtnObj.Id;
        custResponseLine.Phoenix_Bid_Status__c = 'Declined by Customer';
        custResponseLine.Phoenix_Customer_Response__c = custResponse.Id;
        insert custResponseLine;
        
        Phoenix_Bid__c bid2 = new Phoenix_Bid__c();
        bid2.Phoenix_Bid_Name__c = 'Test Bid2';
        bid2.Phoenix_Bid_Type__c = 'Price Change';
        bid2.Phoenix_Customer__c = acc.id;
        bid2.OwnerId = u.Id;
        bid2.Phoenix_Approval_Status__c = 'Closed';
        bid2.Phoenix_Bid_Submitted_Date__c = system.today();
        bid2.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid2;
        Phoenix_Bid_Line_Item__c bidLine2 = new Phoenix_Bid_Line_Item__c();
        bidLine2.Phoenix_Bid__c = bid2.id;
        bidLine2.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine2.Phoenix_Product__c = prod.Id;
        bidLine2.Phoenix_Bid_Status__c = 'Awarded';
        bidLine2.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine2;
        Phoenix_BidLineItemExtn__c bidExtnObj2 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj2.Phoenix_Bid_Line_Item__c = bidLine2.Id;
        bidExtnObj2.Vision_Category__c = 'No Effect';
        bidExtnObj2.Vision_Effective_Date_of_Removal__c = '11/20/2022';
        insert bidExtnObj2;
        Phoenix_Bid__c bid3 = new Phoenix_Bid__c();
        bid3.Phoenix_Bid_Name__c = 'Test Bid3';
        bid3.Phoenix_Bid_Type__c = 'Price Change';
        bid3.Phoenix_Customer__c = acc.id;
        bid3.Phoenix_Customer_Type__c = 'BASE/DSH';
        bid3.OwnerId = u.Id;
        bid3.Phoenix_Approval_Status__c = 'Cus';
        bid3.Phoenix_Bid_Submitted_Date__c = system.today();
        bid3.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid3;
        Phoenix_Bid_Line_Item__c bidLine3 = new Phoenix_Bid_Line_Item__c();
        bidLine3.Phoenix_Bid__c = bid3.id;
        bidLine3.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine3.Phoenix_Customer_Approval_OTC__c = '';
        bidLine3.Phoenix_Product__c = prod.Id;
        bidLine3.Phoenix_Contract__c = cont.Id;
        bidLine3.Phoenix_Bid_Status__c = 'Awarded';
        bidLine3.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine3;
        Phoenix_Bid_Line_Item__c bidLine4 = new Phoenix_Bid_Line_Item__c();
        bidLine4.Phoenix_Bid__c = bid3.id;
        bidLine4.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine4.Phoenix_Customer_Approval_OTC__c = '';
        bidLine4.Phoenix_Product__c = prod.Id;
        bidLine4.Phoenix_Contract__c = cont.Id;
        bidLine4.Phoenix_Bid_Status__c = 'Awarded';
        bidLine4.Phoenix_Proposed_Sales__c = 1000;
        insert bidLine4;
        Phoenix_BidLineItemExtn__c bidExtnObj3 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj3.Phoenix_Bid_Line_Item__c = bidLine3.Id;
        bidExtnObj3.Vision_Category__c = 'No Effect';
        insert bidExtnObj3;
        Phoenix_BidLineItemExtn__c bidExtnObj4 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj4.Phoenix_Bid_Line_Item__c = bidLine4.Id;
        bidExtnObj4.Vision_Category__c = 'No Effect';
        insert bidExtnObj4;        
        
        List<String> selectedBidIds = new List<String>();
        selectedBidIds.add(bid.Id);
        selectedBidIds.add(bid2.Id);
        selectedBidIds.add(bid3.Id);
        Phoenix_NPR_Data__c npr = new Phoenix_NPR_Data__c();
        npr.Phoenix_Account__c = acc.Id;
        npr.Phoenix_Contract__c = cont.Id;
        npr.Phoenix_Product__c = prod2.Id;
        npr.Phoenix_12Months_Sales_Unit__c = 40;
        npr.Phoenix_Dead_Net_Tracking_GR__c = 60;
        insert npr;
        List<String> selections = new List<String>{'Rx', 'SRx', 'OTC'};
        Date d1=Date.newInstance(2022,01,01);
        Date d2=Date.newInstance(2022,12,31);
        
        VisionBidBusinessAnalysisCls.getData(acc.Id, acc.Id, selections, d1, d2, 'All', 'Bid Submitted Date', 'Salesperson', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Bid Submitted Date', 'Salesperson', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'SRx', 'Bid Closed Date', 'Salesperson', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(acc.Owner.Id, acc.Id, selections, d1, d2, 'All', 'Bid Submitted Date', 'Account Director', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Bid Submitted Date', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(acc.Owner.Id, null, selections, d1, d2, 'SRx', 'Bid Closed Date', 'Product Director', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Customer Response Date', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Submitted/Closed', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Pending', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Sent to Customer Date', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Internal Rejections', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getFamilies(prod.Family);
        //VisionBidBusinessAnalysisCls.testCov();
    }
    static testmethod void  test12(){
        Account acc = new Account();
        acc.Name = 'Test Account';
        insert acc;
        Profile p = [SELECT Id FROM Profile WHERE Name='Standard User'];
        User u = new User(Alias = 'standt', Email='testmmm@testorg.com', 
                          EmailEncodingKey='UTF-8', LastName='Testing', LanguageLocaleKey='en_US', 
                          LocaleSidKey='en_US', ProfileId = p.Id, 
                          TimeZoneSidKey='America/Los_Angeles', UserName='testmmm@testorg.com', Division='Rx');
        insert u;
        Product2 prod = new Product2();
        prod.Name = 'Test Product';
        prod.ProductCode = '1234567';
        prod.Phoenix_Rx_SRx_OTC__c = 'Rx';
        insert prod;    
        Product2 prod2 = new Product2();
        prod2.Name = 'Test Product2';
        prod2.ProductCode = '1234568';
        prod2.Phoenix_Rx_SRx_OTC__c = 'SRx';
        insert prod2; 
        
        Phoenix_Contract__c cont = new Phoenix_Contract__c();
        cont.Name = 'Test';
        cont.Phoenix_Contract_Number__c = '1234';
        cont.Phoenix_Customer__c = acc.Id;
        insert cont;
        Phoenix_Customer_Response_Line__c crLine = new Phoenix_Customer_Response_Line__c();
        crLine.Phoenix_Award_Position__c = 'P1';
        crLine.Phoenix_Bid_Status__c = 'Declined by Customer';
        //crLine.Customer_Response_Duration__r= system.today();
        insert crLine;
        
        Phoenix_Bid__c bid2 = new Phoenix_Bid__c();
        bid2.Phoenix_Bid_Name__c = 'Test Bid2';
        bid2.Phoenix_Bid_Type__c = 'Price Change';
        bid2.Phoenix_Customer__c = acc.id;
        bid2.OwnerId = u.Id;
        bid2.Phoenix_Approval_Status__c = 'Closed';
        bid2.Phoenix_Bid_Submitted_Date__c = system.today();
        bid2.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid2;
        Phoenix_Bid_Line_Item__c bidLine2 = new Phoenix_Bid_Line_Item__c();
        bidLine2.Phoenix_Bid__c = bid2.id;
        bidLine2.Phoenix_Customer_Response_Line__c = crLine.Id;
        bidLine2.Phoenix_Product__c = prod.Id;
        bidLine2.Phoenix_Bid_Status__c = 'Awarded';
        bidLine2.Phoenix_Proposed_Sales__c = 1000;
       	bidLine2.Phoenix_Bid_Line_Item_Approval_Status__c = 'Contracts Rejected';
        insert bidLine2;
        Phoenix_BidLineItemExtn__c bidExtnObj2 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj2.Phoenix_Bid_Line_Item__c = bidLine2.Id;
        bidExtnObj2.Vision_Category__c = 'No Effect';
        bidExtnObj2.Vision_Effective_Date_of_Removal__c = '11/20/2022';
        insert bidExtnObj2;
        Phoenix_Bid__c bid6 = new Phoenix_Bid__c();
        bid6.Phoenix_Bid_Name__c = 'Test Bid';
        bid6.Phoenix_Bid_Type__c = 'Product Addition';
        bid6.Phoenix_Customer_Type__c = 'Government Pricing';
        bid6.OwnerId = u.Id;
        bid6.Phoenix_Customer__c = acc.id;
        bid6.Phoenix_Approval_Status__c = 'Closed';
        bid6.Phoenix_Bid_Submitted_Date__c = system.today();
        bid6.Phoenix_Sent_to_Customer_Date__c = system.today();
        insert bid6;
        Phoenix_Bid_Line_Item__c bidLine6 = new Phoenix_Bid_Line_Item__c();
        bidLine6.Phoenix_Bid__c = bid6.id;
        bidLine6.Phoenix_Product__c = prod.Id;
        bidLine6.Phoenix_Contract__c = cont.Id;
        bidLine6.Phoenix_Bid_Status__c = 'Awarded';
        bidLine6.Phoenix_Proposed_Sales__c = 1000;
        bidLine6.Phoenix_Bid_Line_Item_Approval_Status__c = 'Contracts Rejected';
        insert bidLine6;
        Phoenix_BidLineItemExtn__c bidExtnObj6 = new Phoenix_BidLineItemExtn__c();
        bidExtnObj6.Phoenix_Bid_Line_Item__c = bidLine6.Id;
        bidExtnObj6.Vision_Category__c = 'No Effect';
        insert bidExtnObj6;
        
        Phoenix_Customer_Response__c custResponse6 = new Phoenix_Customer_Response__c();
        custResponse6.Phoenix_Bid_No__c = bid6.Id;
        insert custResponse6;
        Phoenix_Customer_Response_Line__c custResponseLine6 = new Phoenix_Customer_Response_Line__c();
        custResponseLine6.Phoenix_Bid__c = bid6.Id;
        custResponseLine6.Phoenix_Bid_Line_Item__c = bidLine6.Id;
        custResponseLine6.Bid_Line_Item_Extn__c = bidExtnObj6.Id;
        custResponseLine6.Phoenix_Bid_Status__c = 'Awarded';
        custResponseLine6.Phoenix_Customer_Response__c = custResponse6.Id;
        insert custResponseLine6;
        
        
        Phoenix_NPR_Data__c npr = new Phoenix_NPR_Data__c();
        npr.Phoenix_Account__c = acc.Id;
        npr.Phoenix_Contract__c = cont.Id;
        npr.Phoenix_Product__c = prod2.Id;
        npr.Phoenix_12Months_Sales_Unit__c = 40;
        npr.Phoenix_Dead_Net_Tracking_GR__c = 60;
        insert npr;
        List<String> selectedBidIds = new List<String>();
        selectedBidIds.add(bid2.Id);
        selectedBidIds.add(bid6.Id);
        List<String> selections = new List<String>{'Rx', 'SRx', 'OTC'};
        Date d1=Date.newInstance(2022,01,01);
        Date d2=Date.newInstance(2022,12,31);
        
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Bid Submitted Date', 'Salesperson', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'SRx', 'Bid Closed Date', 'Salesperson', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Pending', 'Account Director', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'Rx', 'Internal Rejections', 'Account Director', prod.Family, true, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'SRx', 'Bid Closed Date', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'SRx', 'Pending', 'Account Director', prod.Family, false, selectedBidIds);
        VisionBidBusinessAnalysisCls.getData(null, null, selections, d1, d2, 'SRx', 'Internal Rejections', 'Account Director', prod.Family, false, selectedBidIds);
    }

    
}