/**
 * @description       : 
 * @author            : Surender Dhruvsoft
 * @group             : 
 * @last modified on  : 25-05-2021
 * @last modified by  : Surender Dhruvsoft
 * Modifications Log 
 * Ver   Date         Author               Modification
 * 1.0   25-05-2021   Surender Dhruvsoft   Initial Version
**/
@isTest
public class Phoenix_SAP_NPR_REST_Test {
    
    static testmethod void test_success(){
        //As Per Best Practice it is important to instantiate the Rest Context
        RestRequest req = new RestRequest();
        RestResponse res = new RestResponse();
        req.requestURI = '/services/apexrest/SAP_NetPriceReport'; 
        req.httpMethod = 'POST';
        String body = '{"ns1:MT_NetPriceReport":{"NetPriceReportDetails":[{"Phoenix_Contract_Number__c":"1000000004","Phoenix_Contract_External_Description__c":"DIAMOND DIRECT","Phoenix_CoPhoenix_Contract_Internal_Description__cntract_Internal_Description__c":"Diamond Pharm.","Phoenix_Contract_Start_Date__c":"2009-10-01","Phoenix_Contract_End_Date__c":"2021-05-31","Phoenix_Customer_Number__c":"0000106266","Phoenix_Customer_Name__c":"Diamond Drugs Inc","Phoenix_Customer_Group__c":"RetailChain Pharmacy","Phoenix_Material_Number__c":"000000000300007256","Phoenix_Vistex_Description__c":"SSD 1% 50gm Cream Jar DRL","Phoenix_Vistex_Product_Hierarchy__c":"SSD Cream","Phoenix_UPC_NDC10__c":"4359821055","Phoenix_NDC11__c":"43598-0210-55","Phoenix_Contract_Type__c":"Direct","Phoenix_WAC__c":"12.40","Phoenix_WAC_Units__c":"SU","Phoenix_Contract_Price__c":"5.54","Phoenix_CP_Units__c":"SU","Phoenix_Sales_Unit_90__c":"0","Phoenix_Net_Sales_90__c":"0","Phoenix_12Mt_Sales_Ut__c":"0","Phoenix_12Months_Net_Sales__c":"0","Phoenix_Sales_From_Date_last_90_Days__c":"0000-00-00","Phoenix_Rebate_G_N_Indicator__c":"0N +15G","Phoenix_Rebate__c":"15.00","Phoenix_Rebate_in_Value__c":".83","Phoenix_Per_Unit_Rebate__c":"0","Phoenix_ZITD_Value__c":"0","Phoenix_Grwth_L_Tier__c":"0","Phoenix_Grwth_H_Tier__c":"0","Phoenix_Bonafied_G_N_Indicator__c":"0N +0G","Phoenix_Fee_Bonafied_Fee__c":"0","Phoenix_Fee_in_Value__c":"0","Phoenix_Per_Unit_Bonafied_Fee__c":"0","Phoenix_NetPrice__c":"4.71","Phoenix_Net_Price_w_o_Fees__c":"4.71","Phoenix_Net_Price_with_Fees__c":"4.71","Phoenix_Sales_Group__c":"David Vitols","Phoenix_WAC_Check__c":"OK","Phoenix_CD__c":"2.00","Phoenix_CD_in__c":".11","Phoenix_Net_Price_w_o_Fee_CD__c":"4.60","Phoenix_Net_Price_Fees_CD__c":"4.60","Phoenix_Net_Price_w_o_Fee_CD_HiGR__c":"4.60","Phoenix_Net_Price_Fees_CD_HiGR__c":"4.60","Phoenix_Price_Effective_Value_From__c":"2018-07-24","Phoenix_Price_Effective_Value_To__c":"2021-05-31","Phoenix_ZD07_Off_Inv__c":"0","Phoenix_CM_Fee__c":"0","Phoenix_CM_Fee_in__c":"0","Phoenix_RDC_NLC__c":"0","Phoenix_RDC_NLC_in__c":"0","Phoenix_ABS__c":"0","Phoenix_ABS_in_Currency__c":"0","Phoenix_Add_ABS_Value__c":"0","Phoenix_ZD07_Off_Inv_Value__c":"0","Phoenix_Dead_Net_High_GR__c":"4.60","Phoenix_Net_Price_for_GR_basis__c":"0","Phoenix_GR_Rebate_High_Tier__c":"0","Phoenix_GR_HighTier_in__c":"0","Phoenix_GR_Tracking_Tier__c":"0","Phoenix_GR_Tracking_in__c":"0","Phoenix_Dead_Net_Tracking_GR__c":"4.60","Phoenix_NP_wo_fee_CD_Trck_Tier__c":"4.60","Phoenix_NP_fees_CD_Trcktier__c":"4.60","Phoenix_Product_Position__c":"","Phoenix_Market_Share__c":"","Phoenix_Dead_Net_with_CMFee_for_H_Tier__c":"4.60","Phoenix_DeadNet_w_CMFee_for_Track_Tier__c":"4.60","Phoenix_Current_Month_Till_Date__c":"0","Phoenix_M1__c":"0","Phoenix_M2__c":"0","Phoenix_M3__c":"0","Phoenix_M4__c":"0","Phoenix_M5__c":"0","Phoenix_M6__c":"0","Phoenix_M7__c":"0","Phoenix_M8__c":"0","Phoenix_M9__c":"0","Phoenix_M10__c":"0","Phoenix_M11__c":"0","Phoenix_M12__c":"0","Phoenix_Total_Sale_Units__c":"0","Phoenix_Customer_Group_Code__c":"91","Phoenix_Sales_Org__c":"1007","Phoenix_Distribution_Channel__c":"77","Phoenix_Divison__c":"31","Phoenix_NPR_System_Date__c": "2017-08-24", "Phoenix_NPR_Report_Type__c":"NPR Report", "Phoenix_Total_NPR_Lines__c": "12"}]}}';
        req.requestBody= Blob.valueOf(body);
        RestContext.request = req;
        
        Test.startTest();
        Phoenix_SAP_NPR_REST.NPRCreationToStaging();
        Test.stopTest();
    }
    
    static testmethod void test_fail(){
        //As Per Best Practice it is important to instantiate the Rest Context
        RestRequest req = new RestRequest();
        RestResponse res = new RestResponse();
        req.requestURI = '/services/apexrest/SAP_NetPriceReport'; 
        req.httpMethod = 'POST';
        String body = '{"ns1:MT_NetPriceReport":{"NetPriceReportDetails":[{"Phoenix_Contract_Number__c":"1000000004aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa","Phoenix_Contract_External_Description__c":"DIAMOND DIRECT","Phoenix_CoPhoenix_Contract_Internal_Description__cntract_Internal_Description__c":"Diamond Pharm.","Phoenix_Contract_Start_Date__c":"2009-10-01","Phoenix_Contract_End_Date__c":"2021-05-31","Phoenix_Customer_Number__c":"0000106266","Phoenix_Customer_Name__c":"Diamond Drugs Inc","Phoenix_Customer_Group__c":"RetailChain Pharmacy","Phoenix_Material_Number__c":"000000000300007256","Phoenix_Vistex_Description__c":"SSD 1% 50gm Cream Jar DRL","Phoenix_Vistex_Product_Hierarchy__c":"SSD Cream","Phoenix_UPC_NDC10__c":"4359821055","Phoenix_NDC11__c":"43598-0210-55","Phoenix_Contract_Type__c":"Direct","Phoenix_WAC__c":"12.40","Phoenix_WAC_Units__c":"SU","Phoenix_Contract_Price__c":"5.54","Phoenix_CP_Units__c":"SU","Phoenix_Sales_Unit_90__c":"0","Phoenix_Net_Sales_90__c":"0","Phoenix_12Mt_Sales_Ut__c":"0","Phoenix_12Months_Net_Sales__c":"0","Phoenix_Sales_From_Date_last_90_Days__c":"0000-00-00","Phoenix_Rebate_G_N_Indicator__c":"0N +15G","Phoenix_Rebate__c":"15.00","Phoenix_Rebate_in_Value__c":".83","Phoenix_Per_Unit_Rebate__c":"0","Phoenix_ZITD_Value__c":"0","Phoenix_Grwth_L_Tier__c":"0","Phoenix_Grwth_H_Tier__c":"0","Phoenix_Bonafied_G_N_Indicator__c":"0N +0G","Phoenix_Fee_Bonafied_Fee__c":"0","Phoenix_Fee_in_Value__c":"0","Phoenix_Per_Unit_Bonafied_Fee__c":"0","Phoenix_NetPrice__c":"4.71","Phoenix_Net_Price_w_o_Fees__c":"4.71","Phoenix_Net_Price_with_Fees__c":"4.71","Phoenix_Sales_Group__c":"David Vitols","Phoenix_WAC_Check__c":"OK","Phoenix_CD__c":"2.00","Phoenix_CD_in__c":".11","Phoenix_Net_Price_w_o_Fee_CD__c":"4.60","Phoenix_Net_Price_Fees_CD__c":"4.60","Phoenix_Net_Price_w_o_Fee_CD_HiGR__c":"4.60","Phoenix_Net_Price_Fees_CD_HiGR__c":"4.60","Phoenix_Price_Effective_Value_From__c":"2018-07-24","Phoenix_Price_Effective_Value_To__c":"2021-05-31","Phoenix_ZD07_Off_Inv__c":"0","Phoenix_CM_Fee__c":"0","Phoenix_CM_Fee_in__c":"0","Phoenix_RDC_NLC__c":"0","Phoenix_RDC_NLC_in__c":"0","Phoenix_ABS__c":"0","Phoenix_ABS_in_Currency__c":"0","Phoenix_Add_ABS_Value__c":"0","Phoenix_ZD07_Off_Inv_Value__c":"0","Phoenix_Dead_Net_High_GR__c":"4.60","Phoenix_Net_Price_for_GR_basis__c":"0","Phoenix_GR_Rebate_High_Tier__c":"0","Phoenix_GR_HighTier_in__c":"0","Phoenix_GR_Tracking_Tier__c":"0","Phoenix_GR_Tracking_in__c":"0","Phoenix_Dead_Net_Tracking_GR__c":"4.60","Phoenix_NP_wo_fee_CD_Trck_Tier__c":"4.60","Phoenix_NP_fees_CD_Trcktier__c":"4.60","Phoenix_Product_Position__c":"","Phoenix_Market_Share__c":"","Phoenix_Dead_Net_with_CMFee_for_H_Tier__c":"4.60","Phoenix_DeadNet_w_CMFee_for_Track_Tier__c":"4.60","Phoenix_Current_Month_Till_Date__c":"0","Phoenix_M1__c":"0","Phoenix_M2__c":"0","Phoenix_M3__c":"0","Phoenix_M4__c":"0","Phoenix_M5__c":"0","Phoenix_M6__c":"0","Phoenix_M7__c":"0","Phoenix_M8__c":"0","Phoenix_M9__c":"0","Phoenix_M10__c":"0","Phoenix_M11__c":"0","Phoenix_M12__c":"0","Phoenix_Total_Sale_Units__c":"0","Phoenix_Customer_Group_Code__c":"91","Phoenix_Sales_Org__c":"1007","Phoenix_Distribution_Channel__c":"77","Phoenix_Divison__c":"31"},{"Phoenix_Contract_Number__c":"1000000004","Phoenix_Contract_External_Description__c":"DIAMOND DIRECT","Phoenix_CoPhoenix_Contract_Internal_Description__cntract_Internal_Description__c":"Diamond Pharm.","Phoenix_Contract_Start_Date__c":"2009-10-01","Phoenix_Contract_End_Date__c":"2021-05-31","Phoenix_Customer_Number__c":"0000106266","Phoenix_Customer_Name__c":"Diamond Drugs Inc","Phoenix_Customer_Group__c":"RetailChain Pharmacy","Phoenix_Material_Number__c":"000000000300007257","Phoenix_Vistex_Description__c":"SSD 1% 400gm Cream Jar DRL","Phoenix_Vistex_Product_Hierarchy__c":"SSD Cream","Phoenix_UPC_NDC10__c":"4359821040","Phoenix_NDC11__c":"43598-0210-40","Phoenix_Contract_Type__c":"Direct","Phoenix_WAC__c":"52.99","Phoenix_WAC_Units__c":"SU","Phoenix_Contract_Price__c":"23.37","Phoenix_CP_Units__c":"SU","Phoenix_Sales_Unit_90__c":"0","Phoenix_Net_Sales_90__c":"0","Phoenix_12Mt_Sales_Ut__c":"0","Phoenix_12Months_Net_Sales__c":"0","Phoenix_Sales_From_Date_last_90_Days__c":"0000-00-00","Phoenix_Rebate_G_N_Indicator__c":"0N +15G","Phoenix_Rebate__c":"15.00","Phoenix_Rebate_in_Value__c":"3.51","Phoenix_Per_Unit_Rebate__c":"0","Phoenix_ZITD_Value__c":"0","Phoenix_Grwth_L_Tier__c":"0","Phoenix_Grwth_H_Tier__c":"0","Phoenix_Bonafied_G_N_Indicator__c":"0N +0G","Phoenix_Fee_Bonafied_Fee__c":"0","Phoenix_Fee_in_Value__c":"0","Phoenix_Per_Unit_Bonafied_Fee__c":"0","Phoenix_NetPrice__c":"19.86","Phoenix_Net_Price_w_o_Fees__c":"19.86","Phoenix_Net_Price_with_Fees__c":"19.86","Phoenix_Sales_Group__c":"David Vitols","Phoenix_WAC_Check__c":"OK","Phoenix_CD__c":"2.00","Phoenix_CD_in__c":".47","Phoenix_Net_Price_w_o_Fee_CD__c":"19.39","Phoenix_Net_Price_Fees_CD__c":"19.39","Phoenix_Net_Price_w_o_Fee_CD_HiGR__c":"19.39","Phoenix_Net_Price_Fees_CD_HiGR__c":"19.39","Phoenix_Price_Effective_Value_From__c":"2018-07-24","Phoenix_Price_Effective_Value_To__c":"2021-05-31","Phoenix_ZD07_Off_Inv__c":"0","Phoenix_CM_Fee__c":"0","Phoenix_CM_Fee_in__c":"0","Phoenix_RDC_NLC__c":"0","Phoenix_RDC_NLC_in__c":"0","Phoenix_ABS__c":"0","Phoenix_ABS_in_Currency__c":"0","Phoenix_Add_ABS_Value__c":"0","Phoenix_ZD07_Off_Inv_Value__c":"0","Phoenix_Dead_Net_High_GR__c":"19.39","Phoenix_Net_Price_for_GR_basis__c":"0","Phoenix_GR_Rebate_High_Tier__c":"0","Phoenix_GR_HighTier_in__c":"0","Phoenix_GR_Tracking_Tier__c":"0","Phoenix_GR_Tracking_in__c":"0","Phoenix_Dead_Net_Tracking_GR__c":"19.39","Phoenix_NP_wo_fee_CD_Trck_Tier__c":"19.39","Phoenix_NP_fees_CD_Trcktier__c":"19.39","Phoenix_Product_Position__c":"","Phoenix_Market_Share__c":"","Phoenix_Dead_Net_with_CMFee_for_H_Tier__c":"19.39","Phoenix_DeadNet_w_CMFee_for_Track_Tier__c":"19.39","Phoenix_Current_Month_Till_Date__c":"0","Phoenix_M1__c":"0","Phoenix_M2__c":"0","Phoenix_M3__c":"0","Phoenix_M4__c":"0","Phoenix_M5__c":"0","Phoenix_M6__c":"0","Phoenix_M7__c":"0","Phoenix_M8__c":"0","Phoenix_M9__c":"0","Phoenix_M10__c":"0","Phoenix_M11__c":"0","Phoenix_M12__c":"0","Phoenix_Total_Sale_Units__c":"0","Phoenix_Customer_Group_Code__c":"91","Phoenix_Sales_Org__c":"1007","Phoenix_Distribution_Channel__c":"77","Phoenix_Divison__c":"31","Phoenix_Total_NPR_Lines__c": "1","Phoenix_NPR_Report_Type__c":"NPR Report","Phoenix_NPR_System_Date__c": "2017-08-24"}]}}';
        req.requestBody= Blob.valueOf(body);
        RestContext.request = req;
        
        Test.startTest();
     //   Phoenix_SAP_NPR_REST.NPRCreationToStaging();
        Test.stopTest();
    }
    
    static testmethod void test_NoProdData(){
        //As Per Best Practice it is important to instantiate the Rest Context
        RestRequest req = new RestRequest();
        RestResponse res = new RestResponse();
        req.requestURI = '/services/apexrest/SAP_NetPriceReport'; 
        req.httpMethod = 'POST';
        String body = '{"ns:MT_NetPriceReport":{"NetPriceReportDetails":[{"Phoenix_Contract_Number__c":"1000000004","Phoenix_Contract_External_Description__c":"DIAMOND DIRECT","Phoenix_CoPhoenix_Contract_Internal_Description__cntract_Internal_Description__c":"Diamond Pharm.","Phoenix_Contract_Start_Date__c":"2009-10-01","Phoenix_Contract_End_Date__c":"2021-05-31","Phoenix_Customer_Number__c":"0000106266","Phoenix_Customer_Name__c":"Diamond Drugs Inc","Phoenix_Customer_Group__c":"RetailChain Pharmacy","Phoenix_Material_Number__c":"000000000300007256","Phoenix_Vistex_Description__c":"SSD 1% 50gm Cream Jar DRL","Phoenix_Vistex_Product_Hierarchy__c":"SSD Cream","Phoenix_UPC_NDC10__c":"4359821055","Phoenix_NDC11__c":"43598-0210-55","Phoenix_Contract_Type__c":"Direct","Phoenix_WAC__c":"12.40","Phoenix_WAC_Units__c":"SU","Phoenix_Contract_Price__c":"5.54","Phoenix_CP_Units__c":"SU","Phoenix_Sales_Unit_90__c":"0","Phoenix_Net_Sales_90__c":"0","Phoenix_12Mt_Sales_Ut__c":"0","Phoenix_12Months_Net_Sales__c":"0","Phoenix_Sales_From_Date_last_90_Days__c":"0000-00-00","Phoenix_Rebate_G_N_Indicator__c":"0N +15G","Phoenix_Rebate__c":"15.00","Phoenix_Rebate_in_Value__c":".83","Phoenix_Per_Unit_Rebate__c":"0","Phoenix_ZITD_Value__c":"0","Phoenix_Grwth_L_Tier__c":"0","Phoenix_Grwth_H_Tier__c":"0","Phoenix_Bonafied_G_N_Indicator__c":"0N +0G","Phoenix_Fee_Bonafied_Fee__c":"0","Phoenix_Fee_in_Value__c":"0","Phoenix_Per_Unit_Bonafied_Fee__c":"0","Phoenix_NetPrice__c":"4.71","Phoenix_Net_Price_w_o_Fees__c":"4.71","Phoenix_Net_Price_with_Fees__c":"4.71","Phoenix_Sales_Group__c":"David Vitols","Phoenix_WAC_Check__c":"OK","Phoenix_CD__c":"2.00","Phoenix_CD_in__c":".11","Phoenix_Net_Price_w_o_Fee_CD__c":"4.60","Phoenix_Net_Price_Fees_CD__c":"4.60","Phoenix_Net_Price_w_o_Fee_CD_HiGR__c":"4.60","Phoenix_Net_Price_Fees_CD_HiGR__c":"4.60","Phoenix_Price_Effective_Value_From__c":"2018-07-24","Phoenix_Price_Effective_Value_To__c":"2021-05-31","Phoenix_ZD07_Off_Inv__c":"0","Phoenix_CM_Fee__c":"0","Phoenix_CM_Fee_in__c":"0","Phoenix_RDC_NLC__c":"0","Phoenix_RDC_NLC_in__c":"0","Phoenix_ABS__c":"0","Phoenix_ABS_in_Currency__c":"0","Phoenix_Add_ABS_Value__c":"0","Phoenix_ZD07_Off_Inv_Value__c":"0","Phoenix_Dead_Net_High_GR__c":"4.60","Phoenix_Net_Price_for_GR_basis__c":"0","Phoenix_GR_Rebate_High_Tier__c":"0","Phoenix_GR_HighTier_in__c":"0","Phoenix_GR_Tracking_Tier__c":"0","Phoenix_GR_Tracking_in__c":"0","Phoenix_Dead_Net_Tracking_GR__c":"4.60","Phoenix_NP_wo_fee_CD_Trck_Tier__c":"4.60","Phoenix_NP_fees_CD_Trcktier__c":"4.60","Phoenix_Product_Position__c":"","Phoenix_Market_Share__c":"","Phoenix_Dead_Net_with_CMFee_for_H_Tier__c":"4.60","Phoenix_DeadNet_w_CMFee_for_Track_Tier__c":"4.60","Phoenix_Current_Month_Till_Date__c":"0","Phoenix_M1__c":"0","Phoenix_M2__c":"0","Phoenix_M3__c":"0","Phoenix_M4__c":"0","Phoenix_M5__c":"0","Phoenix_M6__c":"0","Phoenix_M7__c":"0","Phoenix_M8__c":"0","Phoenix_M9__c":"0","Phoenix_M10__c":"0","Phoenix_M11__c":"0","Phoenix_M12__c":"0","Phoenix_Total_Sale_Units__c":"0","Phoenix_Customer_Group_Code__c":"91","Phoenix_Sales_Org__c":"1007","Phoenix_Distribution_Channel__c":"77","Phoenix_Divison__c":"31"}]}}';
        req.requestBody= Blob.valueOf(body);
        RestContext.request = req;
        
        Test.startTest();
        Phoenix_SAP_NPR_REST.NPRCreationToStaging();
        Test.stopTest();  
    }
    
    static testmethod void test_noData(){
        //As Per Best Practice it is important to instantiate the Rest Context
        RestRequest req = new RestRequest();
        RestResponse res = new RestResponse();
        req.requestURI = '/services/apexrest/SAP_NetPriceReport'; 
        req.httpMethod = 'POST';
        String body = '';
        req.requestBody= Blob.valueOf(body);
        RestContext.request = req;
        
        Test.startTest();
        Phoenix_SAP_NPR_REST.NPRCreationToStaging();
        Test.stopTest();   
        
    }
    
    
}