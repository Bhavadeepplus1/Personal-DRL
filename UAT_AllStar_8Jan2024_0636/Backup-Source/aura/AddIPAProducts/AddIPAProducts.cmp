<!--
  @description       : 
  @author            : Surender Patel (Dhruvsoft)
  @group             : 
  @last modified on  : 29-05-2021
  @last modified by  : Surender Patel (Dhruvsoft)
  Modifications Log 
  Ver   Date         Author                       Modification
  1.0   29-05-2021   Surender Patel (Dhruvsoft)   Initial Version
-->
<aura:component controller="Phoenix_AddIPAProdcutsCtrl"
    implements="force:appHostable,flexipage:availableForAllPageTypes,flexipage:availableForRecordHome,force:hasRecordId,forceCommunity:availableForAllPageTypes,force:lightningQuickActionWithOutHeader"
    access="global">
    <aura:attribute name="recordId" type="String" />
    <aura:handler name="init" value="{!this}" action="{!c.doInit}" />

    <aura:attribute name="wrap" type="Object" description="To hold all objects" />
    <aura:attribute name="selectedProductsIds" type="list" description="Selected Product Ids" default="[]" />
    <aura:attribute name="selectedContractIds" type="list" description="Selected Contract Ids" default="[]" />

    <aura:attribute name="QLlineItems" type="Object[]" description="Selected Product details" default="[]" />
    <aura:attribute name="ContrItems" type="Object[]" description="Selected contract details" default="[]" />
    <aura:attribute name="QLlist" type="list" description="All bid line Product details" default="[]" />
    <aura:attribute name="contractCopyList" type="list" description="All Contract copy list" default="[]" />
    <aura:attribute name="contractList" type="list" description="All contract details" default="[]" />

    <aura:attribute name="QLlist1" type="list" description="All Product details" default="[]" />
    <aura:attribute name="modalProductList" type="Object[]"
        description="used to store the selected products to display in Modal popup" />
    <aura:attribute name="ProductList" type="Object[]"
        description="used to store the product list to display in table" />
    <aura:attribute name="ProductCopyList" type="Object[]"
        description="used to store the product list to display in table" />

    <aura:attribute name="Allproduct" type="Object[]"
        description="used to store the product list to display in table" />
    <aura:attribute name="selectproduct" type="Object[]" description="used to store the product list" />
    <aura:attribute name="allData" type="List" description="used to store the product list" />
    <aura:attribute name="searchText" type="String" />
    <aura:attribute name="searchContract" type="String" />
    <aura:attribute name="currencyCode" type="String" default="$" />
    <aura:attribute name="searchFamily" type="String" />
    <aura:attribute name="selectedCount" type="integer" default="0" description="selected Product Records Count" />
    <aura:attribute name="contractCount" type="integer" default="0" description="selected Product Records Count" />

    <aura:attribute name="showbutton" type="Boolean" default="true"
        description="disable the button when no records selected" />
    <aura:attribute name="search" type="Boolean" default="true" description="use for display search records" />

    <aura:attribute name="currentPageNumber" type="Integer" default="1" />
    <aura:attribute name="pageSize" type="Integer" default="100" />
    <aura:attribute name="totalPages" type="Integer" default="0" />
    <aura:attribute name="pageList" type="List" />
    <aura:attribute name="totalRecordsCount" type="Integer" default="0"
        description="display the total number of records" />
    <aura:attribute name="showProducts" type="Boolean" default="false" />
    <aura:attribute name="showNoProdcuts" type="Boolean" default="false" />
    <aura:attribute name="isQLlistempty" type="Boolean" default="false" />
    <aura:attribute name="noProducts" type="Boolean" default="false" />
    <aura:attribute name="noData" type="Boolean" default="false" />
    <aura:attribute name="noContrData" type="Boolean" default="false" />
    <aura:attribute name="noContractData" type="Boolean" default="false" />
    <aura:attribute name="isModalOpen" type="Boolean" default="false" />
    <aura:attribute name="showSelectedProducts" type="Boolean" default="false" />
    <aura:attribute name="showContracts" type="Boolean" default="false" />
    <aura:attribute name="showSpinnerSelProds" type="Boolean" default="false" />
    <aura:attribute name="selectAll" type="Boolean" default="false" />
    <aura:attribute name="selectAllContr" type="Boolean" default="false" />
    <aura:attribute name="arrowDirection" type="string" default="arrowup"
        description="Use for change arrow sign direction on header based on click" />
    <aura:attribute name="isAsc" type="boolean" default="true"
        description="boolean flag for pass sorting condition to apex class" />
    <aura:attribute name="selectedTabsoft" type="string" default="ProductName"
        description="Use for show/hide arraow sign on header based on conditions" />
    <aura:html tag="style">
        .slds-modal__container{
        max-width: 100rem !important;
        width:100% !important;

        }
        .slds-button slds-button_brand{
        padding: initial; !important;
        }

        .slds-modal__content
        {


        background-color: transparent;
        box-shadow: none !important;
        }

        .slds-modal__close {
        display:none !important;
        }


        .slds-button__icon slds-button__icon_left{

        margin-left: 6px; !important;
        }

        .slds-modal__content slds-p-around_large{
        width:100%; !important;
        }
    </aura:html>
    <aura:if isTrue="{!v.showNoProdcuts}">
        <div class="panel slds-modal slds-fade-in-open" tabindex="-1" role="dialog" aria-modal="true"
            style="opacity: 1;outline:none;">

            <div class="modal-container slds-modal__container" style="width:50rem !important;">
                <div class="modal-header slds-modal__header"
                    style="padding-right: 5px; padding-top: 10px; padding-bottom: 10px; padding-left: 10px;">

                    <h2 class="slds-modal__title slds-hyphenate" style="color:#675e5e">
                        <p style="font-size:21px;"><b>IPA Products</b></p>

                    </h2>

                </div>
                <div class="matchPanelError" tabindex="0" role="alert"
                    style="text-align:center;background-color:white;">
                    <br />
                    <span>Please select Bid Type as SRx IPA Price Change or SRx IPA Product Addition to add IPA
                        products.</span>
                    <br /> <br />
                </div>

                <div class="modal-footer slds-modal__footer" style="background-color:white;">
                    <lightning:button variant="neutral" label="Close" onclick="{!c.closeModal}" />

                </div>
            </div>
        </div>
    </aura:if>
    <aura:if isTrue="{!v.showProducts}">


        <div class="panel slds-modal slds-fade-in-open" tabindex="-1" role="dialog" aria-modal="true"
            style="opacity: 1;outline:none;">

            <div class="modal-container slds-modal__container customClass">
                <div class="modal-header slds-modal__header"
                    style="padding-right: 5px; padding-top: 10px; padding-bottom: 10px; padding-left: 10px;">

                    <h2 class="slds-modal__title slds-hyphenate" style="color:#675e5e">
                        <p style="font-size:21px;"><b>IPA Products</b></p>

                    </h2>
                    <aura:if isTrue="{!v.noProducts}">
                        <div class="matchPanelError" tabindex="0" role="alert" style="color:#c23934;text-align:center;">
                            <span>No items to display.</span>
                        </div>
                    </aura:if>
                </div>
                <aura:if isTrue="{!v.showProducts}">
                    <div class="modal-body scrollable slds-modal__content slds-p-around--medium"
                        data-scoped-scroll="true"
                        style="background-color:white;padding-bottom: 11px; padding-left: 11px;padding:0px;">
                        <div>
                            <div class="slds-modal__content slds-p-around_large"
                                style="width: -webkit-fill-available;padding:5px;">
                                <lightning:input value="{!v.searchText}" type="search" variant="label-hidden"
                                    placeholder="Search Products and NDC and GPI...." aura:id="SearchBox"
                                    label="Product Name" onchange="{!c.onsearch}" style="margin-top:0px;" />
                                <span style="float:right;margin-top:3px;">
                                    <lightning:button onclick="{!c.searchTable}" variant="neutral" label="Search"
                                        iconName="utility:search" />

                                </span>





                                <aura:if isTrue="{!v.showSpinnerSelProds}">
                                    <lightning:spinner variant="brand" class="spinColor" size="large" />
                                </aura:if>







                                <div
                                    class="slds-col  slds-size_1-of-1 slds-medium-size_6-of-6 slds-large-size_12-of-12 slds-p-top_large">
                                    <aura:if isTrue="{! !v.noData}">
                                        <div class="slds-scope">
                                            <div class="slds-grid slds-wrap slds-text-align_center custom-container">
                                                <div class="slds-size_1-of-2 slds-max-small-size_1-of-1 sapdata">


                                                    <span class="slds-badge slds-badge_lightest"
                                                        style="display:inline-block;margin-bottom:3px;">
                                                        Selected Products : {!v.selectedCount}
                                                    </span>

                                                </div>
                                                <div class="slds-size_1-of-2 slds-max-small-size_1-of-1 sapdata">
                                                    <a onclick="{!c.showSelectedproducts}"><b>View Selected
                                                            Products</b></a>
                                                </div>
                                            </div>
                                        </div>
                                    </aura:if>
                                    <aura:if isTrue="{!v.noData}">
                                        <div class="matchPanelError" tabindex="0" role="alert"
                                            style="color:#c23934;text-align:center;">
                                            <span>No search results found.</span>
                                        </div>
                                    </aura:if>
                                    <aura:if isTrue="{!v.isModalOpen}">
                                        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01"
                                            aria-modal="true" aria-describedby="modal-content-id-1"
                                            class="slds-modal slds-fade-in-open">

                                            <div class="slds-modal__container"
                                                style="width:50% ! important;padding:0px 0px 0px 0px;">

                                                <!-- Modal/Popup Box Header Starts here-->
                                                <header class="slds-modal__header">
                                                    <lightning:buttonIcon iconName="utility:close"
                                                        onclick="{!c.closePopup}" alternativeText="close"
                                                        variant="bare-inverse" class="slds-modal__close" />
                                                    <aura:if isTrue="{!if(v.selectedCount>0,true,false)}">
                                                        <h2 class="slds-text-heading_medium slds-hyphenate"><b>Selected
                                                                Products</b></h2>
                                                    </aura:if>
                                                </header>
                                                <!--Modal/Popup Box Body Starts here-->
                                                <!--div class="slds-scrollable" style="height: 100rem; width: 46rem"-->
                                                <div class="slds-modal__content slds-p-around_medium"
                                                    style="padding:0px 0px 0px 0px;">

                                                    <aura:if isTrue="{!if(v.selectedCount>0,true,false)}">
                                                        <table
                                                            class="slds-table slds-table_cell_buffered slds-max-medium-table_stacked-horizontal slds-table_bordered"
                                                            style="border:1px solid #eaeaea;">
                                                            <thead>

                                                                <tr class="slds-text-title">

                                                                    <th scope="col" class="slds-cell-wrap ">
                                                                        <div class="slds-truncate" title="Product Name">
                                                                            Product Name
                                                                        </div>
                                                                    </th>
                                                                    <th scope="col" class="slds-cell-wrap ">
                                                                        <div class="slds-truncate" title="Product Name">
                                                                            Product Family
                                                                        </div>
                                                                    </th>


                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <aura:iteration items="{!v.modalProductList}"
                                                                    var="prodItem" indexVar="itemIndex">
                                                                    <tr>
                                                                        <td class="slds-cell-wrap" scope="col">
                                                                            <a href="{!'/'+prodItem.prdlist.Id}"
                                                                                target="_blank">{!prodItem.prdlist.Name}</a>
                                                                        </td>
                                                                        <td class="slds-cell-wrap " scope="col">
                                                                            <a href="{!'/'+prodItem.prdlist.Product_Family__c}"
                                                                               target="_blank">{!prodItem.prdlist.Product_Family__r.Name}</a>
                                                                        </td>
                                                                    </tr>
                                                                </aura:iteration>
                                                            </tbody>
                                                        </table>
                                                        <aura:set attribute="else">
                                                            <p style="text-align:center;background-color:white;">Please
                                                                Select Products to Display.</p>
                                                        </aura:set>
                                                    </aura:if>
                                                </div>
                                                <!--/div-->
                                                <!--Modal/Popup Box Footer Starts here-->
                                                <footer class="slds-modal__footer">
                                                    <lightning:button variant="neutral" label="Cancel" title="Cancel"
                                                        onclick="{! c.closePopup }" />

                                                </footer>
                                            </div>

                                        </section>
                                        <div class="slds-backdrop slds-backdrop_open"></div>

                                    </aura:if>



                                    <aura:if isTrue="{!not(empty(v.ProductList))}">
                                        <table
                                            class="slds-table slds-table_cell_buffered slds-max-medium-table_stacked-horizontal slds-table_bordered"
                                            style="border:1px solid #eaeaea;">
                                            <thead>

                                                <tr class="slds-text-title">
                                                    <th style="height: 29px;width: 57px;">
                                                        <lightning:input type="checkbox" class="slds-checkbox" name=""
                                                            checked="{!v.selectAll}" aura:id="checkbox"
                                                            onchange="{!c.selectAllCheckbox}" />
                                                    </th>
                                                    <th scope="col" class="slds-cell-wrap "
                                                        onclick="{!c.sortProductName}">

                                                        <div class="slds-truncate" title="Product Name">
                                                            <a href="javascript:void(0);"
                                                                class="slds-th__action slds-text-link--reset">
                                                                <span class="slds-assistive-text">Sort</span>
                                                                <span class="slds-truncate" title="Name">Product
                                                                    Name</span>
                                                                <aura:if
                                                                    isTrue="{! and(v.arrowDirection == 'arrowdown', v.selectedTabsoft == 'ProductName') }">
                                                                    &nbsp; &#9660; </aura:if>
                                                                <aura:if
                                                                    isTrue="{! and(v.arrowDirection != 'arrowdown', v.selectedTabsoft == 'ProductName') }">
                                                                    &nbsp; &#9650; </aura:if>
                                                            </a>
                                                        </div>
                                                    </th>
                                                    <th scope="col" class="slds-cell-wrap "
                                                        onclick="{!c.sortIPAFloorPrice}">
                                                        <div class="slds-truncate" title="IPA Floor Price">

                                                            <a href="javascript:void(0);"
                                                                class="slds-th__action slds-text-link--reset">
                                                                <span class="slds-assistive-text">Sort</span>
                                                                <span class="slds-truncate" title="Name">IPA Floor
                                                                    Price</span>
                                                                <aura:if
                                                                    isTrue="{! and(v.arrowDirection == 'arrowdown', v.selectedTabsoft == 'IPAFloorPrice') }">
                                                                    &nbsp; &#9660; </aura:if>
                                                                <aura:if
                                                                    isTrue="{! and(v.arrowDirection != 'arrowdown', v.selectedTabsoft == 'IPAFloorPrice') }">
                                                                    &nbsp; &#9650; </aura:if>
                                                            </a>
                                                        </div>
                                                    </th>
                                                    <th scope="col" class="slds-cell-wrap "
                                                        onclick="{!c.sortProductCode}">
                                                        <div class="slds-truncate" title="Product Code">

                                                            <a href="javascript:void(0);"
                                                                class="slds-th__action slds-text-link--reset">
                                                                <span class="slds-assistive-text">Sort</span>
                                                                <span class="slds-truncate" title="Name">Product
                                                                    Code</span>
                                                                <aura:if
                                                                    isTrue="{! and(v.arrowDirection == 'arrowdown', v.selectedTabsoft == 'ProductCode') }">
                                                                    &nbsp; &#9660; </aura:if>
                                                                <aura:if
                                                                    isTrue="{! and(v.arrowDirection != 'arrowdown', v.selectedTabsoft == 'ProductCode') }">
                                                                    &nbsp; &#9650; </aura:if>
                                                            </a>
                                                        </div>
                                                    </th>


                                                    <th scope="col" class="slds-cell-wrap " onclick="{!c.sortNDC11}">
                                                        <div class="slds-truncate" title=" NDC - 11 ">
                                                            <a href="javascript:void(0);"
                                                                class="slds-th__action slds-text-link--reset">
                                                                <span class="slds-assistive-text">Sort</span>
                                                                <span class="slds-truncate" title="Name"> NDC -
                                                                    11</span>
                                                                <aura:if
                                                                    isTrue="{! and(v.arrowDirection == 'arrowdown', v.selectedTabsoft == 'NDC11') }">
                                                                    &nbsp; &#9660; </aura:if>
                                                                <aura:if
                                                                    isTrue="{! and(v.arrowDirection != 'arrowdown', v.selectedTabsoft == 'NDC11') }">
                                                                    &nbsp; &#9650; </aura:if>
                                                            </a>
                                                        </div>
                                                    </th>
                                                    <th scope="col" class="slds-cell-wrap " onclick="{!c.sortGPI}">
                                                        <div class="slds-truncate" title="GPI">
                                                            <a href="javascript:void(0);"
                                                                class="slds-th__action slds-text-link--reset">
                                                                <span class="slds-assistive-text">Sort</span>
                                                                <span class="slds-truncate" title="Name">GPI</span>
                                                                <aura:if
                                                                    isTrue="{! and(v.arrowDirection == 'arrowdown', v.selectedTabsoft == 'GPI') }">
                                                                    &nbsp; &#9660; </aura:if>
                                                                <aura:if
                                                                    isTrue="{! and(v.arrowDirection != 'arrowdown', v.selectedTabsoft == 'GPI') }">
                                                                    &nbsp; &#9650; </aura:if>
                                                            </a>
                                                        </div>
                                                    </th>
                                                    <th scope="col" class="slds-cell-wrap "
                                                        onclick="{!c.sortProductFamily}">
                                                        <div class="slds-truncate" title="Product Family">
                                                            <a href="javascript:void(0);"
                                                                class="slds-th__action slds-text-link--reset">
                                                                <span class="slds-assistive-text">Sort</span>
                                                                <span class="slds-truncate" title="Name">Product
                                                                    Family</span>
                                                                <aura:if
                                                                    isTrue="{! and(v.arrowDirection == 'arrowdown', v.selectedTabsoft == 'ProductFamily') }">
                                                                    &nbsp; &#9660; </aura:if>
                                                                <aura:if
                                                                    isTrue="{! and(v.arrowDirection != 'arrowdown', v.selectedTabsoft == 'ProductFamily') }">
                                                                    &nbsp; &#9650; </aura:if>
                                                            </a>
                                                        </div>
                                                    </th>



                                                    <th scope="col" class="slds-cell-wrap " onclick="{!c.sortStrength}">
                                                        <div class="slds-truncate" title="Strength">
                                                            <a href="javascript:void(0);"
                                                                class="slds-th__action slds-text-link--reset">
                                                                <span class="slds-assistive-text">Sort</span>
                                                                <span class="slds-truncate" title="Name">Strength</span>
                                                                <aura:if
                                                                    isTrue="{! and(v.arrowDirection == 'arrowdown', v.selectedTabsoft == 'Strength') }">
                                                                    &nbsp; &#9660; </aura:if>
                                                                <aura:if
                                                                    isTrue="{! and(v.arrowDirection != 'arrowdown', v.selectedTabsoft == 'Strength') }">
                                                                    &nbsp; &#9650; </aura:if>
                                                            </a>
                                                        </div>
                                                    </th>
                                                    <th scope="col" class="slds-cell-wrap " onclick="{!c.sortPackSize}">
                                                        <div class="slds-truncate" title="Pack Size">
                                                            <a href="javascript:void(0);"
                                                                class="slds-th__action slds-text-link--reset">
                                                                <span class="slds-assistive-text">Sort</span>
                                                                <span class="slds-truncate" title="Name">Pack
                                                                    Size</span>
                                                                <aura:if
                                                                    isTrue="{! and(v.arrowDirection == 'arrowdown', v.selectedTabsoft == 'PackSize') }">
                                                                    &nbsp; &#9660; </aura:if>
                                                                <aura:if
                                                                    isTrue="{! and(v.arrowDirection != 'arrowdown', v.selectedTabsoft == 'PackSize') }">
                                                                    &nbsp; &#9650; </aura:if>
                                                            </a>
                                                        </div>
                                                    </th>
                                                    <th scope="col" class="slds-cell-wrap " onclick="{!c.sortWAC}">
                                                        <div class="slds-truncate" title="WAC">
                                                            <a href="javascript:void(0);"
                                                                class="slds-th__action slds-text-link--reset">
                                                                <span class="slds-assistive-text">Sort</span>
                                                                <span class="slds-truncate" title="Name">WAC</span>
                                                                <aura:if
                                                                    isTrue="{! and(v.arrowDirection == 'arrowdown', v.selectedTabsoft == 'WAC') }">
                                                                    &nbsp; &#9660; </aura:if>
                                                                <aura:if
                                                                    isTrue="{! and(v.arrowDirection != 'arrowdown', v.selectedTabsoft == 'WAC') }">
                                                                    &nbsp; &#9650; </aura:if>
                                                            </a>
                                                        </div>
                                                    </th>
                                                    <th scope="col" class="slds-cell-wrap "
                                                        onclick="{!c.sortProductDirector}">
                                                        <div class="slds-truncate" title="Product Director">
                                                            <a href="javascript:void(0);"
                                                                class="slds-th__action slds-text-link--reset">
                                                                <span class="slds-assistive-text">Sort</span>
                                                                <span class="slds-truncate" title="Name">Product
                                                                    Director</span>
                                                                <aura:if
                                                                    isTrue="{! and(v.arrowDirection == 'arrowdown', v.selectedTabsoft == 'ProductDirector') }">
                                                                    &nbsp; &#9660; </aura:if>
                                                                <aura:if
                                                                    isTrue="{! and(v.arrowDirection != 'arrowdown', v.selectedTabsoft == 'ProductDirector') }">
                                                                    &nbsp; &#9650; </aura:if>
                                                            </a>
                                                        </div>
                                                    </th>
                                                    <th scope="col" class="slds-cell-wrap "
                                                        onclick="{!c.sortBrandName}">
                                                        <div class="slds-truncate" title="Brand Name (Compare To)">
                                                            <a href="javascript:void(0);"
                                                                class="slds-th__action slds-text-link--reset">
                                                                <span class="slds-assistive-text">Sort</span>
                                                                <span class="slds-truncate" title="Name">Brand Name
                                                                    (Compare To)</span>
                                                                <aura:if
                                                                    isTrue="{! and(v.arrowDirection == 'arrowdown', v.selectedTabsoft == 'BrandName') }">
                                                                    &nbsp; &#9660; </aura:if>
                                                                <aura:if
                                                                    isTrue="{! and(v.arrowDirection != 'arrowdown', v.selectedTabsoft == 'BrandName') }">
                                                                    &nbsp; &#9650; </aura:if>
                                                            </a>
                                                        </div>
                                                    </th>








                                                </tr>
                                            </thead>
                                            <tbody>
                                                <aura:iteration items="{!v.ProductList}" var="prodItem"
                                                    indexVar="itemIndex">
                                                    <tr class="slds-text-title">
                                                        <td class="slds-cell-wrap" scope="col">
                                                            <lightning:input type="checkbox" class="slds-checkbox"
                                                                name="{!prodItem.prdlist.Id}"
                                                                checked="{!prodItem.isSelected}" aura:id="checkbox"
                                                                onchange="{!c.checkBoxChangeHandler}" />
                                                        </td>
                                                        <td class="slds-cell-wrap" scope="col">
                                                            <a href="{!'/'+prodItem.prdlist.Id}"
                                                                target="_blank">{!prodItem.prdlist.Name}</a>
                                                        </td>
                                                        <td class="slds-cell-wrap " scope="col">
                                                            {!prodItem.currencyCode}{!prodItem.prdlist.Phoenix_IPA_Floor_Price__c}
                                                        </td>
                                                        <td class="slds-cell-wrap " scope="col">
                                                            {!prodItem.prdlist.ProductCode}
                                                        </td>
                                                        <td class="slds-cell-wrap " scope="col">
                                                            {!prodItem.prdlist.Phoenix_NDC_11__c}
                                                        </td>
                                                        <td class="slds-cell-wrap " scope="col">
                                                            {!prodItem.prdlist.Phoenix_GPI_Generic_Product_Identifier__c}
                                                        </td>
                                                        <td class="slds-cell-wrap " scope="col">
                                                            <a href="{!'/'+prodItem.prdlist.Product_Family__c}"
                                                                target="_blank">{!prodItem.prdlist.Product_Family__r.Name}</a>
                                                            <!--{!prodItem.prdlist.Family}-->
                                                        </td>
                                                        <td class="slds-cell-wrap " scope="col">
                                                            {!prodItem.prdlist.Phoenix_Strength__c}
                                                        </td>
                                                        <td class="slds-cell-wrap " scope="col">
                                                            {!prodItem.prdlist.Phoenix_SAP_Pack_Size__c}
                                                        </td>
                                                        <td class="slds-cell-wrap " scope="col">
                                                            {!prodItem.currencyCode} {!prodItem.prdlist.Phoenix_WAC__c}
                                                        </td>

                                                        <td class="slds-cell-wrap " scope="col">
                                                            {!prodItem.prdlist.Phoenix_Product_Director__c}
                                                        </td>
                                                        <td class="slds-cell-wrap " scope="col">
                                                            {!prodItem.prdlist.Phoenix_Compare_to_Brand_Name__c}
                                                        </td>



                                                    </tr>
                                                </aura:iteration>
                                            </tbody>
                                        </table>
                                    </aura:if>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer slds-modal__footer"
                        style="background-color:white;padding-top:0px;padding-bottom:5px;">
                        <aura:if isTrue="{!not(empty(v.ProductList))}">
                            <lightning:layout multipleRows="true" horizontalAlign="center">
                                <lightning:layoutItem padding="around-small" flexibility="auto">
                                    <lightning:button label="First" iconName="utility:left" iconPosition="left"
                                        onclick="{!c.onFirst}" disabled="{! v.currentPageNumber == 1}" />
                                    <lightning:button iconName="utility:chevronleft" iconPosition="left"
                                        onclick="{!c.onPrev}" disabled="{! v.currentPageNumber == 1}" />
                                    <span class="slds-p-horizontal_x-small">
                                        <a onclick="{!c.processMe}" name="1"
                                            class="{! (v.currentPageNumber == 1) ? 'selected' : ''}">1</a>
                                    </span>
                                    <span class="slds-p-horizontal_xxx-small">
                                        <a>...</a>
                                    </span>
                                    <aura:iteration items="{!v.pageList}" var="item">
                                        <span class="slds-p-horizontal_x-small">
                                            <a onclick="{!c.processMe}" name="{!item}"
                                                class="{! (v.currentPageNumber == item) ? 'selected' : ''}">{!item}</a>
                                        </span>
                                    </aura:iteration>
                                    <span class="slds-p-horizontal_xxx-small">
                                        <a>...</a>
                                    </span>
                                    <span class="slds-p-horizontal_x-small">
                                        <a onclick="{!c.processMe}" name="{!v.totalPages}"
                                            class="{! (v.currentPageNumber == v.totalPages) ? 'selected' : ''}">{!v.totalPages}</a>
                                    </span>
                                    <lightning:button iconName="utility:chevronright" iconPosition="right"
                                        disabled="{! v.currentPageNumber == v.totalPages}" onclick="{!c.onNext}" />
                                    <lightning:button label="Last" iconName="utility:right" iconPosition="right"
                                        disabled="{! v.currentPageNumber == v.totalPages}" onclick="{!c.onLast}" />
                                </lightning:layoutItem>
                            </lightning:layout>

                            <lightning:button variant="neutral" label="Cancel" onclick="{!c.closeModal}" />
                            <lightning:button variant="brand" label="Next" disabled="{!v.showbutton}"
                                onclick="{!c.processProducts}" />



                            <aura:set attribute="else">
                                <div class="" style="background-color:white;">
                                    <lightning:button variant="neutral" label="Cancel" onclick="{!c.closeModal}" />
                                </div>
                            </aura:set>
                        </aura:if>
                    </div>
                </aura:if>
            </div>
        </div>

    </aura:if>
    <aura:if isTrue="{!v.showSelectedProducts}">

        <div class="panel slds-modal slds-fade-in-open" tabindex="-1" role="dialog" aria-modal="true"
            style="opacity: 1;outline:none;">
            <!--<section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open slds-modal_large" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1">-->
            <div class="slds-modal__container"
                style="max-width: 100rem !important;width: 100% !important;padding-top: 10px;">

                <div class="modal-header slds-modal__header"
                    style="padding-right: 5px; padding-top: 10px; padding-bottom: 10px; padding-left: 10px;">

                    <h2 id="modal-heading-01" class="slds-modal__title slds-hyphenate" style="color:#675e5e"><b>Edit
                            Selected Products</b></h2>

                </div>
                <div class="modal-body scrollable slds-modal__content slds-p-around--medium" data-scoped-scroll="true"
                    style="background-color:white;padding:2px 2px 2px 2px;">
                    <div class="slds-modal__content slds-p-around_large" style="padding:0px 0px 0px 0px;">
                        <aura:if isTrue="{!v.showSpinnerSelProds}">
                            <lightning:spinner variant="brand" class="spinColor" size="large" />
                        </aura:if>
                        <aura:if isTrue="{!not(empty(v.QLlist))}">
                            <table
                                class="slds-table slds-table_cell_buffered slds-max-medium-table_stacked-horizontal slds-table_bordered"
                                style="border:1px solid #eaeaea;">
                                <thead>
                                    <tr class="slds-text-title">
                                        <th scope="col" class="slds-cell-wrap slds-text-align_left">
                                            <div class="slds-truncate">Sr.No.</div>
                                        </th>
                                        <th scope="col" class="slds-cell-wrap slds-text-align_left">
                                            <div class="slds-truncate" title="Product Name">
                                                Product Name
                                            </div>
                                        </th>
                                        <th scope="col" class="slds-cell-wrap slds-text-align_left">
                                            <div class="slds-truncate" title="IPA Floor Price">
                                                IPA Floor Price
                                            </div>
                                        </th>
                                        <th scope="col" class="slds-cell-wrap slds-text-align_left">
                                            <div class="slds-truncate" title="Product Family">
                                                Product Family

                                            </div>
                                        </th>
                                        <th scope="col" class="slds-cell-wrap slds-text-align_left">
                                            <div class="slds-truncate" title="NDC">
                                                NDC
                                            </div>
                                        </th>
                                        <th scope="col" class="slds-cell-wrap slds-text-align_left">
                                            <div class="slds-truncate" title="Proposed IPA Price">
                                                Proposed IPA Price
                                            </div>
                                        </th>
                                        <th scope="col" class="slds-cell-wrap slds-text-align_left">
                                            <div class="slds-truncate" title="IDN Usage">
                                                IDN Usage
                                            </div>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <aura:iteration items="{!v.QLlist}" var="prodItem" indexVar="itemIndex">
                                        <tr class="slds-cell-wrap" scope="col">
                                            <td class="slds-cell-wrap" scope="col">
                                                {!itemIndex + 1}
                                            </td>
                                            <td class="slds-cell-wrap" scope="col" title="Product Name">
                                                <a href="{!'/'+prodItem.qlItem.Phoenix_Product__c}"
                                                    target="_blank"><br />{!prodItem.prodName}</a><br />

                                            </td>
                                            <td class="slds-cell-wrap" scope="col">

                                                <lightning:input type="currency" value="{!prodItem.IPAPrice}"
                                                    disabled="true" aura:id="productWrapperItem1" />
                                            </td>
                                            <td class="slds-cell-wrap" scope="col">
                                                <lightning:input type="text" value="{!prodItem.family}" disabled="true"
                                                    aura:id="productWrapperItem" />
                                            </td>
                                            <td class="slds-cell-wrap" scope="col">

                                                <lightning:input type="text" value="{!prodItem.NDC}" disabled="true"
                                                    aura:id="productWrapperItem1" />
                                            </td>
                                            <td class="slds-cell-wrap" scope="col">

                                                <lightning:input type="currency" currencyCode="{!v.currencyCode}"
                                                    step="1" value="{!prodItem.qlItem.Phoenix_Proposed_IPA_Price__c}"
                                                    onchange="{!c.changePrice}"
                                                    class="{!and(prodItem.qlItem.Phoenix_Proposed_IPA_Price__c>0,prodItem.IPAPrice>prodItem.qlItem.Phoenix_Proposed_IPA_Price__c)? 'colorClass':'noColorClass'}"
                                                    aura:id="price" />
                                            </td>
                                            <td class="slds-cell-wrap" scope="col">

                                                <lightning:input type="number"
                                                    value="{!prodItem.qlItem.Phoenix_IDN_Usage__c}"
                                                    aura:id="productWrapperItem1" />
                                            </td>

                                            <td class="slds-cell-wrap" scope="col" title="Delete Line Item"
                                                style="padding-top: 16px;">
                                                <lightning:button class="customBIcon" iconName="action:delete"
                                                    iconPosition="left" onclick="{!c.removeDeletedRow }"
                                                    name="{!prodItem.qlItem.Phoenix_Product__c}" />
                                            </td>

                                        </tr>

                                    </aura:iteration>
                                </tbody>
                            </table>
                        </aura:if>
                        <aura:if isTrue="{!v.isQLlistempty}">
                            <div style="text-align:center;">Please Add Products and Edit.</div>
                        </aura:if>
                    </div>
                </div>
                <div class="modal-footer slds-modal__footer" style="background-color:white;">

                    <div style="width:auto;float:left;background-color: white; border: 0px; box-shadow: none;">
                        <lightning:button variant="neutral" label="Back" onclick="{!c.ShowProdList}" />
                    </div>

                    <lightning:button variant="neutral" label="Cancel" onclick="{!c.closeModal}" />
                    <lightning:button variant="brand" label="Add To Contract" disabled="{!v.QLlist.length==0}"
                        onclick="{!c.addToContracts}" />
                </div>
            </div>
        </div>
    </aura:if>
    <aura:if isTrue="{!v.showContracts}">
        <div class="panel slds-modal slds-fade-in-open" tabindex="-1" role="dialog" aria-modal="true"
            style="opacity: 1;outline:none;">
            <!--<section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open slds-modal_large" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1">-->
            <div class="slds-modal__container"
                style="max-width: 100rem !important;width: 100% !important;padding-top: 10px;">

                <div class="modal-header slds-modal__header"
                    style="padding-right: 5px; padding-top: 10px; padding-bottom: 10px; padding-left: 10px;">

                    <h2 id="modal-heading-01" class="slds-modal__title slds-hyphenate" style="color:#675e5e"><b>Select
                            Contracts</b></h2>

                </div>
                <div class="modal-body scrollable slds-modal__content slds-p-around--medium" data-scoped-scroll="true"
                    style="background-color:white;padding:0px 0px 0px 0px;">
                    <div class="slds-modal__content slds-p-around_large" style="padding:0px 0px 0px 0px;">


                        <br />
                        <aura:if isTrue="{! !v.noContrData}">
                            <lightning:input value="{!v.searchContract}" type="search" variant="label-hidden"
                                placeholder="Contract Number and Owner and Customer Name...." aura:id="SearchBox"
                                label="Contract Number and Owner and Customer Name" onchange="{!c.onContractsearch}"
                                style="margin-top:0px;" />
                            <span style="float:right;margin-top:3px;">
                                <lightning:button onclick="{!c.searchcontractTable}" variant="neutral" label="Search"
                                    iconName="utility:search" />

                            </span><br />
                            <span class="slds-badge slds-badge_lightest"
                                style="display:inline-block;margin-bottom:3px;">
                                Selected Contracts : {!v.contractCount}
                            </span>
                        </aura:if>
                        <aura:if isTrue="{!v.noContrData}">
                            <div class="matchPanelError" tabindex="0" role="alert" style="text-align:center;">
                                <span>No Contracts found.</span>
                            </div>
                        </aura:if>
                        <aura:if isTrue="{!v.noContractData}">
                            <div class="matchPanelError" tabindex="0" role="alert"
                                style="color:#c23934;text-align:center;">
                                <span>No search results found.</span>
                            </div>
                        </aura:if>
                        <aura:if isTrue="{!v.showSpinnerSelProds}">
                            <lightning:spinner variant="brand" class="spinColor" size="large" />
                        </aura:if>

                        <aura:if isTrue="{!not(empty(v.contractList))}">
                            <table
                                class="slds-table slds-table_cell_buffered slds-max-medium-table_stacked-horizontal slds-table_bordered"
                                style="border:1px solid #eaeaea;">
                                <thead>
                                    <tr class="slds-text-title">
                                        <th scope="col" class="slds-cell-wrap slds-text-align_left">
                                            <div class="slds-truncate">
                                                <lightning:input type="checkbox" class="slds-checkbox" name=""
                                                    checked="{!v.selectAllContr}" aura:id="checkbox"
                                                    onchange="{!c.onselectAllContract}" />
                                            </div>

                                        </th>
                                        <th scope="col" class="slds-cell-wrap " onclick="{!c.sortContractNumber}">
                                            <div class="slds-truncate" title="Contract Number">
                                                <a href="javascript:void(0);"
                                                    class="slds-th__action slds-text-link--reset">
                                                    <span class="slds-assistive-text">Sort</span>
                                                    <span class="slds-truncate" title="Name">Contract Number</span>
                                                    <aura:if
                                                        isTrue="{! and(v.arrowDirection == 'arrowdown', v.selectedTabsoft == 'ContractNumber') }">
                                                        &nbsp; &#9660; </aura:if>
                                                    <aura:if
                                                        isTrue="{! and(v.arrowDirection != 'arrowdown', v.selectedTabsoft == 'ContractNumber') }">
                                                        &nbsp; &#9650; </aura:if>
                                                </a>
                                            </div>
                                        </th>

                                        <th scope="col" class="slds-cell-wrap " onclick="{!c.sortContractOwner}">
                                            <div class="slds-truncate" title="Contract Owner">
                                                <a href="javascript:void(0);"
                                                    class="slds-th__action slds-text-link--reset">
                                                    <span class="slds-assistive-text">Sort</span>
                                                    <span class="slds-truncate" title="Name">Contract Owner</span>
                                                    <aura:if
                                                        isTrue="{! and(v.arrowDirection == 'arrowdown', v.selectedTabsoft == 'ContractOwner') }">
                                                        &nbsp; &#9660; </aura:if>
                                                    <aura:if
                                                        isTrue="{! and(v.arrowDirection != 'arrowdown', v.selectedTabsoft == 'ContractOwner') }">
                                                        &nbsp; &#9650; </aura:if>
                                                </a>
                                            </div>
                                        </th>

                                        <th scope="col" class="slds-cell-wrap " onclick="{!c.sortExternalDescription}">
                                            <div class="slds-truncate" title="External Description">
                                                <a href="javascript:void(0);"
                                                    class="slds-th__action slds-text-link--reset">
                                                    <span class="slds-assistive-text">Sort</span>
                                                    <span class="slds-truncate" title="Name">External Description</span>
                                                    <aura:if
                                                        isTrue="{! and(v.arrowDirection == 'arrowdown', v.selectedTabsoft == 'ExternalDescription') }">
                                                        &nbsp; &#9660; </aura:if>
                                                    <aura:if
                                                        isTrue="{! and(v.arrowDirection != 'arrowdown', v.selectedTabsoft == 'ExternalDescription') }">
                                                        &nbsp; &#9650; </aura:if>
                                                </a>
                                            </div>
                                        </th>
                                        <th scope="col" class="slds-cell-wrap " onclick="{!c.sortInternalDescription}">
                                            <div class="slds-truncate" title="Internal Description">
                                                <a href="javascript:void(0);"
                                                    class="slds-th__action slds-text-link--reset">
                                                    <span class="slds-assistive-text">Sort</span>
                                                    <span class="slds-truncate" title="Name">Internal Description</span>
                                                    <aura:if
                                                        isTrue="{! and(v.arrowDirection == 'arrowdown', v.selectedTabsoft == 'InternalDescription') }">
                                                        &nbsp; &#9660; </aura:if>
                                                    <aura:if
                                                        isTrue="{! and(v.arrowDirection != 'arrowdown', v.selectedTabsoft == 'InternalDescription') }">
                                                        &nbsp; &#9650; </aura:if>
                                                </a>
                                            </div>
                                        </th>

                                        <th scope="col" class="slds-cell-wrap " onclick="{!c.sortCustomerName}">
                                            <div class="slds-truncate" title="Customer Name">
                                                <a href="javascript:void(0);"
                                                    class="slds-th__action slds-text-link--reset">
                                                    <span class="slds-assistive-text">Sort</span>
                                                    <span class="slds-truncate" title="Name">Customer Name</span>
                                                    <aura:if
                                                        isTrue="{! and(v.arrowDirection == 'arrowdown', v.selectedTabsoft == 'CustomerName') }">
                                                        &nbsp; &#9660; </aura:if>
                                                    <aura:if
                                                        isTrue="{! and(v.arrowDirection != 'arrowdown', v.selectedTabsoft == 'CustomerName') }">
                                                        &nbsp; &#9650; </aura:if>
                                                </a>
                                            </div>
                                        </th>
                                        <th scope="col" class="slds-cell-wrap " onclick="{!c.sortCustomerNumber}">
                                            <div class="slds-truncate" title="Customer Number">
                                                <a href="javascript:void(0);"
                                                    class="slds-th__action slds-text-link--reset">
                                                    <span class="slds-assistive-text">Sort</span>
                                                    <span class="slds-truncate" title="Name">Customer Number</span>
                                                    <aura:if
                                                        isTrue="{! and(v.arrowDirection == 'arrowdown', v.selectedTabsoft == 'Customer Number') }">
                                                        &nbsp; &#9660; </aura:if>
                                                    <aura:if
                                                        isTrue="{! and(v.arrowDirection != 'arrowdown', v.selectedTabsoft == 'Customer Number') }">
                                                        &nbsp; &#9650; </aura:if>
                                                </a>
                                            </div>
                                        </th>

                                        <!--th scope="col" class="slds-cell-wrap slds-text-align_left">
                                        <div class="slds-truncate" title="Type of Change">
                                         Type of Change
                                        </div>
                                    </th-->





                                    </tr>
                                </thead>
                                <tbody>
                                    <aura:iteration items="{!v.contractList}" var="prodItem" indexVar="itemIndex">
                                        <tr class="slds-text-title">
                                            <td class="slds-cell-wrap" scope="col">
                                                <lightning:input type="checkbox" class="slds-checkbox"
                                                    name="{!prodItem.contrt.Id}" checked="{!prodItem.contrFlag}"
                                                    aura:id="checkbox" onchange="{!c.contractCheckBoxHandler}" />
                                            </td>
                                            <td class="slds-cell-wrap" scope="col" title="Contract Number">
                                                <a href="{!'/'+prodItem.contrt.Id}"
                                                    target="_blank"><br />{!prodItem.contrt.Phoenix_Contract_Number__c}</a>

                                            </td>
                                            <td class="slds-cell-wrap" scope="col" title="Contract Number">
                                                <a href="{!'/'+prodItem.contrt.OwnerId}"
                                                    target="_blank"><br />{!prodItem.contrt.Owner.Name}</a>

                                            </td>
                                            <td class="slds-cell-wrap" scope="col">
                                                {!prodItem.contrt.Phoenix_Contract_External_Description__c}
                                            </td>
                                            <td class="slds-cell-wrap" scope="col">
                                                {!prodItem.contrt.Phoenix_Contract_Internal_Description__c}
                                            </td>
                                            <td class="slds-cell-wrap" scope="col">
                                                <a href="{!'/'+prodItem.contrt.Phoenix_Customer__c}"
                                                    target="_blank"><br />{!prodItem.contrt.Phoenix_Customer__r.Name}</a>
                                                <!--lightning:input type="text" value="{!prodItem.contrt.Phoenix_Customer__r.Name}" disabled="true"  aura:id="productWrapperItem1" /-->
                                            </td>
                                            <td class="slds-cell-wrap" scope="col">
                                                {!prodItem.contrt.Phoenix_Customer_Number__c}
                                            </td>
                                            <!--td class="slds-cell-wrap" scope="col">
                                            <lightning:select name="{!itemIndex}" required="false"  value="{!prodItem.contrt.Phoenix_Type_of_Change}" label="" variant="label-hidden">
                                                                <option value="">None
                                                                      </option>       
                                                <option value="Product Addition">Product Addition	
                                                                      </option>
                                                                      <option value="Developmental">Price Change
                                                                      </option>
                                                                      
                                                                  </lightning:select>
                                        </td-->

                                        </tr>

                                    </aura:iteration>
                                </tbody>
                            </table>
                        </aura:if>

                    </div>
                </div>
                <div class="modal-footer slds-modal__footer" style="background-color:white;">

                    <div style="width:auto;float:left;background-color: white; border: 0px; box-shadow: none;">
                        <lightning:button variant="neutral" label="Back" onclick="{!c.ShowSelectedProdList}" />
                    </div>

                    <lightning:button variant="neutral" label="Cancel" onclick="{!c.closeModal}" />
                    <lightning:button variant="brand" label="Save &amp; Close"
                        disabled="{!v.selectedContractIds.length==0}" onclick="{!c.insertProducts}" />
                </div>
            </div>
        </div>
    </aura:if>
</aura:component>