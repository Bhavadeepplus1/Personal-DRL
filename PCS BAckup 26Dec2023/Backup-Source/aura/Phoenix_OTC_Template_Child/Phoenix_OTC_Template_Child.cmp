<!--
  @description       : 
  @author            : Surender Patel (Dhruvsoft)
  @group             : 
  @last modified on  : 29-05-2021
  @last modified by  : Surender Patel (Dhruvsoft)
  Modifications Log 
  Ver   Date         Author                       Modification
  1.0   29-05-2021   Surender Patel (Dhruvsoft)   Initial Version
-->
<aura:component controller="Phoenix_OTCTemplateCls" access="global">
    <aura:handler name="init" value="{!this}" action="{!c.doInit}" />
    <aura:attribute name="objInfoForPicklistValues" type="account" default="{sobjectType : 'Phoenix_Bid_Line_Item__c'}"
                    description="object information to fetch picklist values" />
    <aura:attribute name="items" type="Object[]" default="[]" />
    <aura:attribute name="ratingPicklistOpts" type="string[]" description="store picklist options values" />
    <aura:attribute name="showSaveCancelBtn" type="boolean" />
    <aura:attribute name="showErrorClass" type="boolean" default="false" />
    <aura:attribute name="sNo" type="string" />
    <aura:attribute name="customerId" type="string" />
    <aura:attribute name="lineItemId" type="String" />
    <aura:attribute name="productId" type="String" />
    <aura:attribute name="CISUEditMode" type="boolean" default="false" />
    <aura:attribute name="PSEditMode" type="boolean" default="false" />
    <aura:attribute name="PORISUditMode" type="boolean" default="false" />
    <aura:attribute name="TPTEditMode" type="boolean" default="false" />
    <aura:attribute name="PORDSUEditMode" type="boolean" default="false" />
    <aura:attribute name="SupplyTypeEditMode" type="boolean" default="false" />
    <aura:attribute name="CDSUEditMode" type="boolean" default="false" />
    <aura:attribute name="PISUditMode" type="boolean" default="false" />
    <aura:attribute name="PDSUEditMode" type="boolean" default="false" />
    <aura:attribute name="WDPIEditMode" type="boolean" default="false" />
    <aura:attribute name="GDPEditMode" type="boolean" default="false" />
    <aura:attribute name="PCBPSEditMode" type="boolean" default="false" />
    <aura:attribute name="retailPriceEditMode" type="boolean" default="false" />
    <aura:attribute name="FAPCEditMode" type="boolean" default="false" />
    <aura:attribute name="PCREditMode" type="boolean" default="false" />
    <aura:attribute name="PPUREditMode" type="boolean" default="false" />
    <aura:attribute name="ISOVEditMode" type="boolean" default="false" />
    <aura:attribute name="EstDaysEditMode" type="boolean" default="false" />
    <aura:attribute name="adminFeeEditMode" type="boolean" default="false" />
    <aura:attribute name="ISOCEditMode" type="boolean" default="false" />
    <aura:attribute name="BudASPEditMode" type="boolean" default="false" />
    <aura:attribute name="SalesNotesEditMode" type="boolean" default="false" />
    <aura:attribute name="SCMNotesEditMode" type="boolean" default="false" />
    <aura:attribute name="PriNotesEditMode" type="boolean" default="false" />
    <aura:attribute name="MarkNotesEditMode" type="boolean" default="false" />
    <aura:attribute name="MarkLeadNotesEditMode" type="boolean" default="false" />
    <aura:attribute name="PCBPEditMode" type="boolean" default="false" />
    <aura:attribute name="isSpinner" type="boolean" default="false" />
    <aura:attribute name="rebateTypeEdit" type="boolean" default="false" />
    <aura:attribute name="feeTypeEdit" type="boolean" default="false" />
    <aura:attribute name="MarketApprovalEditMode" type="boolean" default="false" />
    <aura:attribute name="MarketLeadApprovalEditMode" type="boolean" default="false" />
    <aura:attribute name="ContractApprovalEditMode" type="boolean" default="false" />
    <aura:attribute name="damageEditMode" type="boolean" default="false" />
    
    <aura:attribute name="isAccpetable" type="boolean" default="false" />
    <aura:attribute name="isNotAccpetable" type="boolean" default="false" />
    <aura:attribute name="isDirectAccpetable" type="boolean" default="false" />
    <aura:attribute name="isDirectNotAccpetable" type="boolean" default="false" />
    
    <aura:attribute name="isIndirectAccpetable" type="boolean" default="false" />
    <aura:attribute name="isIndirectNotAccpetable" type="boolean" default="false" />
    
    <aura:attribute name="tableRef" type="String" />
    <aura:attribute name="singleRec" type="sobject" />
    <aura:attribute name="isSpecificCust" type="boolean" default="false" />
    <!-- Future Record attributes -->
    <aura:attribute name="displayFutureDisplay" type="boolean" default="false" />
    <aura:attribute name="templateType" type="string" default="" />
    <aura:attribute name="bidType" type="string" default="" />
    <aura:attribute name="loggedInUserName" type="string" default="" />
    <aura:attribute name="BidAprrovalStatus" type="string" default="" />
    <aura:attribute name="isMarketingApprovePerson" type="string" />
    <aura:attribute name="isCustomersApprovePerson" type="string" />
    <aura:attribute name="isMarketLeadApprovePerson" type="boolean" />
    
    
    <aura:attribute name="ItemsLength" type="Decimal" />
    <aura:attribute name="RMPercent" type="Decimal" />
    <aura:attribute name="CDSUTotal" type="Decimal" />
    <aura:attribute name="currentSalesFinance" type="Decimal" />
    <aura:attribute name="currentTPMargin" type="Decimal" />
    <aura:attribute name="tptTotal" type="Decimal" />
    
    <aura:attribute name="TotalSellingUnits" type="Decimal" />
    <aura:attribute name="CISUTotal" type="Decimal" />
    <aura:attribute name="currentMonthly" type="Decimal" />
    <aura:attribute name="current52week" type="Decimal" />
    <aura:attribute name="proposed52wk" type="Decimal" />
    <aura:attribute name="proposedMonthly" type="Decimal" />
    <aura:attribute name="PISUTotal" type="Decimal" />
    <aura:attribute name="PDSUTotal" type="Decimal" />
    <aura:attribute name="netSalesIntTotal" type="Decimal" />
    <aura:attribute name="grossSalesTotal" type="Decimal" />
    <aura:attribute name="LCostTotal" type="Decimal" />
    <aura:attribute name="ThptMrgnDTotal" type="Decimal" />
    <aura:attribute name="intDeadNetTotal" type="Decimal" />
    <aura:attribute name="scmAPQTY" type="Decimal" />
    <aura:attribute name="overRideDirectUnits" type="Decimal" />
    <aura:attribute name="overRideIndirectUnits" type="Decimal" />
    <aura:attribute name="actSaDir12Months" type="Decimal" />
    <aura:attribute name="actSalInd12months" type="Decimal" />
    <aura:attribute name="iodAmountTotal" type="Decimal" />
    <aura:attribute name="salesoutAmountTotal" type="Decimal" />
    <aura:attribute name="TPTPercent" type="Decimal" />
    <aura:attribute name="direNetSales" type="Decimal" />
    <aura:attribute name="IndirNetSales" type="Decimal" />
    <aura:attribute name="totalNetSaes" type="Decimal" />
    <aura:attribute name="direTPTDollar" type="Decimal" />
    <aura:attribute name="indirTPTDollar" type="Decimal" />
    <aura:attribute name="totalTPTDollar" type="Decimal" />
    <aura:attribute name="totalProfit" type="Decimal" />
    <aura:attribute name="finalUnitsTotal" type="Decimal" />
    <aura:attribute name="finaAnnuallUnits" type="Decimal" />
    <aura:attribute name="finalMontlyUnits" type="Decimal" />
    <aura:attribute name="today" type="Date" default=""/>
    <!--Pricing History Analytics- Attributes-START -->
    
    <aura:registerEvent name="lightningEvent1" type="c:Phoenix_BidPricingHistoryEvt" />
    <aura:attribute name="displayBidHist" type="String" default="false" />
    <aura:attribute name="displayProdNPRHist" type="String" default="false" />
    <aura:attribute name="displayIMS" type="String" default="false" />
    <aura:attribute name="displayHistPricing" type="String" default="false" />
    <aura:attribute name="isModalOpen" type="Boolean" default="false" />
    <aura:attribute name="isPositionsModalOpen" type="Boolean" default="false" />
    <aura:attribute name="PositionsEditMode" type="boolean" default="false" />
    <aura:attribute name="recordId" type="Id" />
    <aura:attribute name="bidLineItemId" type="String" />
    <aura:attribute name="bidRecordParent" type="sObject" />
    <aura:attribute name="LinepositionColumns" type="List" />
    <!--Pricing History Analytics- Attributes END-->
    <aura:attribute name="isGoalseekModalOpen" type="Boolean" default="false" />
    <aura:attribute name="isIndirectGoalseekModalOpen" type="Boolean" default="false" />
    <aura:attribute name="expectDdeadnet" type="Decimal" />
    <aura:attribute name="expectIndirectDdeadnet" type="Decimal" />
    <aura:attribute name="expectCustmerDdeadnet" type="Decimal" />
    <aura:attribute name="RequiredPrice" type="Decimal" />
    <aura:attribute name="RequiredIndirectPrice" type="Decimal" />
    <aura:attribute name="errMsg" type="String" access="global" />
    <aura:attribute name="errIndirectMsg" type="String" access="global" />
    <aura:attribute name="err" type="boolean" default="false" />
    <aura:attribute name="errIndirect" type="boolean" default="false" />
    <aura:attribute name="ShowSaveButton" type="boolean" default="false" />
    <aura:attribute name="showHistory" type="boolean" default="false" />
    <aura:attribute name="showTotals" type="boolean" default="false" />
    <aura:attribute name="EstimatedDaysFieldValues" type="List" default="0,7,15,20,30,45,60,75,90,120" />
    <aura:attribute name="latestVersion" type="String"  />
    <!-- rebid start-->
    <aura:attribute name="ReBidListAll" type="List" />
    <aura:attribute type="List" name="LinepositionsList" />
    <aura:registerEvent name="calcEvent" type="c:TotalCalculationEvt" />
    <aura:attribute name="isReBid" type="Boolean" default="false" />
    <aura:registerEvent name="lightningEvent" type="c:RefreshBidLineItemCmpEvt" />
    <aura:attribute name="isdeligationApprover" type="Boolean" default="false" />
    <aura:attribute name="ContSDFEditMode" type="boolean" default="false" />
    <!--New Product Launch-->
    <aura:attribute name="OpeningOrderEditMode" type="boolean" default="false" />
    <aura:attribute name="CSUPEditMode" type="boolean" default="false" />
    
    
    <aura:attribute name="custAppEditMode" type="boolean" default="false" />
    <aura:attribute name="custCommentsEditMode" type="boolean" default="false" />
    <aura:attribute name="SEDEditMode" type="boolean" default="false" />
    <aura:attribute name="PEDEditMode" type="boolean" default="false" />
    
    
    <aura:attribute name="cdEditMode" type="boolean" default="false" />
    <aura:attribute name="CSPEditMode" type="boolean" default="false" />
    <aura:attribute name="WacEditMode" type="boolean" default="false" />
    <aura:attribute name="vipEditMode" type="boolean" default="false" />
    <aura:attribute name="OpeningOrderTotal" type="Decimal" />
    <aura:attribute name="OpeningOrderNetSalesTotal" type="Decimal" />
    <aura:attribute name="OpeningOrderTPTTotal" type="Decimal" />
    <aura:attribute name="OpeningOrderTPTPercTotal" type="Decimal" />
    <aura:attribute name="isCurrentVersion" type="boolean" default="false" />
    <!-- END New Product Launch-->
    
    <!-- Deligation attributes -->
    <aura:attribute name="deligatedUserName" type="String" default="" />
    <aura:attribute name="ismarketingDeligator" type="boolean" default="false" />
    
    <aura:attribute name="Deadnet" type="decimal"  />
    
    <aura:attribute name="priceHistoryData" type="Phoenix_Bid_Line_Item_Price_History__c[]"  />
    <aura:attribute name="currentHistory" type="Phoenix_Bid_Line_Item_Price_History__c"  />
    <!--Bid Histroy Analytics Modal Popup-START-->
    <aura:if isTrue="{!v.displayBidHist}">
        <c:OTCSPAHistoryCmp tableRef="{!v.tableRef}" recordId="{!v.recordId}"
                            displayBidHist="{!v.displayBidHist}" bidLineItemId="{!v.bidLineItemId}" />
        
    </aura:if>
    <!--Bid Histroy Analytics Modal Popup-END-->
    
    <!--Historical Pricing Analytics Modal Popup-START-->
    <aura:if isTrue="{!v.displayHistPricing}">
        <c:Phoenix_HistPricingAnalytics tableRef="{!v.tableRef}" recordId="{!v.recordId}"
                                        displayHistPricing="{!v.displayHistPricing}" bidLineItemId="{!v.bidLineItemId}" />
    </aura:if>
    <!--Historical Pricing Analytics Modal Popup-END-->
    
    <!--NPR Product Histroy Analytics Modal Popup-START-->
    <aura:if isTrue="{!v.displayProdNPRHist}">
        <c:Phoenix_NPRHistory tableRef="{!v.tableRef}" recordId="{!v.recordId}"
                              displayProdNPRHist="{!v.displayProdNPRHist}" bidLineItemId="{!v.bidLineItemId}" />
    </aura:if>
    <!--NPR Product Histroy Analytics Modal Popup-END-->
    
    <!--IMS Market Share Analytics Modal Popup-START-->
    <aura:if isTrue="{!v.displayIMS}">
        <c:Phoenix_IMSMaketShare tableRef="{!v.tableRef}" recordId="{!v.recordId}" displayIMS="{!v.displayIMS}"
                                 bidLineItemId="{!v.bidLineItemId}" />
    </aura:if>
    <!--IMS Market Share Analytics Modal Popup-END-->
    <aura:if isTrue="{!v.displayFutureDisplay}">
        <c:Phoenix_FutureNPRData
                                 productId ="{!v.productId}" lineItemId="{!v.lineItemId}" tableRef="{!v.tableRef}" displayFutureDisplay="{!v.displayFutureDisplay}"/>
    </aura:if>
    
    <aura:if isTrue="{!v.isGoalseekModalOpen}">
        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
            
            <div class="slds-modal__container" style="width:50% ! important;">
                
                <!-- Modal/Popup Box Header Starts here-->
                <header class="slds-modal__header">
                    <lightning:buttonIcon iconName="utility:close"
                                          onclick="{!c.closeGoalseekPopup}"
                                          alternativeText="close"
                                          variant="bare-inverse"
                                          class="slds-modal__close"/>
                    <h2 class="slds-text-heading_medium slds-hyphenate"><b>Goal Seek</b></h2>      
                </header>
                <div class="slds-modal__content slds-p-around_medium" >
                    <div class="slds-grid">
                        <div class="slds-col slds-size_1-of-3">
                            <lightning:input placeholder="Enter Expected Net Price" type="number" formatter="currency" step="0.01" class="lableInput" name="input1" label="Expected Internal Dead Net Price" value="{!v.expectDdeadnet}" onchange="{!c.calcGoalSeek}"/>
                        </div><br/>
                        <div class="slds-col slds-size_1-of-3 slds-m-left_small slds-m-top_xxx-small">
                            Required Sell Price
                            <div>
                                <lightning:formattedNumber value="{!v.RequiredPrice}" style="currency" currencyCode="USD" maximumFractionDigits="2"/>
                            </div>  
                            <aura:if isTrue="{!v.err}">
                                <div class="slds-section">
                                    <ui:message title="" severity="error">
                                        <strong style="color:red">{!v.errMsg}</strong>
                                    </ui:message>
                                </div>
                            </aura:if>
                        </div>                        
                    </div>
                </div>
                <footer class="slds-modal__footer">
                    <lightning:button variant="neutral"
                                      label="Cancel"
                                      title="Cancel"
                                      onclick="{! c.closeGoalseekPopup }"/>
                    <aura:if isTrue="{!v.ShowSaveButton}">
                        <lightning:button variant="neutral" label="Save" title="Save" onclick="{!c.onCISUChange }" />
                    </aura:if>
                </footer>
            </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
    </aura:if>
    
    <aura:if isTrue="{!v.isModalOpen}">
        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
                 aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
            
            <div class="slds-modal__container" style="width:80% ! important;">
                
                <!-- Modal/Popup Box Header Starts here-->
                <header class="slds-modal__header">
                    <lightning:buttonIcon iconName="utility:close" onclick="{!c.closePopup}" alternativeText="close"
                                          variant="bare-inverse" class="slds-modal__close" />
                    <aura:if isTrue="{! not(empty(v.ReBidListAll))}">
                        <h2 class="slds-text-heading_medium slds-hyphenate"><b>Previous Prices</b></h2>
                    </aura:if>
                </header>
                <!--Modal/Popup Box Body Starts here-->
                <!--div class="slds-scrollable" style="height: 100rem; width: 46rem"-->
                <div class="slds-modal__content slds-p-around_medium">
                    <aura:if isTrue="{!v.showHistory}">
                        <table class="slds-table slds-table_cell_buffered slds-max-medium-table_stacked-horizontal slds-table_bordered"
                               style="border:1px solid #eaeaea;">
                            <thead>
                                
                                <tr class="slds-text-title">
                                    <th scope="col" class="slds-cell-wrap ">
                                        <div class="slds-truncate" title="Version"> Version </div>
                                    </th>
                                    <th scope="col" class="slds-cell-wrap ">
                                        <div class="slds-truncate" title="Created Date">Created Date</div>
                                    </th>
                                    <th scope="col" class="slds-cell-wrap ">
                                        <div class="slds-truncate" title="Bid Status"> DRL Units</div>
                                    </th>
                                    <th scope="col" class="slds-cell-wrap ">
                                        <div class="slds-truncate" title="Bid Status"> Marketing Price</div>
                                    </th>
                                    <th scope="col" class="slds-cell-wrap ">
                                        <div class="slds-truncate" title="Guided Price">Sales Price 
                                        </div>
                                    </th>
                                    
                                </tr>
                            </thead>
                            <tbody>
                                <aura:iteration items="{!v.ReBidListAll}" var="prodItem" indexVar="itemIndex">
                                    <tr>
                                        <td class="slds-cell-wrap" scope="col"> <a href="{!'/'+prodItem.Phoenix_Bid__c}"
                                                                                   target="_blank">{!prodItem.Phoenix_Bid__r.Name}</a></td>
                                        <td class="slds-cell-wrap" scope="col">
                                            <lightning:formattedDateTime 
                                                                         value="{!prodItem.Phoenix_Bid__r.CreatedDate}" />
                                        </td>
                                        <td class="slds-cell-wrap slds-text-align_right" scope="col">
                                            <lightning:formattedNumber value="150"
                                                                       style="Number" ></lightning:formattedNumber>
                                        </td>
                                        
                                        <td class="slds-cell-wrap slds-text-align_right" scope="col">
                                            <lightning:formattedNumber value="35"
                                                                       style="currency" currencyCode="USD"></lightning:formattedNumber>
                                        </td>
                                        <td class="slds-cell-wrap slds-text-align_right" scope="col">
                                            <lightning:formattedNumber
                                                                       value="50"
                                                                       style="currency" currencyCode="USD"></lightning:formattedNumber>
                                        </td>
                                        
                                        
                                    </tr>
                                </aura:iteration>
                            </tbody>
                        </table>
                        <aura:set attribute="else">
                            <p style="text-align:center">No previous prices found.</p>
                        </aura:set>
                    </aura:if>
                    <aura:if isTrue="{! not(empty(v.ReBidListAll))}">
                        <table
                               class="slds-table slds-table_cell_buffered slds-max-medium-table_stacked-horizontal slds-table_bordered"
                               style="border:1px solid #eaeaea;">
                            <thead>
                                
                                <tr class="slds-text-title">
                                    
                                    <th scope="col" class="slds-cell-wrap ">
                                        <div class="slds-truncate" title="Bid"> Bid </div>
                                    </th>
                                    <th scope="col" class="slds-cell-wrap ">
                                        <div class="slds-truncate" title="Created Date">Created Date</div>
                                    </th>
                                    <th scope="col" class="slds-cell-wrap ">
                                        <div class="slds-truncate" title="Bid Status"> Bid Status</div>
                                    </th>
                                    <th scope="col" class="slds-cell-wrap ">
                                        <div class="slds-truncate" title="Guided Price">Guidance Price
                                        </div>
                                    </th>
                                    <aura:if isTrue="{!v.templateType=='Direct and Indirect'}">
                                        <th scope="col" class="slds-cell-wrap slds-text-align_right">
                                            <div class="slds-truncate" title="Contract Price"> Contract Direct Price (Marketing)</div>
                                        </th>
                                        <aura:set attribute="else">
                                            <th scope="col" class="slds-cell-wrap slds-text-align_right">
                                                <div class="slds-truncate" title="Contract Price"> Contract Bid Price (Marketing)</div>
                                            </th>
                                        </aura:set>
                                    </aura:if>
                                    <aura:if isTrue="{!v.templateType=='Direct and Indirect'}">
                                        <th scope="col" class="slds-cell-wrap slds-text-align_right">
                                            <div class="slds-truncate" title="Contract Price"> Contract Indirect Price (Marketing)</div>
                                        </th>
                                    </aura:if>
                                    
                                </tr>
                            </thead>
                            <tbody>
                                <aura:iteration items="{!v.ReBidListAll}" var="prodItem" indexVar="itemIndex">
                                    <tr>
                                        <td class="slds-cell-wrap" scope="col"> <a href="{!'/'+prodItem.Phoenix_Bid__c}"
                                                                                   target="_blank">{!prodItem.Phoenix_Bid__r.Name}</a></td>
                                        <td class="slds-cell-wrap" scope="col">
                                            <lightning:formattedDateTime
                                                                         value="{!prodItem.Phoenix_Bid__r.CreatedDate}" />
                                        </td>
                                        <td class="slds-cell-wrap" scope="col">
                                            {!prodItem.Phoenix_Bid__r.Phoenix_Approval_Status__c}</td>
                                        <td class="slds-cell-wrap slds-text-align_right" scope="col">
                                            <lightning:formattedNumber value="{!prodItem.Phoenix_Guidance_Price__c}"
                                                                       style="currency" currencyCode="USD"></lightning:formattedNumber>
                                        </td>
                                        <td class="slds-cell-wrap slds-text-align_right" scope="col">
                                            <lightning:formattedNumber
                                                                       value="{!prodItem.Phoenix_Final_Approvd_Pricing_Contracts__c}"
                                                                       style="currency" currencyCode="USD"></lightning:formattedNumber>
                                        </td>
                                        <aura:if isTrue="{!v.templateType=='Direct and Indirect'}">
                                            <aura:if isTrue="{!(prodItem.Phoenix_Wholesaler_Diff_Price_Indirect__c != null)}">
                                                <td class="slds-cell-wrap slds-text-align_right" scope="col">
                                                    <lightning:formattedNumber
                                                                               value="{!prodItem.Phoenix_Wholesaler_Diff_Price_Indirect__c}"
                                                                               style="currency" currencyCode="USD"></lightning:formattedNumber>
                                                </td>
                                                <aura:set attribute="else">
                                                    <td class="slds-cell-wrap slds-text-align_right" scope="col">
                                                        <lightning:formattedNumber
                                                                                   value="{!prodItem.Phoenix_Current_Indirect_Price__c}"
                                                                                   style="currency" currencyCode="USD"></lightning:formattedNumber>
                                                    </td>
                                                </aura:set>
                                            </aura:if>
                                        </aura:if>
                                        
                                    </tr>
                                </aura:iteration>
                            </tbody>
                        </table>
                        <aura:set attribute="else">
                            <p style="text-align:center">No previous prices found.</p>
                        </aura:set>
                    </aura:if>
                </div>
                <!--/div-->
                <!--Modal/Popup Box Footer Starts here-->
                <footer class="slds-modal__footer">
                    <lightning:button variant="neutral" label="Cancel" title="Cancel" onclick="{! c.closePopup }" />
                    
                </footer>
            </div>
            
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
        
    </aura:if>
    <!--StartProductPosition Model-->
    <aura:if isTrue="{!v.isPositionsModalOpen}">
        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
                 aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
            
            <div class="slds-modal__container">
                
                <!-- Modal/Popup Box Header Starts here-->
                <header class="slds-modal__header">
                    <lightning:buttonIcon iconName="utility:close" onclick="{!c.closePositionsPopup}"
                                          alternativeText="close" variant="bare-inverse" class="slds-modal__close" />
                    
                    <h2 class="slds-text-heading_medium slds-hyphenate"><b>Product Positions</b></h2>
                    
                </header>
                <!--Modal/Popup Box Body Starts here-->
                <!--div class="slds-scrollable" style="height: 100rem; width: 46rem"-->
                <div class="slds-modal__content slds-p-around_medium">
                    <P>
                        <aura:if isTrue="{!not(empty(v.LinepositionsList))}">
                            <lightning:datatable aura:id="PoslineLevelTable" data="{! v.LinepositionsList }"
                                                 columns="{! v.LinepositionColumns }" keyField="Name"
                                                 selectedRows="{! v.LineselectedPosistions }" />
                            <aura:set attribute="else">
                                <center>
                                    <div class="slds-notify slds-notify_alert slds-theme_alert-texture slds-theme_info slds-m-left_xx-large slds-m-right_xx-large"
                                         role="alert" style="width:50%;">
                                        <span class="slds-icon_container slds-m-right_x-small"
                                              title="Please add line items to view the table">
                                            <lightning:icon iconName="utility:info" alternativeText="info"
                                                            size="x-small" variant="inverse" />
                                        </span>
                                        <h2> No Records Found</h2>
                                    </div>
                                </center>
                            </aura:set>
                        </aura:if>
                    </P>
                </div>
                <!--/div-->
                <!--Modal/Popup Box Footer Starts here-->
                <footer class="slds-modal__footer">
                    <lightning:button variant="neutral" label="Cancel" title="Cancel"
                                      onclick="{! c.closePositionsPopup }" />
                    <lightning:button variant="brand" label="Save" title="Save" onclick="{! c.savePositions }" />
                    
                </footer>
            </div>
            
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
        
    </aura:if>
    <!--End Product positions Mode-->
    
    <aura:if isTrue="{!v.showHistory}">
        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
                 aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
            
            <div class="slds-modal__container" style="width:90% ! important;">
                
                <!-- Modal/Popup Box Header Starts here-->
                <header class="slds-modal__header">
                    <lightning:buttonIcon iconName="utility:close" onclick="{!c.closeHistPopup}" alternativeText="close"
                                          variant="bare-inverse" class="slds-modal__close" />
                    <h2 class="slds-text-heading_medium slds-hyphenate mainHeader"><b>OTC Bid History</b></h2>
                </header>
                <!--Modal/Popup Box Body Starts here-->
                <!--div class="slds-scrollable" style="height: 100rem; width: 46rem"-->
                <div class="slds-modal__content slds-p-around_medium">
                    <aura:if isTrue="{!v.showHistory}">
                        <aura:if isTrue="{!(v.priceHistoryData.length >0)}">
                            <div class="slds-scrollable_y slds-scrollable_x">
                                <table class="historyTable">
                                    <tr>
                                        <th ></th>
                                        <th >Version</th>
                                        <th >Final DRL Units</th>
                                        <th >Current Sell Price</th>
                                        <th >Proposed Sell Price</th>
                                        <th >Diff In Sell Price</th>
                                        <th >% Change of Proposed Sell Price</th>
                                        <th >TPT % per pack</th>
                                        <th >Customer Comments</th>
                                        <th >Created Date</th>
                                        <th >Created By</th>
                                        
                                    </tr>
                                    <aura:iteration items="{!v.priceHistoryData}" var="item" indexVar="itemIndex" >
                                        <tr>
                                            <td scope="row" >
                                                <div class="slds-text-align_center">
                                                    <lightning:buttonIcon value="{!itemIndex}" onclick="{!c.toggle}" iconName="{!item.expanded?'utility:chevrondown':'utility:chevronright'}" />
                                                </div>
                                            </td>             
                                            <td scope="row">
                                                <aura:if isTrue="{!(item.Name== v.latestVersion)}">
                                                    <div class="slds-cell-wrap slds-text-align_center" >Current Version</div>
                                                    <aura:set attribute="else">
                                                        <div class="slds-cell-wrap slds-text-align_center" > {!item.Name}</div>
                                                    </aura:set>
                                                </aura:if>
                                                
                                            </td>
                                            <td scope="row">
                                                <div class="slds-cell-wrap slds-text-align_right"><lightning:formattedNumber value="{!( item.Name== v.latestVersion ?  v.singleRec.Phoenix_Final_Direct_Selling_Units_Calc__c  : item.Phoenix_Final_DRL_Units__c)}"  /></div>
                                            </td>   
                                            <td scope="row">
                                                <div class="slds-cell-wrap slds-text-align_right"><lightning:formattedNumber value="{!( item.Name== v.latestVersion ?  v.singleRec.Phoenix_Current_Direct_Price__c : item.Phoenix_Current_Sell_Price__c)}"  style="currency" currencyCode="USD"/></div>
                                            </td>
                                            <td scope="row">
                                                <div class="slds-cell-wrap slds-text-align_right"><lightning:formattedNumber value="{!( item.Name== v.latestVersion ? v.singleRec.Phoenix_ProposedContractBidPriceMktng__c : item.Phoenix_Marketing_Price__c)}"  style="currency" currencyCode="USD"/></div>
                                            </td>
                                            <td scope="row">
                                                <div class="slds-cell-wrap slds-text-align_right"><lightning:formattedNumber value="{!item.DiffInSellPrice}" style="currency" currencyCode="USD" maximumFractionDigits="2"/></div>
                                            </td>
                                            <td scope="row">
                                                <div class="slds-cell-wrap slds-text-align_right"><lightning:formattedNumber value="{!item.changePercent}" style="percent-fixed"/></div>
                                            </td>
                                            <td scope="row">
                                                <div class="slds-cell-wrap slds-text-align_right"><lightning:formattedNumber value="{!( item.Name== v.latestVersion ? v.singleRec.Proposed_TPT_Per_Direct__c : item.Phoenix_TPT_per_pack__c)}"  style="percent-fixed" 
                                                                                                                             maximumFractionDigits="2"/></div>
                                            </td>
                                            <td scope="row">
                                                <div class="slds-cell-wrap slds-text-align_center" > {!item.Phoenix_Customer_Comments__c}</div>
                                            </td>
                                            <td scope="row">
                                                <div class="slds-cell-wrap slds-text-align_right"><lightning:formattedDateTime aura:id="dt"
                                                                                                                               value="{!item.Created_Date__c}"
                                                                                                                               month="short"
                                                                                                                               day="numeric"
                                                                                                                               year="numeric"
                                                                                                                               hour="2-digit"
                                                                                                                               minute="2-digit"
                                                                                                                               hour12="true"
                                                                                                                               timeZone="{!$Locale.timezone}"/></div>
                                            </td>  
                                            
                                            <td scope="row">
                                                <div class="slds-cell-wrap slds-text-align_center">
                                                    <a href="none" target="_blank">{!item.Owner.Name} </a>
                                                </div>
                                            </td>  
                                        </tr>
                                        <aura:if isTrue="{!item.expanded}" >
                                            <tr>
                                                <td colspan="11">
                                                    <section style="border-style: none;  border-width: thin;">
                                                        <!--  <div class="fantasy-tab-switcher row">
                                                    <lightning:button aura:id="currentData" label="{!item.Name}" name="{!itemIndex}" class="fantasy-tab-button previous toggle-button-active"  onclick="{!c.currentVersion}" />
                                                        
                                                    <lightning:button aura:id="previousData" label="Current Version" name="{!itemIndex}" class="fantasy-tab-button current"  onclick="{!c.previousVersion}" />
                                                        
                                                </div>-->
                                                        <div class="row">
                                                            <div class="column">
                                                                <h2><b>Current 52wk</b></h2>
                                                                <p><lightning:formattedNumber value="{!( item.Name== v.latestVersion ? v.singleRec.Phoenix_Current_Retail_Direct_Units__c : item.Phoenix_Current_52wk__c)}"  maximumFractionDigits="0"/></p>
                                                                <hr class="hrline"/>
                                                                <h2><b>Current Monthly</b></h2>
                                                                <aura:if isTrue="{!not(empty(item.Name))}">
                                                                    <p><lightning:formattedNumber value="{!( item.Name== v.latestVersion ? v.singleRec.Phoenix_12_Months_TotalSaleUnits__c : item.Phoenix_Current_Monthly__c)}"  maximumFractionDigits="0"/></p>
                                                                    <aura:set attribute="else">
                                                                        &nbsp;
                                                                    </aura:set>
                                                                </aura:if>
                                                                <hr class="hrline"/>
                                                                <h2><b>Current ASP</b></h2>
                                                                <aura:if isTrue="{!not(empty(v.singleRec.Phoenix_Current_ASP_Dose__c))}">
                                                                    <p><lightning:formattedNumber value="{!v.singleRec.Phoenix_Current_ASP_Dose__c}"   style="currency"
                                                                                                  currencyCode="USD" maximumFractionDigits="2"/></p>
                                                                    <aura:set attribute="else">
                                                                        &nbsp;
                                                                    </aura:set>
                                                                </aura:if>
                                                                <hr class="hrline"/>
                                                                
                                                                
                                                            </div>
                                                            <div class="column">
                                                                <h2><b>Total Units</b></h2>
                                                                <aura:if isTrue="{!not(empty(v.singleRec.Phoenix_Proposed_Direct_Selling_Unit__c ))}">
                                                                    <p><lightning:formattedNumber value="{!( item.Name== v.latestVersion ? v.singleRec.Phoenix_Proposed_Direct_Selling_Unit__c : item.Pheonix_DRL_Units__c)}"  maximumFractionDigits="0"/></p>
                                                                    <aura:set attribute="else">
                                                                        &nbsp;
                                                                    </aura:set>
                                                                </aura:if>
                                                                <hr class="hrline"/>
                                                                <h2><b>Proposed Share %</b></h2>
                                                                <aura:if isTrue="{!not(empty(v.singleRec.Phoenix_Date_Fee__c ))}">
                                                                    <p>    <lightning:formattedNumber value="{!( item.Name== v.latestVersion ? v.singleRec.Phoenix_Date_Fee__c : item.Phoenix_Proposed_Share__c)}"
                                                                                                      style="percent-fixed" maximumFractionDigits="2" /></p>
                                                                    <aura:set attribute="else">
                                                                        &nbsp;
                                                                    </aura:set>
                                                                </aura:if>
                                                                <hr class="hrline"/>
                                                                <h2><b>Proposed 52wk </b></h2>
                                                                <aura:if isTrue="{!not(empty(v.singleRec.Phoenix_Proposed_Anda_Units__c ))}">
                                                                    <p><lightning:formattedNumber value="{!( item.Name== v.latestVersion ? v.singleRec.Phoenix_Proposed_Anda_Units__c : item.Phoenix_Proposed_52wk__c)}"  maximumFractionDigits="0"/></p>
                                                                    <aura:set attribute="else">
                                                                        &nbsp;
                                                                    </aura:set>
                                                                </aura:if>
                                                                <hr class="hrline"/>
                                                                
                                                                
                                                            </div>
                                                            <div class="column">
                                                                <h2><b>TPT $ per pack</b></h2>
                                                                <aura:if isTrue="{!not(empty(v.singleRec.Proposed_TPT_Direct__c ))}">
                                                                    <p><lightning:formattedNumber value="{!( item.Name== v.latestVersion ? v.singleRec.Proposed_TPT_Direct__c : item.Phoenix_TPT_Dollor_per_pack__c)}"   style="currency" currencyCode="USD"
                                                                                                  maximumFractionDigits="2"/></p>
                                                                    <aura:set attribute="else">
                                                                        &nbsp;
                                                                    </aura:set>
                                                                    
                                                                </aura:if>
                                                                <hr class="hrline"/>
                                                                <h2><b>Profit</b></h2>
                                                                <aura:if isTrue="{!not(empty(v.singleRec.Proposed_TPT_Per_Direct__c ))}">
                                                                    <p><lightning:formattedNumber value="{!( item.Name== v.latestVersion ? v.singleRec.Phoenix_Current_Net_Indirect_Price__c : item.Phoenix_Profit__c)}"  style="currency" 
                                                                                                  currencyCode="USD" minimumFractionDigits="0" maximumFractionDigits="0"/></p>
                                                                    <aura:set attribute="else">
                                                                        &nbsp;
                                                                    </aura:set>
                                                                    
                                                                </aura:if>
                                                                <hr class="hrline"/>
                                                                <h2><b>Total TPT $</b></h2>
                                                                <aura:if isTrue="{!not(empty(v.singleRec.Phoenix_Th_Put_Margin__c ))}">
                                                                    <p><lightning:formattedNumber value="{!( item.Name== v.latestVersion ? v.singleRec.Phoenix_Th_Put_Margin__c : item.Phoenix_Total_TPT__c)}"   style="currency"
                                                                                                  currencyCode="USD" minimumFractionDigits="0" maximumFractionDigits="0"/></p>
                                                                    <aura:set attribute="else">
                                                                        &nbsp;
                                                                    </aura:set>
                                                                </aura:if>
                                                                <hr class="hrline"/>
                                                                
                                                            </div>
                                                            <div class="column">
                                                                <h2><b>Net Sales</b></h2>
                                                                <aura:if isTrue="{!not(empty(v.singleRec.Phoenix_Net_Sales_Internal__c ))}">
                                                                    <p><lightning:formattedNumber value="{!( item.Name== v.latestVersion ? v.singleRec.Phoenix_Net_Sales_Internal__c : item.Phoenix_Net_Sales__c)}"   style="currency"
                                                                                                  currencyCode="USD" minimumFractionDigits="0" maximumFractionDigits="0"/></p>
                                                                    <aura:set attribute="else">
                                                                        &nbsp;
                                                                    </aura:set>
                                                                </aura:if>
                                                                <hr class="hrline"/>
                                                                <h2><b>Gross Sales</b></h2>
                                                                <aura:if isTrue="{!not(empty(v.singleRec.Phoenix_Net_Sales_External__c ))}">
                                                                    <p><lightning:formattedNumber value="{!( item.Name== v.latestVersion ? v.singleRec.Phoenix_Net_Sales_External__c : item.Phoenix_Gross_Sales__c)}"   style="currency"
                                                                                                  currencyCode="USD" minimumFractionDigits="0" maximumFractionDigits="0"/></p>
                                                                    <aura:set attribute="else">
                                                                        &nbsp;
                                                                    </aura:set>
                                                                </aura:if>
                                                                <hr class="hrline"/>
                                                                <h2><b>Supply Type</b></h2>
                                                                <aura:if isTrue="{!not(empty(item.Name))}">
                                                                    <p>{!( item.Name== v.latestVersion ? v.singleRec.Phoenix_Supply_Type__c : item.Phoenix_Supply_Type__c)}</p>
                                                                    <aura:set attribute="else">
                                                                        &nbsp;
                                                                    </aura:set>
                                                                </aura:if>
                                                                <hr class="hrline"/>
                                                            </div>
                                                            
                                                        </div>
                                                    </section>
                                                </td>
                                            </tr>
                                        </aura:if>
                                    </aura:iteration>
                                </table>
                            </div>
                            <aura:set attribute="else">
                                <p style="text-align:center">No previous prices found.</p>
                            </aura:set>
                        </aura:if>
                    </aura:if>
                </div>
                <!--/div-->
                <!--Modal/Popup Box Footer Starts here-->
                <footer class="slds-modal__footer">
                    <lightning:button variant="neutral" label="Close" title="Close" onclick="{! c.closeHistPopup }" />
                    
                </footer>
            </div>
            
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
        
    </aura:if>
    <aura:if isTrue="{!v.showTotals}">
        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
                 aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
            
            <div class="slds-modal__container" style="width:90% ! important;">
                
                <!-- Modal/Popup Box Header Starts here-->
                <header class="slds-modal__header">
                    <lightning:buttonIcon iconName="utility:close" onclick="{!c.closeTotalPopup}" alternativeText="close"
                                          variant="bare-inverse" class="slds-modal__close" />
                    <h2 class="slds-text-heading_medium slds-hyphenate mainTotalHeader"><b>Summary of Bid</b></h2>
                </header>
                <!--Modal/Popup Box Body Starts here-->
                <!--div class="slds-scrollable" style="height: 100rem; width: 46rem"-->
                <div class="slds-modal__content slds-p-around_medium">
                    <aura:if isTrue="{!v.showTotals}">
                        <table class="totalsTable">
                            <tr style="background: #0000000A;">
                                <td colspan="1">
                                    <section style="border-style: none;  border-width: thin;">
                                        <div class="row">
                                            <div class="column">
                                                <h2><b>Current Net Sales</b></h2>
                                                <p class="numberStle"><lightning:formattedNumber value="{!(v.currentSalesFinance != null ? v.currentSalesFinance:0)}"  style="currency" currencyCode="USD" minimumFractionDigits="0" maximumFractionDigits="0"/></p>
                                                <hr class="hrline"/>
                                                <h2><b>Proposed Net Sales</b></h2>
                                                <p class="numberStle"><lightning:formattedNumber value="{!(v.netSalesIntTotal != null ? v.netSalesIntTotal:0)}" style="currency" currencyCode="USD" maximumFractionDigits="0" minimumFractionDigits="0"/></p>
                                                <hr class="hrline"/>
                                                
                                            </div>
                                            <div class="column">
                                                <h2><b>Current Profit</b></h2>
                                                <aura:if isTrue="true">
                                                    <p class="numberStle"><lightning:formattedNumber value="{!(v.currentTPMargin != null ? v.currentTPMargin:0)}" style="currency" currencyCode="USD" maximumFractionDigits="0" minimumFractionDigits="0"/></p>
                                                    <aura:set attribute="else">
                                                        &nbsp;
                                                    </aura:set>
                                                </aura:if>
                                                <hr class="hrline"/>
                                                
                                                <h2><b>Proposed Profit</b></h2>
                                                <aura:if isTrue="true">
                                                    <p class="numberStle"><lightning:formattedNumber value="{!(v.ThptMrgnDTotal != null ? v.ThptMrgnDTotal:0)}"  style="currency" currencyCode="USD" maximumFractionDigits="0" minimumFractionDigits="0"/></p>
                                                    <aura:set attribute="else">
                                                        &nbsp;
                                                    </aura:set>
                                                </aura:if>
                                                <hr class="hrline"/>
                                                
                                            </div>
                                            <div class="column">
                                                <h2><b>Current TP%</b></h2>
                                                <aura:if isTrue="true">
                                                    <p class="numberStle"><lightning:formattedNumber value="{!(and(v.currentTPMargin != null,and(v.currentSalesFinance !=0 ,v.currentSalesFinance!=null)) ? (v.currentTPMargin/v.currentSalesFinance):0)}"   style="percent"
                                                                                                     maximumFractionDigits="2"/></p>
                                                    <aura:set attribute="else">
                                                        &nbsp;
                                                    </aura:set>
                                                </aura:if>
                                                <hr class="hrline"/>
                                                <h2><b>Proposed TP%</b></h2>
                                                <aura:if isTrue="true">
                                                    <p class="numberStle"><lightning:formattedNumber value="{!(and(v.ThptMrgnDTotal != null,and(v.netSalesIntTotal !=0 ,v.netSalesIntTotal!=null)) ? (v.ThptMrgnDTotal/v.netSalesIntTotal):0)}"   style="percent"
                                                                                                     maximumFractionDigits="2"/></p>
                                                    <aura:set attribute="else">
                                                        &nbsp;
                                                    </aura:set>
                                                </aura:if>
                                                <hr class="hrline"/>
                                                
                                            </div>
                                        </div>
                                    </section>
                                </td>
                            </tr>
                        </table>
                    </aura:if>
                </div>
                <!--/div-->
                <!--Modal/Popup Box Footer Starts here-->
                <footer class="slds-modal__footer">
                    <lightning:button variant="neutral" label="Close" title="Close" onclick="{! c.closeTotalPopup }" />
                    
                </footer>
            </div>
            
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
        
    </aura:if>
    <aura:if isTrue="{!v.isSpinner}">
        <div class="">
            <lightning:spinner alternativeText="Loading" variant="brand" />
        </div>
    </aura:if>
    
    
    
    <tr>
        <aura:if isTrue="{!v.BidAprrovalStatus=='Draft'}">
            <th scope="row" class="{! v.showErrorClass == true ? 'slds-cell-edit slds-has-error' : 'slds-cell-edit'}">
                <aura:if isTrue="{!v.BidAprrovalStatus=='Draft'}">
                    <a name="{!v.lineItemId}" onclick="{!c.deleteLineItem}">
                        <lightning:icon iconName="utility:delete" alternativeText="delete" size="x-small" />
                    </a>
                </aura:if>
            </th>
            <aura:set attribute="else">
                <th scope="row" class="{! v.showErrorClass == true ? 'slds-cell-edit slds-has-error' : 'slds-cell-edit'}">
                </th>
            </aura:set>
        </aura:if>
        <th scope="row" class="{! v.showErrorClass == true ? 'slds-cell-edit slds-has-error' : 'slds-cell-edit'}">
            <span class="slds-grid slds-grid_align-spread">
                <span class="" title="NDC">{!v.singleRec.Phoenix_NDC__c}</span>
            </span>
        </th>
        <th scope="row">{!v.singleRec.Phoenix_Product_Code1__c}</th>
        <th scope="row">
            <!--Added by Naseer to replace Product Family with Lookup-->
            <lightning:formattedUrl value="{!'/' + v.singleRec.Product_Family__c}"
                                    label="{!v.singleRec.Product_Family_Name__c}" target="_self" />
            <!--End-->
            <!--{!v.singleRec.Phoenix_Product_Family__c}-->
        </th>
        <th scope="row" class="slds-text-align_right">{!v.singleRec.Phoenix_Pkg_Size__c}</th>
        <th scope="row">
            <span class="slds-grid slds-grid_align-spread">
                <span class="" title="Product">
                    <lightning:formattedUrl value="{!'/' + v.singleRec.Phoenix_Product__r.Id}"
                                            label="{!v.singleRec.Phoenix_Product__r.Name}" target="_self" />
                </span>
            </span>
        </th>
        <!-- logic for Re-Bid functionality- starts-->
        <aura:if isTrue="{!v.isReBid}">
            <td class="slds-text-align_right"> <a href="{!'/'+v.singleRec.Phoenix_Previous_Bid__c}"
                                                  target="_blank">{!v.singleRec.Phoenix_Previous_Bid__r.Name}</a></td>
            <td class="slds-text-align_right"> <a onclick="{!c.showSelectedproducts}">{!v.singleRec.Phoenix_Previous_LineItem__r.Name}</a></td>
        </aura:if>
        <td class="slds-text-align_right">  <lightning:icon iconName="standard:channel_program_history" alternativeText="Price History" title="Price History"  size="medium" onclick="{!c.showHistoryMethod}"/></td>
        <!-- logic for Re-Bid functionality- ends-->
        
        <!--<td>{!v.singleRec.Phoenix_IMS_Market_Share__c}</td>-->
        <td class="slds-text-align_right">{!v.singleRec.Phoenix_Current_Supplier__c}</td>
        <td class="slds-text-align_right">{!v.singleRec.Phoenix_Case_Pack__c}</td>
        <td class="slds-text-align_right">
            <lightning:formattedNumber value="{!v.singleRec.Phoenix_MOQ1__c}" maximumFractionDigits="2" />
        </td>
        <td>{!v.singleRec.Phoenix_Compare_To_Brand_Name1__c}</td>
        <td>{!v.singleRec.Phoenix_Product_Director__c}</td>
        <aura:if isTrue="{!or(v.BidAprrovalStatus=='Draft', and(or(v.BidAprrovalStatus=='SCM &amp; Marketing',v.BidAprrovalStatus=='Marketing'),and(or(v.isdeligationApprover,v.isMarketingApprovePerson==v.singleRec.Phoenix_Product_Director__c), v.singleRec.Phoenix_Marketing_Final_Approval__c!=true)))}">
            <td ondblclick="{!c.inlineEditTPT}">
                <span class="slds-grid slds-grid_align-spread">
                    <aura:if isTrue="{!v.TPTEditMode == false}">
                        <span><lightning:formattedNumber value="{!v.singleRec.Phoenix_Throughput_Cost1__c}" style="currency" currencyCode="USD" maximumFractionDigits="2"/>
                        </span>
                        <button onclick="{!c.inlineEditTPT}"
                                class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small"
                                tabindex="0">
                            <lightning:icon iconName="utility:edit" size="xx-small" />
                        </button>
                        <aura:set attribute="else">
                            <section tabindex="0" class="slds-popover slds-popover_edit" role="dialog"
                                     style="position: absolute; top: 0px;width:max-content;">
                                <div class="slds-popover__body">
                                    <div class="slds-form-element slds-grid slds-wrap">
                                        <div class="slds-form-element__control slds-grow">
                                            <ui:inputNumber class="slds-input inputWidth"
                                                            labelClass="slds-form-element__label slds-form-element__label_edit slds-no-flex"
                                                            aura:id="inputTPT" blur="{!c.closeTPTBox}"
                                                            change="{!c.onCISUChange}"
                                                            value="{!v.singleRec.Phoenix_Throughput_Cost1__c}" />
                                        </div>
                                    </div>
                                </div>
                                <span id="form-end" tabindex="0"></span>
                            </section>
                        </aura:set>
                    </aura:if>
                </span>
            </td> 
            <aura:set attribute="else">
                <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.singleRec.Phoenix_Throughput_Cost1__c}"  style="currency" currencyCode="USD" maximumFractionDigits="2"/></td>
            </aura:set>
        </aura:if>
        <aura:if  isTrue="{!and(v.bidType !='OTC OTB Good Dated',and(v.bidType !='OTC OTB Short Dated',v.bidType !='OTC New Product'))}">
            <td>	
                <div class="slds-grid" style="width:200px">	
                    <div class="slds-grid slds-has-flexi-truncate">	
                        <p class="slds-truncate" title="{!v.singleRec.Phoenix_Current_Position__c}">{!v.singleRec.Phoenix_Current_Position__c}</p>
                    </div>	
                </div>
            </td>
        </aura:if>
        <!--  <aura:if isTrue="{!or(v.loggedInUserName==v.singleRec.Phoenix_Product_Director__c,or(v.deligatedUserName==v.singleRec.Phoenix_Product_Director__c,or(v.BidAprrovalStatus=='Draft',or(v.isMarketingApprovePerson==v.singleRec.Phoenix_Product_Director__c,or(v.isdeligationApprover,and(v.BidAprrovalStatus=='Customer\'s Update',and(v.isCustomersApprovePerson,v.singleRec.Phoenix_Customer_Final_Approval__c !=true)))))))}">
            <td class="" ondblclick="{!c.inlineEditPositions}">
                <span class="slds-grid slds-grid_align-spread">
                    <aura:if isTrue="{!v.PositionsEditMode == false}">
                        <span>
                            <div class="slds-grid" style="width:200px">
                                <div class="slds-grid slds-has-flexi-truncate">
                                    <p class="slds-truncate" title="{!v.singleRec.Phoenix_Proposed_Position__c}">
                                        {!v.singleRec.Phoenix_Proposed_Position__c}
                                    </p> -->
        <!-- <div aura:id="lookup-pill" class="slds-pill-container">
                                <aura:iteration items="{!v.LineselectedPosistions}" var="sr">
                                    <lightning:pill class="slds-m-around_xx-small" label="{!sr}" name="{!sr}" onremove="{! c.clear }">                                        
                                    </lightning:pill>
                                </aura:iteration>
                                </div>-->
        <!--   </div>
                            </div>
                        </span>
                        <button onclick="{!c.inlineEditPositions}"
                                class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small"
                                tabindex="0">
                            <lightning:icon iconName="utility:edit" size="xx-small" />
                        </button>
                    </aura:if>
                </span>-->
        
        <!--<div class="slds-grid" style="width:200px">	
                    <div class="slds-grid slds-has-flexi-truncate">	
                        <p class="slds-truncate">{!v.singleRec.Phoenix_Proposed_Position__c}</p>	
                    </div>	
                </div>-->
        <!--  </td>
            <aura:set attribute="else">-->
        <td><lightning:formattedNumber value="{!v.singleRec.Phoenix_Proposed_Position__c}"
                                       style="percent-fixed" maximumFractionDigits="2" /></td>
        <!-- </aura:set>
        </aura:if>-->
        <aura:if  isTrue="{!and(v.bidType !='OTC OTB Good Dated',and(v.bidType !='OTC OTB Short Dated',v.bidType !='OTC New Product'))}">
            <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.singleRec.Phoenix_12_Months_Actual_Sales__c}"  maximumFractionDigits="0"/>
            </td>
            <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.singleRec.Phoenix_Current_Direct_Selling_Unit__c}"  maximumFractionDigits="0"/>
            </td>
            <aura:if isTrue="{!or(v.BidAprrovalStatus=='Draft', and(or(v.BidAprrovalStatus=='SCM &amp; Marketing',v.BidAprrovalStatus=='Marketing'),and(or(v.isdeligationApprover,v.isMarketingApprovePerson==v.singleRec.Phoenix_Product_Director__c), v.singleRec.Phoenix_Marketing_Final_Approval__c!=true)))}">
                <td ondblclick="{!c.inlineEditPORDSUnit}">
                    <span class="slds-grid slds-grid_align-spread">
                        <!-- show input and output section based on boolean flag -->
                        <aura:if isTrue="{!v.PORDSUEditMode == false}">
                            <span><lightning:formattedNumber value="{!v.singleRec.Phoenix_Override_Current_Direct_Units__c}"  maximumFractionDigits="0"/>
                            </span>
                            <button onclick="{!c.inlineEditPORDSUnit}"
                                    class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small"
                                    tabindex="0">
                                <lightning:icon iconName="utility:edit" size="xx-small" />
                            </button>
                            <!-- Inline Edit Section in else case-->
                            <aura:set attribute="else">
                                <section tabindex="0" class="slds-popover slds-popover_edit" role="dialog"
                                         style="position: absolute; top: 0px;width:max-content;">
                                    <div class="slds-popover__body">
                                        <div class="slds-form-element slds-grid slds-wrap">
                                            <div class="slds-form-element__control slds-grow">
                                                <ui:inputNumber class="slds-input inputWidth"
                                                                labelClass="slds-form-element__label slds-form-element__label_edit slds-no-flex"
                                                                aura:id="inputPORDSUId" blur="{!c.closePORDSUBox}"
                                                                change="{!c.onCISUChange}"
                                                                value="{!v.singleRec.Phoenix_Override_Current_Direct_Units__c}" />
                                            </div>
                                        </div>
                                    </div>
                                    <span id="form-end" tabindex="0"></span>
                                </section>
                            </aura:set>
                        </aura:if>
                    </span>
                </td>
                <aura:set attribute="else">
                    <td class="slds-text-align_right">
                        <lightning:formattedNumber value="{!v.singleRec.Phoenix_Override_Current_Direct_Units__c}"  maximumFractionDigits="0"/>
                    </td>
                </aura:set>
            </aura:if>
            <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.singleRec.Phoenix_Current_Retail_Direct_Units__c}"  maximumFractionDigits="0"/>
            </td>
            <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.singleRec.Phoenix_12_Months_TotalSaleUnits__c}"  maximumFractionDigits="0"/>
            </td>
        </aura:if>
        <aura:if isTrue="{!and(v.bidType!='OTC Price Change',v.bidType!='OTC Rebate Change')}">
            <aura:if isTrue="{!or(v.BidAprrovalStatus=='Draft', and(or(v.BidAprrovalStatus=='SCM &amp; Marketing',v.BidAprrovalStatus=='Marketing'),and(or(v.isdeligationApprover,v.isMarketingApprovePerson==v.singleRec.Phoenix_Product_Director__c), v.singleRec.Phoenix_Marketing_Final_Approval__c!=true)))}">
                <td ondblclick="{!c.inlineEditPDSUnit}">
                    <span class="slds-grid slds-grid_align-spread">
                        <!-- show input and output section based on boolean flag -->
                        <aura:if isTrue="{!v.PDSUEditMode == false}">
                            <span><lightning:formattedNumber value="{!v.singleRec.Phoenix_12_Months_IndirectSaleUnit__c}"  maximumFractionDigits="0"/>
                            </span>
                            <button onclick="{!c.inlineEditPDSUnit}"
                                    class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small"
                                    tabindex="0">
                                <lightning:icon iconName="utility:edit" size="xx-small" />
                            </button>
                            <!-- Inline Edit Section in else case-->
                            <aura:set attribute="else">
                                <section tabindex="0" class="slds-popover slds-popover_edit" role="dialog"
                                         style="position: absolute; top: 0px;width:max-content;">
                                    <div class="slds-popover__body">
                                        <div class="slds-form-element slds-grid slds-wrap">
                                            <div class="slds-form-element__control slds-grow">
                                                <ui:inputNumber class="slds-input inputWidth"
                                                                labelClass="slds-form-element__label slds-form-element__label_edit slds-no-flex"
                                                                aura:id="inputPDSUId" blur="{!c.closePDSUBox}"
                                                                change="{!c.onCISUChange}"
                                                                value="{!v.singleRec.Phoenix_12_Months_IndirectSaleUnit__c}" />
                                            </div>
                                        </div>
                                    </div>
                                    <span id="form-end" tabindex="0"></span>
                                </section>
                            </aura:set>
                        </aura:if>
                    </span>
                </td>
                <aura:set attribute="else">
                    <td class="slds-text-align_right">
                        <lightning:formattedNumber value="{!v.singleRec.Phoenix_12_Months_IndirectSaleUnit__c}"  maximumFractionDigits="0"/>
                    </td>
                </aura:set>
            </aura:if>
            <!-- proposed share % as Phoenix_Date_Fee__c-->
            <aura:if isTrue="{!or(v.BidAprrovalStatus=='Draft', and(or(v.BidAprrovalStatus=='SCM &amp; Marketing',v.BidAprrovalStatus=='Marketing'),and(or(v.isdeligationApprover,v.isMarketingApprovePerson==v.singleRec.Phoenix_Product_Director__c), v.singleRec.Phoenix_Marketing_Final_Approval__c!=true)))}">
                <td ondblclick="{!c.inlineEditProposedShare}">
                    <span class="slds-grid slds-grid_align-spread">
                        <aura:if isTrue="{!v.PSEditMode == false}">
                            <span class="">
                                <lightning:formattedNumber value="{!v.singleRec.Phoenix_Date_Fee__c}"
                                                           style="percent-fixed" maximumFractionDigits="2" />
                            </span>
                            <button onclick="{!c.inlineEditProposedShare}"
                                    class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small"
                                    tabindex="0">
                                <lightning:icon iconName="utility:edit" size="xx-small" />
                            </button>
                            <aura:set attribute="else">
                                <lightning:select aura:id="inputPSId" name="select" onchange="{! c.onChange }" onblur="{!c.closePSBox}">
                                    <aura:if isTrue="{!(v.singleRec.Phoenix_Date_Fee__c != null)}"> 
                                        <option value="{!v.singleRec.Phoenix_Date_Fee__c}">
                                            {!v.singleRec.Phoenix_Date_Fee__c}%</option>
                                    </aura:if>
                                    <aura:if isTrue="{!(v.singleRec.Phoenix_Date_Fee__c != '5')}">  <option value="5">5%</option></aura:if>
                                    <aura:if isTrue="{!(v.singleRec.Phoenix_Date_Fee__c != '10')}"> <option value="10">10%</option></aura:if>
                                    <aura:if isTrue="{!(v.singleRec.Phoenix_Date_Fee__c != '15')}"> <option value="15">15%</option></aura:if>
                                    <aura:if isTrue="{!(v.singleRec.Phoenix_Date_Fee__c != '20')}"> <option value="20">20%</option></aura:if>
                                    <aura:if isTrue="{!(v.singleRec.Phoenix_Date_Fee__c != '25')}"> <option value="25">25%</option></aura:if>
                                    <aura:if isTrue="{!(v.singleRec.Phoenix_Date_Fee__c != '30')}"> <option value="30">30%</option></aura:if>
                                    <aura:if isTrue="{!(v.singleRec.Phoenix_Date_Fee__c != '35')}"> <option value="35">35%</option></aura:if>
                                    <aura:if isTrue="{!(v.singleRec.Phoenix_Date_Fee__c != '40')}"> <option value="40">40%</option></aura:if>
                                    <aura:if isTrue="{!(v.singleRec.Phoenix_Date_Fee__c != '45')}"> <option value="45">45%</option></aura:if>
                                    <aura:if isTrue="{!(v.singleRec.Phoenix_Date_Fee__c != '50')}"> <option value="50">50%</option></aura:if>
                                    <aura:if isTrue="{!(v.singleRec.Phoenix_Date_Fee__c != '55')}"> <option value="55">55%</option></aura:if>
                                    <aura:if isTrue="{!(v.singleRec.Phoenix_Date_Fee__c != '60')}"> <option value="60">60%</option></aura:if>
                                    <aura:if isTrue="{!(v.singleRec.Phoenix_Date_Fee__c != '65')}"> <option value="65">65%</option></aura:if>
                                    <aura:if isTrue="{!(v.singleRec.Phoenix_Date_Fee__c != '70')}"> <option value="70">70%</option></aura:if>
                                    <aura:if isTrue="{!(v.singleRec.Phoenix_Date_Fee__c != '75')}"> <option value="75">75%</option></aura:if>
                                    <aura:if isTrue="{!(v.singleRec.Phoenix_Date_Fee__c != '80')}"> <option value="80">80%</option></aura:if>
                                    <aura:if isTrue="{!(v.singleRec.Phoenix_Date_Fee__c != '85')}"> <option value="85">85%</option></aura:if>
                                    <aura:if isTrue="{!(v.singleRec.Phoenix_Date_Fee__c != '90')}"> <option value="90">90%</option></aura:if>
                                    <aura:if isTrue="{!(v.singleRec.Phoenix_Date_Fee__c != '95')}"> <option value="95">95%</option></aura:if>
                                    <aura:if isTrue="{!(v.singleRec.Phoenix_Date_Fee__c != '100')}"> <option value="100">100%</option></aura:if>
                                </lightning:select>
                                
                            </aura:set>
                        </aura:if>
                    </span>
                </td>
                <aura:set attribute="else">
                    <td  class="slds-text-align_right">
                        <lightning:formattedNumber value="{!v.singleRec.Phoenix_Date_Fee__c}"
                                                   style="percent-fixed" maximumFractionDigits="2" />
                    </td>
                </aura:set>
            </aura:if>
            
            <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.singleRec.Phoenix_Proposed_Direct_Selling_Unit__c}"  maximumFractionDigits="0"/>
            </td> 
            <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.singleRec.Phoenix_Proposed_Anda_Units__c}"  maximumFractionDigits="0"/>
            </td> 
            <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.singleRec.Phoenix_Proposed_OS_Units__c}"  maximumFractionDigits="0"/>
            </td> 
            <aura:if  isTrue="{!and(v.bidType !='OTC OTB Good Dated',v.bidType !='OTC OTB Short Dated')}">
                <aura:if isTrue="{!v.singleRec.Phoenix_SCM_Final_Approval__c}">
                    <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.singleRec.Phoenix_Final_Direct_Selling_Units_Calc__c}"  maximumFractionDigits="0"/>
                    </td> 
                    <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.singleRec.Phoenix_Others_Direct__c}"  maximumFractionDigits="0"/>
                    </td> 
                    <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.singleRec.Phoenix_Others_Indirect__c}"  maximumFractionDigits="0"/>
                    </td> 
                    <aura:set attribute="else">
                        <td></td>
                        <td></td>
                        <td></td>
                    </aura:set>
                </aura:if>
            </aura:if>
            
        </aura:if>
        <aura:if  isTrue="{!and(v.bidType !='OTC OTB Good Dated',and(v.bidType !='OTC OTB Short Dated',v.bidType !='OTC New Product'))}">
            <td class="slds-text-align_right">
                <lightning:formattedNumber value="{!v.singleRec.Phoenix_Current_Direct_Price__c}" style="currency"
                                           currencyCode="USD" maximumFractionDigits="2" />
            </td>
            
        </aura:if>
        <aura:if  isTrue="{!and(v.bidType !='OTC OTB Good Dated',and(v.bidType !='OTC OTB Short Dated',v.bidType !='OTC New Product'))}">
            <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.singleRec.Phoenix_DeadNet_TrckGR__c}" style="currency" currencyCode="USD" maximumFractionDigits="2" /></td>
            <td class="slds-text-align--right"><lightning:formattedNumber value="{!v.singleRec.Phoenix_Current_Sales_Finance__c}"  style="currency" minimumFractionDigits="0" maximumFractionDigits="0" currencyCode="USD"/> </td>
            <td class="slds-text-align--right"><lightning:formattedNumber value="{!v.singleRec.Phoenix_Current_TP_Margin__c}" minimumFractionDigits="0" maximumFractionDigits="0" style="currency" currencyCode="USD"/> </td>
            <td class="slds-text-align--right"><lightning:formattedNumber value="{!v.singleRec.Phoenix_Current_TP_MarginPercent__c}" maximumFractionDigits="2" style="percent-fixed"/> </td>
        </aura:if>
        <aura:if  isTrue="{!and(v.bidType !='OTC Volume Review',v.bidType !='OTC Rebate Change')}">
            <aura:if isTrue="{!and(v.BidAprrovalStatus=='Draft',v.loggedInUserName!=v.isMarketingApprovePerson)}">
                <td ondblclick="{!c.inlineEditGuidancePrice}">
                    <span class="slds-grid slds-grid_align-spread">
                        <!-- show input and output section based on boolean flag -->
                        <aura:if isTrue="{!v.GDPEditMode == false}">
                            <span class="">
                                <lightning:formattedNumber value="{!v.singleRec.Phoenix_Guidance_Price__c}" style="currency"
                                                           currencyCode="USD" /></span>
                            <button onclick="{!c.inlineEditGuidancePrice}"
                                    class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small"
                                    tabindex="0">
                                <lightning:icon iconName="utility:edit" size="xx-small" />
                            </button>
                            <!-- Inline Edit Section in else case-->
                            <aura:set attribute="else">
                                <section tabindex="0" class="slds-popover slds-popover_edit" role="dialog"
                                         style="position: absolute; top: 0px;width:max-content;">
                                    <div class="slds-popover__body">
                                        <div class="slds-form-element slds-grid slds-wrap">
                                            <div class="slds-form-element__control slds-grow">
                                                <ui:inputCurrency class="slds-input inputWidth guidancePrice"
                                                                  labelClass="slds-form-element__label slds-form-element__label_edit slds-no-flex"
                                                                  aura:id="inputGDPId" blur="{!c.closeGDPBox}" change="{!c.onCISUChange}"
                                                                  value="{!v.singleRec.Phoenix_Guidance_Price__c}" />
                                            </div>
                                        </div>
                                    </div>
                                    <span id="form-end" tabindex="0"></span>
                                </section>
                            </aura:set>
                        </aura:if>
                    </span>
                </td>
                <aura:set attribute="else">
                    <td class="slds-text-align_right">
                        <lightning:formattedNumber value="{!v.singleRec.Phoenix_Guidance_Price__c}" style="currency" currencyCode="USD" />
                    </td>
                </aura:set>
            </aura:if>
            <aura:if isTrue="{!and(v.BidAprrovalStatus=='Draft',v.loggedInUserName!=v.isMarketingApprovePerson)}">
                <td ondblclick="{!c.inlineEditPCBPS}">
                    <span class="slds-grid slds-grid_align-spread">
                        <!-- show input and output section based on boolean flag -->
                        <aura:if isTrue="{!v.PCBPSEditMode == false}">
                            
                            <span class="">
                                <div
                                     >
                                    <lightning:formattedNumber
                                                               
                                                               value="{!v.singleRec.Phoenix_ProposedContract_Bid_Price_Sales__c}"
                                                               style="currency" currencyCode="USD" />
                                </div>
                            </span>
                            
                            <button onclick="{!c.inlineEditPCBPS}"
                                    class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small"
                                    tabindex="0">
                                <lightning:icon iconName="utility:edit" size="xx-small" />
                            </button>
                            <!-- Inline Edit Section in else case-->
                            <aura:set attribute="else">
                                <section tabindex="0" class="slds-popover slds-popover_edit" role="dialog"
                                         style="position: absolute; top: 0px;width:max-content;">
                                    <div class="slds-popover__body">
                                        <div class="slds-form-element slds-grid slds-wrap">
                                            <div class="slds-form-element__control slds-grow">
                                                <ui:inputCurrency class="slds-input inputWidth"
                                                                  labelClass="slds-form-element__label slds-form-element__label_edit slds-no-flex"
                                                                  aura:id="inputPCBPSId" blur="{!c.closePCBPSBox}"
                                                                  change="{!c.onCISUChange}"
                                                                  value="{!v.singleRec.Phoenix_ProposedContract_Bid_Price_Sales__c}" />
                                            </div>
                                        </div>
                                    </div>
                                    <span id="form-end" tabindex="0"></span>
                                </section>
                            </aura:set>
                        </aura:if>
                    </span>
                </td>
                <aura:set attribute="else">
                    <td class="slds-text-align_right">
                        <div
                             >
                            <lightning:formattedNumber
                                                       
                                                       value="{!v.singleRec.Phoenix_ProposedContract_Bid_Price_Sales__c}" style="currency"
                                                       currencyCode="USD" maximumFractionDigits="2" />
                        </div>
                    </td>
                </aura:set>
            </aura:if>
        </aura:if>
        <aura:if  isTrue="{!v.bidType !='OTC Rebate Change'}">
            <aura:if isTrue="{!or(v.BidAprrovalStatus=='Draft', and(or(v.BidAprrovalStatus=='SCM &amp; Marketing',v.BidAprrovalStatus=='Marketing'),and(or(v.isdeligationApprover,v.isMarketingApprovePerson==v.singleRec.Phoenix_Product_Director__c), v.singleRec.Phoenix_Marketing_Final_Approval__c!=true)))}">
                <td ondblclick="{!c.inlineEditSupplyType}">
                    <span class="slds-grid slds-grid_align-spread">
                        <aura:if isTrue="{!v.SupplyTypeEditMode == false}">
                            <span class="">{!v.singleRec.Phoenix_Supply_Type__c}</span>
                            <button onclick="{!c.inlineEditSupplyType}"
                                    class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small"
                                    tabindex="0">
                                <lightning:icon iconName="utility:edit" size="xx-small" />
                            </button>
                            <aura:set attribute="else">
                                <section tabindex="0" class="slds-popover slds-popover_edit" role="dialog"
                                         style="position: absolute; top: 0px;width:max-content;">
                                    <div class="slds-popover__body">
                                        <div class="slds-form-element slds-grid slds-wrap">
                                            <div class="slds-form-element__control slds-grow">
                                                <lightning:select name="supplyType" aura:id="inputSupplyType"
                                                                  onblur="{!c.closeSupplyType}" onchange="{!c.onCISUChange}">
                                                    <option value="{!v.singleRec.Phoenix_Supply_Type__c}">
                                                        {!v.singleRec.Phoenix_Supply_Type__c}</option>
                                                    <aura:if
                                                             isTrue="{!(v.singleRec.Phoenix_Supply_Type__c != '--None--')}">
                                                        <option value="">--None--</option>
                                                    </aura:if>
                                                    <aura:if
                                                             isTrue="{!(v.singleRec.Phoenix_Supply_Type__c != 'Pipe Fill')}">
                                                        <option value="Pipe Fill">Pipe Fill</option>
                                                    </aura:if>
                                                    <aura:if
                                                             isTrue="{!(v.singleRec.Phoenix_Supply_Type__c != 'Flow Behind')}">
                                                        <option value="Flow Behind">Flow Behind</option>
                                                    </aura:if>
                                                    
                                                </lightning:select>
                                            </div>
                                        </div>
                                    </div>
                                    <span id="form-end" tabindex="0"></span>
                                </section>
                            </aura:set>
                        </aura:if>
                    </span>
                </td>
                <aura:set attribute="else">
                    <td>
                        {!v.singleRec.Phoenix_Supply_Type__c} 
                    </td>
                    
                </aura:set>
            </aura:if>  
        </aura:if>
        <aura:if  isTrue="{!v.bidType !='OTC Rebate Change'}">  
            <aura:if  isTrue="{!v.bidType !='OTC Volume Review'}">
                <aura:if isTrue="{!and(or(v.BidAprrovalStatus=='SCM &amp; Marketing',or(v.BidAprrovalStatus=='Marketing',v.BidAprrovalStatus=='Draft')),and(or(v.isdeligationApprover,v.isMarketingApprovePerson==v.singleRec.Phoenix_Product_Director__c),and(or(v.isdeligationApprover,v.loggedInUserName==v.singleRec.Phoenix_Product_Director__c),v.singleRec.Phoenix_Marketing_Final_Approval__c!=true)))}">
                    <aura:if  isTrue="{!and(v.bidType !='OTC OTB Good Dated',and(v.bidType !='OTC OTB Short Dated',v.bidType !='OTC New Product'))}">
                        <td class="slds-text-align_right">
                            <lightning:formattedNumber value="{!v.singleRec.Phoenix_Reduc_in_NCP_McK_And_RAD__c}" style="percent-fixed"  maximumFractionDigits="2"  />
                        </td>
                    </aura:if>
                    <td ondblclick="{!c.inlineEditPCBP}">
                        <span class="slds-grid slds-grid_align-spread">
                            <!-- show input and output section based on boolean flag -->
                            <aura:if isTrue="{!v.PCBPEditMode == false}">
                                <span class="slds-grid slds-grid_align-spread">
                                    <a name="{!v.lineItemId}" onclick="{!c.openGoalseek}" title="Goal Seek">
                                        <lightning:icon iconName="utility:campaign" alternativeText="delete" size="x-small" />
                                    </a>
                                    <div
                                         style="{!lessthan(v.Deadnet,v.singleRec.Phoenix_Lowest_Price_SKU__c)?'color:red':''}">
                                        <lightning:formattedNumber
                                                                   title="{!lessthan(v.Deadnet,v.singleRec.Phoenix_Lowest_Price_SKU__c)?'Net Price is less than Lowest Price/SKU or Approved Lowest Price/SKU':''}"
                                                                   value="{!v.singleRec.Phoenix_ProposedContractBidPriceMktng__c}"
                                                                   style="currency" currencyCode="USD" />
                                    </div>
                                </span>
                                
                                <button onclick="{!c.inlineEditPCBP}"
                                        class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small"
                                        tabindex="0">
                                    <lightning:icon iconName="utility:edit" size="xx-small" />
                                </button>
                                <!-- Inline Edit Section in else case-->
                                <aura:set attribute="else">
                                    <section tabindex="0" class="slds-popover slds-popover_edit" role="dialog"
                                             style="position: absolute; top: 0px;width:max-content;">
                                        <div class="slds-popover__body">
                                            <div class="slds-form-element slds-grid slds-wrap">
                                                <div class="slds-form-element__control slds-grow">
                                                    <ui:inputNumber class="slds-input inputWidth"
                                                                    labelClass="slds-form-element__label slds-form-element__label_edit slds-no-flex"
                                                                    aura:id="inputPCBPId" blur="{!c.closePCBPBox}"
                                                                    change="{!c.onCISUChange}"
                                                                    value="{!v.singleRec.Phoenix_ProposedContractBidPriceMktng__c}" />
                                                </div>
                                            </div>
                                        </div>
                                        <span id="form-end" tabindex="0"></span>
                                    </section>
                                </aura:set>
                            </aura:if>
                        </span>
                    </td>
                    <td ondblclick="{!c.inlineEditProPerUnitRebate}">
                        <span class="slds-grid slds-grid_align-spread">
                            <aura:if isTrue="{!v.PPUREditMode == false}">
                                <span class="">
                                    <!-- <lightning:formattedNumber value="{!v.singleRec.Phoenix_Proposed_Per_Unit_Rebate__c}" style="currency" currencyCode="USD"/>-->
                                    <lightning:formattedNumber value="{!v.singleRec.Phoenix_Proposed_Per_Unit_Rebate__c}"
                                                               style="currency" currencyCode="USD" />
                                    
                                </span>
                                
                                <button onclick="{!c.inlineEditProPerUnitRebate}"
                                        class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small"
                                        tabindex="0">
                                    <lightning:icon iconName="utility:edit" size="xx-small" />
                                </button>
                                <aura:set attribute="else">
                                    <section tabindex="0" class="slds-popover slds-popover_edit" role="dialog"
                                             style="position: absolute; top: 0px;width:max-content;">
                                        <div class="slds-popover__body">
                                            <div class="slds-form-element slds-grid slds-wrap">
                                                <div class="slds-form-element__control slds-grow">
                                                    <ui:inputNumber class="slds-input inputWidth"
                                                                    labelClass="slds-form-element__label slds-form-element__label_edit slds-no-flex"
                                                                    aura:id="inputPPURId" blur="{!c.closePPURBox}"
                                                                    change="{!c.onCISUChange}"
                                                                    value="{!v.singleRec.Phoenix_Proposed_Per_Unit_Rebate__c}" />
                                                </div>
                                            </div>
                                        </div>
                                        <span id="form-end" tabindex="0"></span>
                                    </section>
                                </aura:set>
                            </aura:if>
                        </span>
                    </td>
                    <aura:set attribute="else">
                        
                        <aura:if  isTrue="{!and(v.bidType !='OTC OTB Good Dated',and(v.bidType !='OTC OTB Short Dated',v.bidType !='OTC New Product'))}">
                            <td class="slds-text-align_right">
                                <lightning:formattedNumber value="{!v.singleRec.Phoenix_Reduc_in_NCP_McK_And_RAD__c}" style="percent-fixed"  maximumFractionDigits="2"  />
                            </td>
                        </aura:if>
                        <td class="slds-text-align_right">
                            <div
                                 style="{!lessthan(v.singleRec.Phoenix_ProposedContractBidPriceMktng__c,v.singleRec.Phoenix_Lowest_Price_SKU__c)?'color:red':''}">
                                <lightning:formattedNumber
                                                           title="{!lessthan(v.singleRec.Phoenix_ProposedContractBidPriceMktng__c,v.singleRec.Phoenix_Lowest_Price_SKU__c)?'Proposed Sell Price is less than Lowest Price / SKU (OTC)':''}"
                                                           value="{!v.singleRec.Phoenix_ProposedContractBidPriceMktng__c}" style="currency" maximumFractionDigits="2"
                                                           currencyCode="USD" />
                            </div>
                        </td>
                        <td class="slds-text-align_right">
                            <lightning:formattedNumber value="{!v.singleRec.Phoenix_Proposed_Per_Unit_Rebate__c}"
                                                       style="currency" currencyCode="USD" maximumFractionDigits="2"/>
                        </td>
                    </aura:set>
                </aura:if>
            </aura:if>
        </aura:if>
        <aura:if  isTrue="{!v.bidType =='OTC Rebate Change'}">
            <td class="slds-text-align_right">
                <lightning:formattedNumber value="{!v.singleRec.Phoenix_Reduction_in_NCP_WMT__c}" style="percent-fixed"  maximumFractionDigits="2"  />
            </td>
        </aura:if>
        <aura:if isTrue="{!or(and(v.BidAprrovalStatus=='Draft',v.bidType!= 'OTC Volume Review'), and(or(v.BidAprrovalStatus=='SCM &amp; Marketing',v.BidAprrovalStatus=='Marketing'),and(or(v.isdeligationApprover,v.isMarketingApprovePerson==v.singleRec.Phoenix_Product_Director__c), and(v.singleRec.Phoenix_Marketing_Final_Approval__c!=true,v.bidType!= 'OTC Volume Review'))))}">
            <td ondblclick="{!c.editadminFee}">
                <span class="slds-grid slds-grid_align-spread">
                    <aura:if isTrue="{!v.adminFeeEditMode == false}">
                        <span class="">
                            
                            <lightning:formattedNumber value="{!v.singleRec.Phoenix_Current_Admin_Fee__c}" style="percent-fixed" 
                                                       maximumFractionDigits="2" />
                            
                        </span>
                        <button onclick="{!c.editadminFee}"
                                class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small"
                                tabindex="0">
                            <lightning:icon iconName="utility:edit" size="xx-small" />
                        </button>
                        <aura:set attribute="else">
                            <section tabindex="0" class="slds-popover slds-popover_edit" role="dialog"
                                     style="position: absolute; top: 0px;width:max-content;">
                                <div class="slds-popover__body">
                                    <div class="slds-form-element slds-grid slds-wrap">
                                        <div class="slds-form-element__control slds-grow">
                                            <ui:inputCurrency class="slds-input inputWidth"
                                                              labelClass="slds-form-element__label slds-form-element__label_edit slds-no-flex"
                                                              aura:id="adminFeeId" blur="{!c.closeadminFee}"
                                                              change="{!c.onCISUChange}"
                                                              value="{!v.singleRec.Phoenix_Current_Admin_Fee__c}" />
                                        </div>
                                    </div>
                                </div>
                                <span id="form-end" tabindex="0"></span>
                            </section>
                        </aura:set>
                    </aura:if>
                </span>
                
            </td>    
            <aura:set attribute="else">
                <td class="slds-text-align_right">
                    <lightning:formattedNumber value="{!v.singleRec.Phoenix_Current_Admin_Fee__c}" style="percent-fixed"  maximumFractionDigits="2" />
                </td>
            </aura:set>
        </aura:if>
        
        <!--  <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.singleRec.Phoenix_Current_Admin_Fee__c}" style="percent-fixed"  maximumFractionDigits="2"/></td> -->
        <aura:if isTrue="{!or(and(v.BidAprrovalStatus=='Draft',v.bidType!= 'OTC Volume Review'), and(or(v.BidAprrovalStatus=='SCM &amp; Marketing',v.BidAprrovalStatus=='Marketing'),and(or(v.isdeligationApprover,v.isMarketingApprovePerson==v.singleRec.Phoenix_Product_Director__c), and(v.singleRec.Phoenix_Marketing_Final_Approval__c!=true,v.bidType!= 'OTC Volume Review'))))}">
            <td ondblclick="{!c.inlineEditFeeType}">
                <span class="slds-grid slds-grid_align-spread">
                    <aura:if isTrue="{!v.feeTypeEdit == false}">
                        <span class=""  >{!v.singleRec.Phoenix_Fee_G_N__c}</span>
                        <button onclick="{!c.inlineEditFeeType}" class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small" tabindex="0"  >
                            <lightning:icon iconName="utility:edit" size="xx-small" />
                        </button>
                        <aura:set attribute="else">
                            <section  tabindex="0" class="slds-popover slds-popover_edit" role="dialog" style="position: absolute; top: 0px;width:max-content;">
                                <div class="slds-popover__body">
                                    <div class="slds-form-element slds-grid slds-wrap">
                                        <div class="slds-form-element__control slds-grow">
                                            <lightning:select name="feeType"
                                                              aura:id="inputFeeTypeId"
                                                              onblur="{!c.closeFeeTypeBox}"
                                                              onchange="{!c.onCISUChange}"
                                                              >
                                                <option value="{!v.singleRec.Phoenix_Fee_G_N__c}">{!v.singleRec.Phoenix_Fee_G_N__c}</option>
                                                <aura:if isTrue="{!(v.singleRec.Phoenix_Fee_G_N__c != null)}" >
                                                    <option value="None"></option>
                                                </aura:if>
                                                <aura:if isTrue="{!(v.singleRec.Phoenix_Fee_G_N__c != 'Gross')}" >
                                                    <option value="Gross">Gross</option>
                                                </aura:if>
                                                <aura:if isTrue="{!(v.singleRec.Phoenix_Fee_G_N__c != 'Net')}" >
                                                    <option value="Net">Net</option>
                                                </aura:if>
                                            </lightning:select>
                                        </div>
                                    </div>
                                </div>
                                <span id="form-end" tabindex="0"></span>
                            </section>
                        </aura:set>
                    </aura:if>
                </span>
            </td>
            <aura:set attribute="else">
                <td>
                    {!v.singleRec.Phoenix_Fee_G_N__c}
                </td>
                
            </aura:set>
        </aura:if>
        <td class="slds-text-align_right">
            <lightning:formattedNumber value="{!v.singleRec.Phoenix_Admin_Fee_in__c}" style="currency" currencyCode="USD" maximumFractionDigits="2" />
        </td>
        <aura:if  isTrue="{!and(v.bidType !='OTC OTB Good Dated',and(v.bidType !='OTC OTB Short Dated',v.bidType !='OTC New Product'))}">
            <td class="slds-text-align_right">
                <lightning:formattedNumber value="{!v.singleRec.Phoenix_Current_Rebate__c}" style="percent-fixed"
                                           maximumFractionDigits="2" />
            </td>
        </aura:if>
        <aura:if isTrue="{!or(and(v.BidAprrovalStatus=='Draft',v.bidType!= 'OTC Volume Review'), and(or(v.BidAprrovalStatus=='SCM &amp; Marketing',v.BidAprrovalStatus=='Marketing'),and(or(v.isdeligationApprover,v.isMarketingApprovePerson==v.singleRec.Phoenix_Product_Director__c), and(v.singleRec.Phoenix_Marketing_Final_Approval__c!=true,v.bidType!= 'OTC Volume Review'))))}">
            <td ondblclick="{!c.inlineEditProCurRebate}">
                <span class="slds-grid slds-grid_align-spread">
                    <aura:if isTrue="{!v.PCREditMode == false}">
                        <span class="">
                            <!--  <lightning:formattedNumber value="{!v.singleRec.Phoenix_Proposed_Current_Rebate__c}" style="percent-fixed" />-->
                            <aura:if isTrue="{!not(empty(v.singleRec.Phoenix_Proposed_Current_Rebate__c))}">
                                <lightning:formattedNumber value="{!v.singleRec.Phoenix_Proposed_Current_Rebate__c}"
                                                           style="percent-fixed" maximumFractionDigits="2" />
                                <aura:set attribute="else">
                                    <lightning:formattedNumber value="{!v.singleRec.Phoenix_Proposed_Current_Rebate__c}"
                                                               style="percent-fixed" maximumFractionDigits="2" />
                                </aura:set>
                            </aura:if>
                        </span>
                        <button onclick="{!c.inlineEditProCurRebate}"
                                class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small"
                                tabindex="0">
                            <lightning:icon iconName="utility:edit" size="xx-small" />
                        </button>
                        <aura:set attribute="else">
                            <section tabindex="0" class="slds-popover slds-popover_edit" role="dialog"
                                     style="position: absolute; top: 0px;width:max-content;">
                                <div class="slds-popover__body">
                                    <div class="slds-form-element slds-grid slds-wrap">
                                        <div class="slds-form-element__control slds-grow">
                                            <ui:inputNumber class="slds-input inputWidth"
                                                            labelClass="slds-form-element__label slds-form-element__label_edit slds-no-flex"
                                                            aura:id="inputPCRId" blur="{!c.closeProCurRebateBox}"
                                                            change="{!c.onCISUChange}"
                                                            value="{!v.singleRec.Phoenix_Proposed_Current_Rebate__c}" />
                                        </div>
                                    </div>
                                </div>
                                <span id="form-end" tabindex="0"></span>
                            </section>
                        </aura:set>
                    </aura:if>
                </span>
            </td>
            <aura:set attribute="else">
                <td class="slds-text-align_right">
                    <lightning:formattedNumber value="{!v.singleRec.Phoenix_Proposed_Current_Rebate__c}"
                                               style="percent-fixed" maximumFractionDigits="2" />
                </td>
            </aura:set>
        </aura:if>
        <aura:if isTrue="{!or(and(v.BidAprrovalStatus=='Draft',v.bidType!= 'OTC Volume Review'), and(or(v.BidAprrovalStatus=='SCM &amp; Marketing',v.BidAprrovalStatus=='Marketing'),and(or(v.isdeligationApprover,v.isMarketingApprovePerson==v.singleRec.Phoenix_Product_Director__c), and(v.singleRec.Phoenix_Marketing_Final_Approval__c!=true,v.bidType!= 'OTC Volume Review'))))}">
            <td ondblclick="{!c.inlineEditRebateType}">
                <span class="slds-grid slds-grid_align-spread">
                    <aura:if isTrue="{!v.rebateTypeEdit == false}">
                        <span class=""  >{!v.singleRec.Phoenix_Rebate_G_N__c}</span>
                        <button onclick="{!c.inlineEditRebateType}" class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small" tabindex="0"  >
                            <lightning:icon iconName="utility:edit" size="xx-small" />
                        </button>
                        <aura:set attribute="else">
                            <section  tabindex="0" class="slds-popover slds-popover_edit" role="dialog" style="position: absolute; top: 0px;width:max-content;">
                                <div class="slds-popover__body">
                                    <div class="slds-form-element slds-grid slds-wrap">
                                        <div class="slds-form-element__control slds-grow">
                                            <lightning:select name="rebateType"
                                                              aura:id="inputRebateTypeId"
                                                              onblur="{!c.closeRebateTypeBox}"
                                                              onchange="{!c.onCISUChange}"
                                                              >
                                                <option value="{!v.singleRec.Phoenix_Rebate_G_N__c}">{!v.singleRec.Phoenix_Rebate_G_N__c}</option>
                                                <aura:if isTrue="{!(v.singleRec.Phoenix_Rebate_G_N__c != null)}" >
                                                    <option value="None"></option>
                                                </aura:if>
                                                <aura:if isTrue="{!(v.singleRec.Phoenix_Rebate_G_N__c != 'Gross')}" >
                                                    <option value="Gross">Gross</option>
                                                </aura:if>
                                                <aura:if isTrue="{!(v.singleRec.Phoenix_Rebate_G_N__c != 'Net')}" >
                                                    <option value="Net">Net</option>
                                                </aura:if>
                                            </lightning:select>                                          
                                        </div>
                                    </div>
                                </div>
                                <span id="form-end" tabindex="0"></span>
                            </section>
                        </aura:set>
                    </aura:if>
                </span>
            </td> 
            <aura:set attribute="else">
                <td>{!v.singleRec.Phoenix_Rebate_G_N__c}</td>
            </aura:set>
        </aura:if>
        <td class="slds-text-align_right">
            <lightning:formattedNumber value="{!v.singleRec.Phoenix_Rebate_Perc_In__c}"
                                       style="currency" currencyCode="USD" maximumFractionDigits="2" />
        </td>
        
        
        <!--damages-->
        <aura:if isTrue="{!or(and(v.BidAprrovalStatus=='Draft',v.bidType!= 'OTC Volume Review'), and(or(v.BidAprrovalStatus=='SCM &amp; Marketing',v.BidAprrovalStatus=='Marketing'),and(or(v.isdeligationApprover,v.isMarketingApprovePerson==v.singleRec.Phoenix_Product_Director__c), and(v.singleRec.Phoenix_Marketing_Final_Approval__c!=true,v.bidType!= 'OTC Volume Review'))))}">
            <td ondblclick="{!c.inlineEditDamage}">
                <span class="slds-grid slds-grid_align-spread">
                    <aura:if isTrue="{!v.damageEditMode == false}">
                        <span class="">
                            <!--  <lightning:formattedNumber value="{!v.singleRec.Phoenix_Proposed_Current_Rebate__c}" style="percent-fixed" />-->
                            <lightning:formattedNumber value="{!v.singleRec.Phoenix_Reduction__c}" style="percent-fixed" maximumFractionDigits="2" />
                        </span>
                        <button onclick="{!c.inlineEditDamage}"
                                class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small"
                                tabindex="0">
                            <lightning:icon iconName="utility:edit" size="xx-small" />
                        </button>
                        <aura:set attribute="else">
                            <section tabindex="0" class="slds-popover slds-popover_edit" role="dialog"
                                     style="position: absolute; top: 0px;width:max-content;">
                                <div class="slds-popover__body">
                                    <div class="slds-form-element slds-grid slds-wrap">
                                        <div class="slds-form-element__control slds-grow">
                                            <ui:inputNumber class="slds-input inputWidth"
                                                            labelClass="slds-form-element__label slds-form-element__label_edit slds-no-flex"
                                                            aura:id="inputDamageId" blur="{!c.closeDamageBox}"
                                                            change="{!c.onCISUChange}"
                                                            value="{!v.singleRec.Phoenix_Reduction__c}" />
                                        </div>
                                    </div>
                                </div>
                                <span id="form-end" tabindex="0"></span>
                            </section>
                        </aura:set>
                    </aura:if>
                </span>
            </td>
            <aura:set attribute="else">
                <td class="slds-text-align_right">
                    <lightning:formattedNumber value="{!v.singleRec.Phoenix_Reduction__c}" style="percent-fixed" maximumFractionDigits="2" />
                </td>
            </aura:set>
        </aura:if>
        <td class="slds-text-align_right">
            <lightning:formattedNumber value="{!v.singleRec.Phoenix_Current_Anda_CP_Price__c}"
                                       style="currency" currencyCode="USD" maximumFractionDigits="2" />
        </td>
        <!-- -->
        <!--VIP-->
        <aura:if isTrue="{!or(and(v.BidAprrovalStatus=='Draft',v.bidType!= 'OTC Volume Review'), and(or(v.BidAprrovalStatus=='SCM &amp; Marketing',v.BidAprrovalStatus=='Marketing'),and(or(v.isdeligationApprover,v.isMarketingApprovePerson==v.singleRec.Phoenix_Product_Director__c), and(v.singleRec.Phoenix_Marketing_Final_Approval__c!=true,v.bidType!= 'OTC Volume Review'))))}">
            <td ondblclick="{!c.editVIP}">
                <span class="slds-grid slds-grid_align-spread">
                    <aura:if isTrue="{!v.vipEditMode == false}">
                        <span class="">
                            
                            <lightning:formattedNumber value="{!v.singleRec.Phoenix_Proposed_Est_VIP__c}" style="percent-fixed" 
                                                       maximumFractionDigits="2" />
                            
                        </span>
                        <button onclick="{!c.editVIP}"
                                class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small"
                                tabindex="0">
                            <lightning:icon iconName="utility:edit" size="xx-small" />
                        </button>
                        <aura:set attribute="else">
                            <section tabindex="0" class="slds-popover slds-popover_edit" role="dialog"
                                     style="position: absolute; top: 0px;width:max-content;">
                                <div class="slds-popover__body">
                                    <div class="slds-form-element slds-grid slds-wrap">
                                        <div class="slds-form-element__control slds-grow">
                                            <ui:inputCurrency class="slds-input inputWidth"
                                                              labelClass="slds-form-element__label slds-form-element__label_edit slds-no-flex"
                                                              aura:id="vipId" blur="{!c.closeVIP}"
                                                              change="{!c.onCISUChange}"
                                                              value="{!v.singleRec.Phoenix_Proposed_Est_VIP__c}" />
                                        </div>
                                    </div>
                                </div>
                                <span id="form-end" tabindex="0"></span>
                            </section>
                        </aura:set>
                    </aura:if>
                </span>
                
            </td>    
            <aura:set attribute="else">
                <td class="slds-text-align_right">
                    <lightning:formattedNumber value="{!v.singleRec.Phoenix_Proposed_Est_VIP__c}" style="percent-fixed"  maximumFractionDigits="2" />
                </td>
            </aura:set>
        </aura:if>
        
        
        
        
        
        <!--  <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.singleRec.Phoenix_Proposed_Est_VIP__c}" style="percent-fixed"  maximumFractionDigits="2"/></td> -->
        <td class="slds-text-align_right">
            <lightning:formattedNumber value="{!v.singleRec.Phoenix_Anda_VIP__c}"
                                       style="currency" currencyCode="USD" maximumFractionDigits="2" />
        </td>
        <!-- -->
        <!-- CD-->
        <aura:if isTrue="{!or(and(v.BidAprrovalStatus=='Draft',v.bidType!= 'OTC Volume Review'), and(or(v.BidAprrovalStatus=='SCM &amp; Marketing',v.BidAprrovalStatus=='Marketing'),and(or(v.isdeligationApprover,v.isMarketingApprovePerson==v.singleRec.Phoenix_Product_Director__c), and(v.singleRec.Phoenix_Marketing_Final_Approval__c!=true,v.bidType!= 'OTC Volume Review'))))}">
            <td ondblclick="{!c.editCashTerms}">
                <span class="slds-grid slds-grid_align-spread">
                    <aura:if isTrue="{!v.cdEditMode == false}">
                        <span class="">
                            
                            <lightning:formattedNumber value="{!v.singleRec.Phoenix_Cash_Terms__c}" style="percent-fixed" 
                                                       maximumFractionDigits="2" />
                            
                        </span>
                        <button onclick="{!c.editCashTerms}"
                                class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small"
                                tabindex="0">
                            <lightning:icon iconName="utility:edit" size="xx-small" />
                        </button>
                        <aura:set attribute="else">
                            <section tabindex="0" class="slds-popover slds-popover_edit" role="dialog"
                                     style="position: absolute; top: 0px;width:max-content;">
                                <div class="slds-popover__body">
                                    <div class="slds-form-element slds-grid slds-wrap">
                                        <div class="slds-form-element__control slds-grow">
                                            <ui:inputCurrency class="slds-input inputWidth"
                                                              labelClass="slds-form-element__label slds-form-element__label_edit slds-no-flex"
                                                              aura:id="cashTermsId" blur="{!c.closeCashTerms}"
                                                              change="{!c.onCISUChange}"
                                                              value="{!v.singleRec.Phoenix_Cash_Terms__c}" />
                                        </div>
                                    </div>
                                </div>
                                <span id="form-end" tabindex="0"></span>
                            </section>
                        </aura:set>
                    </aura:if>
                </span>
                
            </td>    
            <aura:set attribute="else">
                <td class="slds-text-align_right">
                    <lightning:formattedNumber value="{!v.singleRec.Phoenix_Cash_Terms__c}" style="percent-fixed"  maximumFractionDigits="2" />
                </td>
            </aura:set>
        </aura:if>
        <td class="slds-text-align_right">
            <lightning:formattedNumber value="{!v.singleRec.Phoenix_Cash_Terms_RxSS__c}"
                                       style="currency" currencyCode="USD" maximumFractionDigits="2" />
        </td>
        <!-- -->
        <td class="slds-text-align--right">
            <div style="{!(v.isAccpetable ? ('color:green') : (v.isNotAccpetable ?'color:red': ''))}">
                <lightning:formattedNumber title="{!(v.isAccpetable ? 'Net Price is greater than LE+10 %(LE) or BASP+10 %(BASP)': v.isNotAccpetable ? 'Net Price is less than LE-10% of LE (or) BASP-10% of BASP': '')}"
                                           value="{!v.singleRec.Phoenix_Internal_Dead_Net_Price__c}"
                                           
                                           style="currency" currencyCode="USD" />
            </div>
        </td>
        <td class="slds-text-align_right">
            <lightning:formattedNumber value="{!v.singleRec.Proposed_TPT_Direct__c}"
                                       style="currency" currencyCode="USD" maximumFractionDigits="2" />
        </td>
        <td class="slds-text-align_right">
            <lightning:formattedNumber value="{!v.singleRec.Proposed_TPT_Per_Direct__c}"
                                       style="percent-fixed"  maximumFractionDigits="2" />
        </td>
        
        <td class="slds-text-align_right">
            <lightning:formattedNumber value="{!v.singleRec.Phoenix_Net_Sales_External__c}" style="currency"
                                       currencyCode="USD" minimumFractionDigits="0" maximumFractionDigits="0" />
        </td>
        <td class="slds-text-align_right">
            <lightning:formattedNumber value="{!v.singleRec.Phoenix_Net_Sales_Internal__c}" style="currency"
                                       currencyCode="USD" minimumFractionDigits="0" maximumFractionDigits="0" />
        </td>
        <td class="slds-text-align_right">
            <lightning:formattedNumber value="{!v.singleRec.Phoenix_Th_Put_Margin__c}" style="currency"
                                       currencyCode="USD" minimumFractionDigits="0" />
        </td>
        
        <td class="slds-text-align_right">
            <lightning:formattedNumber value="{!v.singleRec.Phoenix_Current_Net_Indirect_Price__c}" style="currency"
                                       minimumFractionDigits="0" maximumFractionDigits="0" />
        </td>
        <td class="slds-text-align_right">
            <lightning:formattedNumber value="{!v.singleRec.Phoenix_Sales_Proposed_NCP_McK_And_RAD__c}" style="currency"
                                       maximumFractionDigits="4" />
        </td>
        <aura:if isTrue="{!or(v.BidAprrovalStatus=='Draft', and(or(v.BidAprrovalStatus=='SCM &amp; Marketing',v.BidAprrovalStatus=='Marketing'),and(or(v.isdeligationApprover,v.isMarketingApprovePerson==v.singleRec.Phoenix_Product_Director__c), v.singleRec.Phoenix_Marketing_Final_Approval__c!=true)))}">
            <td ondblclick="{!c.inlineOpeningOrder}">
                <span class="slds-grid slds-grid_align-spread">
                    <aura:if isTrue="{!v.OpeningOrderEditMode == false}">
                        <span class="">
                            
                            <lightning:formattedNumber value="{!v.singleRec.Phoenix_Current_Retail_Direct_Price__c}" style="currency" currencyCode="USD"
                                                       maximumFractionDigits="2" />
                            
                        </span>
                        <button onclick="{!c.inlineOpeningOrder}"
                                class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small"
                                tabindex="0">
                            <lightning:icon iconName="utility:edit" size="xx-small" />
                        </button>
                        <aura:set attribute="else">
                            <section tabindex="0" class="slds-popover slds-popover_edit" role="dialog"
                                     style="position: absolute; top: 0px;width:max-content;">
                                <div class="slds-popover__body">
                                    <div class="slds-form-element slds-grid slds-wrap">
                                        <div class="slds-form-element__control slds-grow">
                                            <ui:inputCurrency class="slds-input inputWidth"
                                                              labelClass="slds-form-element__label slds-form-element__label_edit slds-no-flex"
                                                              aura:id="OpeningOrderId" blur="{!c.closeOpeningOrder}"
                                                              change="{!c.onCISUChange}"
                                                              value="{!v.singleRec.Phoenix_Current_Retail_Direct_Price__c}" />
                                        </div>
                                    </div>
                                </div>
                                <span id="form-end" tabindex="0"></span>
                            </section>
                        </aura:set>
                    </aura:if>
                </span>
            </td>            
            <td ondblclick="{!c.inlineRetailPrice}">
                <span class="slds-grid slds-grid_align-spread">
                    <aura:if isTrue="{!v.retailPriceEditMode == false}">
                        <span class="">
                            <lightning:formattedNumber value="{!v.singleRec.Phoenix_Current_Retail_Indirect_Price__c}"
                                                       style="currency" currencyCode="USD" maximumFractionDigits="2" />
                        </span>
                        <button onclick="{!c.inlineRetailPrice}"
                                class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small"
                                tabindex="0">
                            <lightning:icon iconName="utility:edit" size="xx-small" />
                        </button>
                        <aura:set attribute="else">
                            <section tabindex="0" class="slds-popover slds-popover_edit" role="dialog"
                                     style="position: absolute; top: 0px;width:max-content;">
                                <div class="slds-popover__body">
                                    <div class="slds-form-element slds-grid slds-wrap">
                                        <div class="slds-form-element__control slds-grow">
                                            <ui:inputCurrency  class="slds-input inputWidth"
                                                              labelClass="slds-form-element__label slds-form-element__label_edit slds-no-flex"
                                                              aura:id="retailPriceId" blur="{!c.closeRetailPrice}"
                                                              change="{!c.onCISUChange}"
                                                              value="{!v.singleRec.Phoenix_Current_Retail_Indirect_Price__c}" />
                                        </div>
                                    </div>
                                </div>
                                <span id="form-end" tabindex="0"></span>
                            </section>
                        </aura:set>
                    </aura:if>
                </span>
                
            </td>   
            <aura:set attribute="else">
                <td class="slds-text-align_right">
                    <lightning:formattedNumber value="{!v.singleRec.Phoenix_Current_Retail_Direct_Price__c}" style="currency" currencyCode="USD"
                                               maximumFractionDigits="2" />
                </td>
                <td class="slds-text-align_right">
                    <lightning:formattedNumber value="{!v.singleRec.Phoenix_Current_Retail_Indirect_Price__c}"
                                               style="currency" currencyCode="USD" maximumFractionDigits="2" />
                </td>
            </aura:set>
        </aura:if>
        <td class="slds-text-align_right">
            <lightning:formattedNumber value="{!v.singleRec.Phoenix_Opening_Order_Net_sales__c}" style="currency"
                                       currencyCode="USD" minimumFractionDigits="0" maximumFractionDigits="0" />
        </td>
        <td class="slds-text-align_right">
            <lightning:formattedNumber value="{!v.singleRec.Phoenix_Opening_Order_TPT__c}" style="currency"
                                       currencyCode="USD" minimumFractionDigits="0" maximumFractionDigits="0" />
        </td>
        <td class="slds-text-align_right">
            <lightning:formattedNumber value="{!v.singleRec.Phoenix_Opening_Order_TPT_Per__c}" style="percent-fixed"
                                       maximumFractionDigits="2" minimumFractionDigits="2"/>
        </td>
        <td class="slds-text-align_right">
            <lightning:formattedNumber value="{!v.singleRec.Phoenix_Budgeted_ASP1__c}" style="currency"
                                       currencyCode="USD" maximumFractionDigits="2" />
        </td>
        <td class="slds-text-align_right">
            <lightning:formattedNumber value="{!v.singleRec.Phoenix_Proposed_to_Budget__c}" style="percent-fixed"
                                       maximumFractionDigits="2" />
        </td>
        <td class="slds-text-align_right">
            <lightning:formattedNumber value="{!v.singleRec.Phoenix_Latest_Estimate__c}" style="currency"
                                       currencyCode="USD" maximumFractionDigits="2" />
        </td>
        <td class="slds-text-align_right">
            <lightning:formattedNumber value="{!v.singleRec.Phoenix_Proposed_as_of_Latest_Estimate__c}"
                                       style="percent-fixed" maximumFractionDigits="2" />
        </td>
        <td class="slds-text-align_right">
            <lightning:formattedNumber value="{!v.singleRec.Phoenix_Lowest_Price_SKU__c}" style="currency"
                                       currencyCode="USD" maximumFractionDigits="2" />
        </td>
        <aura:if  isTrue="{!and(v.bidType !='OTC OTB Good Dated',and(v.bidType !='OTC OTB Short Dated',and(v.bidType !='OTC Price Change',v.bidType !='OTC Rebate Change')))}">
            <aura:if isTrue="{!and(v.BidAprrovalStatus=='Draft',v.loggedInUserName!=v.isMarketingApprovePerson)}">
                <td ondblclick="{!c.inlineEditISOV}">
                    <span class="slds-grid slds-grid_align-spread">
                        <aura:if isTrue="{!v.ISOVEditMode == false}">
                            <span class="">{!v.singleRec.Phoenix_Initial_Stocking_Order_Volume__c}</span>
                            <button onclick="{!c.inlineEditISOV}"
                                    class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small"
                                    tabindex="0">
                                <lightning:icon iconName="utility:edit" size="xx-small" alternativeText="edit" />
                            </button>
                            <aura:set attribute="else">
                                <section tabindex="0" class="slds-popover slds-popover_edit" role="dialog"
                                         style="position: absolute; top: 0px;width:max-content;">
                                    <div class="slds-popover__body">
                                        <div class="slds-form-element slds-grid slds-wrap">
                                            <div class="slds-form-element__control slds-grow">
                                                <ui:inputNumber class="slds-input inputWidth"
                                                                labelClass="slds-form-element__label slds-form-element__label_edit slds-no-flex"
                                                                aura:id="inputISOVId" blur="{!c.closeISOVBox}"
                                                                change="{!c.onCISUChange}"
                                                                value="{!v.singleRec.Phoenix_Initial_Stocking_Order_Volume__c}" />
                                            </div>
                                        </div>
                                    </div>
                                    <span id="form-end" tabindex="0"></span>
                                </section>
                            </aura:set>
                        </aura:if>
                    </span>
                </td>
                <td ondblclick="{!c.inlineEditISOC}">
                    <span class="slds-grid slds-grid_align-spread">
                        <aura:if isTrue="{!v.ISOCEditMode == false}">
                            <span class="">{!v.singleRec.Phoenix_Initial_Stocking_Order_Comments__c}</span>
                            <button onclick="{!c.inlineEditISOC}"
                                    class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small"
                                    tabindex="0">
                                <lightning:icon iconName="utility:edit" size="xx-small" alternativeText="edit" />
                            </button>
                            <aura:set attribute="else">
                                <section tabindex="0" class="slds-popover slds-popover_edit" role="dialog"
                                         style="position: absolute; top: 0px;width:max-content;">
                                    <div class="slds-popover__body">
                                        <div class="slds-form-element slds-grid slds-wrap">
                                            <div class="slds-form-element__control slds-grow">
                                                <ui:inputText class="slds-input inputWidth"
                                                              labelClass="slds-form-element__label slds-form-element__label_edit slds-no-flex"
                                                              aura:id="inputISOCId" blur="{!c.closeISOCBox}"
                                                              change="{!c.onCISUChange}"
                                                              value="{!v.singleRec.Phoenix_Initial_Stocking_Order_Comments__c}" />
                                            </div>
                                        </div>
                                    </div>
                                    <span id="form-end" tabindex="0"></span>
                                </section>
                            </aura:set>
                        </aura:if>
                    </span>
                </td>
                <aura:set attribute="else">
                    <td class="slds-text-align_right">{!v.singleRec.Phoenix_Initial_Stocking_Order_Volume__c}</td>
                    <td>{!v.singleRec.Phoenix_Initial_Stocking_Order_Comments__c}</td>
                </aura:set>
            </aura:if>
            <aura:if isTrue="{!and(and(v.singleRec.Phoenix_SCM_Approval_Y_N__c!='N- Not Approved',v.singleRec.Phoenix_SCM_Final_Approval__c==true),not(empty(v.singleRec.Phoenix_SCM_Approval_Y_N__c)))}">
                
                <td class="slds-text-align_right">
                    <div style="{!lessthan(v.singleRec.Phoenix_Total_SCM_Approved_Qty__c,v.singleRec.Phoenix_Final_Total_Selling_Unit__c)?'color:red':''}"><lightning:formattedNumber value="{!v.singleRec.Phoenix_Total_SCM_Approved_Qty__c}" maximumFractionDigits="0" minimumFractionDigits="0"/></div>
                </td>
                <td class="slds-text-align_right">{!v.singleRec.Phoenix_Estimated_Lead_Time_Days__c}</td>
                <td class="slds-text-align_right">{!v.singleRec.Phoenix_SCM_Approval_Y_N__c}</td>
                
                <td class="slds-text-align_right">{!v.singleRec.Phoenix_SCM_Notes__c}</td>
                <aura:set attribute="else">
                    <td class="slds-text-align_right"></td>
                    <td class="slds-text-align_right"></td>
                    <td class="slds-text-align_right"></td>
                    <td class="slds-text-align_right"></td>
                </aura:set>
            </aura:if>
        </aura:if>
        <aura:if isTrue="{!and(v.BidAprrovalStatus=='Draft',v.loggedInUserName!=v.isMarketingApprovePerson)}">
            <td ondblclick="{!c.inlineEditSalesNotes}">
                <span class="slds-grid slds-grid_align-spread">
                    <!-- show input and output section based on boolean flag -->
                    <aura:if isTrue="{!v.SalesNotesEditMode == false}">
                        <span class="">{!v.singleRec.Phoenix_Sales_Notes__c}</span>
                        <button onclick="{!c.inlineEditSalesNotes}"
                                class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small"
                                tabindex="0">
                            <lightning:icon iconName="utility:edit" size="xx-small" />
                        </button>
                        <!-- Inline Edit Section in else case-->
                        <aura:set attribute="else">
                            <section tabindex="0" class="slds-popover slds-popover_edit" role="dialog"
                                     style="position: absolute; top: 0px;width:max-content;">
                                <div class="slds-popover__body">
                                    <div class="slds-form-element slds-grid slds-wrap">
                                        <div class="slds-form-element__control slds-grow">
                                            <ui:inputText class="slds-input inputWidth"
                                                          labelClass="slds-form-element__label slds-form-element__label_edit slds-no-flex"
                                                          aura:id="inputSalesNoteId" blur="{!c.closeSalesNotesBox}"
                                                          change="{!c.onCISUChange}"
                                                          value="{!v.singleRec.Phoenix_Sales_Notes__c}" />
                                        </div>
                                    </div>
                                </div>
                                <span id="form-end" tabindex="0"></span>
                            </section>
                        </aura:set>
                    </aura:if>
                </span>
            </td>
            <aura:set attribute="else">
                <td class="slds-text-align_right">{!v.singleRec.Phoenix_Sales_Notes__c}</td>
            </aura:set>
        </aura:if>
        <aura:if isTrue="{!and(or(v.BidAprrovalStatus=='SCM &amp; Marketing',or(v.BidAprrovalStatus=='Marketing',v.BidAprrovalStatus=='Draft')),and(or(v.isdeligationApprover,v.isMarketingApprovePerson==v.singleRec.Phoenix_Product_Director__c),and(or(v.isdeligationApprover,v.loggedInUserName==v.singleRec.Phoenix_Product_Director__c),v.singleRec.Phoenix_Marketing_Final_Approval__c!=true)))}">
            <td ondblclick="{!c.inlineEditMarketingApproval}">
                <span class="slds-grid slds-grid_align-spread">
                    <aura:if isTrue="{!v.MarketApprovalEditMode == false}">
                        <span class="">{!v.singleRec.Phoenix_Marketing_Approval__c}</span>
                        <button onclick="{!c.inlineEditMarketingApproval}"
                                class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small"
                                tabindex="0">
                            <lightning:icon iconName="utility:edit" size="xx-small" />
                        </button>
                        <aura:set attribute="else">
                            <section tabindex="0" class="slds-popover slds-popover_edit" role="dialog"
                                     style="position: absolute; top: 0px;width:max-content;">
                                <div class="slds-popover__body">
                                    <div class="slds-form-element slds-grid slds-wrap">
                                        <div class="slds-form-element__control slds-grow">
                                            <lightning:select name="MarketApproval" aura:id="inputMarketApprovalId"
                                                              onblur="{!c.closeMarketApprovalBox}" onchange="{!c.onCISUChange}">
                                                <option value="{!v.singleRec.Phoenix_Marketing_Approval__c}">
                                                    {!v.singleRec.Phoenix_Marketing_Approval__c}</option>
                                                <aura:if
                                                         isTrue="{!(v.singleRec.Phoenix_Marketing_Approval__c != '--None--')}">
                                                    <option value="">--None--</option>
                                                </aura:if>
                                                <aura:if
                                                         isTrue="{!(v.singleRec.Phoenix_Marketing_Approval__c != 'Approved')}">
                                                    <option value="Approved">Approved</option>
                                                </aura:if>
                                                <aura:if
                                                         isTrue="{!(v.singleRec.Phoenix_Marketing_Approval__c != 'Not Approved')}">
                                                    <option value="Not Approved">Not Approved</option>
                                                </aura:if>
                                            </lightning:select>
                                        </div>
                                    </div>
                                </div>
                                <span id="form-end" tabindex="0"></span>
                            </section>
                        </aura:set>
                    </aura:if>
                </span>
            </td>
            <td ondblclick="{!c.inlineEditMarketingNotes}">
                <span class="slds-grid slds-grid_align-spread">
                    <aura:if isTrue="{!v.MarkNotesEditMode == false}">
                        <span class="">{!v.singleRec.Phoenix_Marketing_Notes__c}</span>
                        <button onclick="{!c.inlineEditMarketingNotes}"
                                class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small"
                                tabindex="0">
                            <lightning:icon iconName="utility:edit" size="xx-small" />
                        </button>
                        <aura:set attribute="else">
                            <section tabindex="0" class="slds-popover slds-popover_edit" role="dialog"
                                     style="position: absolute; top: 0px;width:max-content;">
                                <div class="slds-popover__body">
                                    <div class="slds-form-element slds-grid slds-wrap">
                                        <div class="slds-form-element__control slds-grow">
                                            <ui:inputText class="slds-input inputWidth"
                                                          labelClass="slds-form-element__label slds-form-element__label_edit slds-no-flex"
                                                          aura:id="inputMarketNotesId" blur="{!c.closeMarketNotesBox}"
                                                          change="{!c.onCISUChange}"
                                                          value="{!v.singleRec.Phoenix_Marketing_Notes__c}" />
                                        </div>
                                    </div>
                                </div>
                                <span id="form-end" tabindex="0"></span>
                            </section>
                        </aura:set>
                    </aura:if>
                </span>
            </td>
            <aura:set attribute="else">
                <td> {!v.singleRec.Phoenix_Marketing_Approval__c}</td>
                <td>{!v.singleRec.Phoenix_Marketing_Notes__c}</td>
            </aura:set>
        </aura:if>
        <aura:if  isTrue="{!or(v.bidType =='OTC Volume Review',v.bidType =='OTC OTB Short Dated')}">
            <aura:if isTrue="{!and(v.BidAprrovalStatus=='Marketing Lead OTC',and(v.isMarketLeadApprovePerson,v.singleRec.Phoenix_IsOTCLeadApproved__c !=true))}">
                <td ondblclick="{!c.inlineEditMarketingLeadApproval}">
                    <span class="slds-grid slds-grid_align-spread">
                        <aura:if isTrue="{!v.MarketLeadApprovalEditMode == false}">
                            <span class="">{!v.singleRec.Phoenix_Marketing_Lead_OTC__c}</span>
                            <button onclick="{!c.inlineEditMarketingLeadApproval}"
                                    class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small"
                                    tabindex="0">
                                <lightning:icon iconName="utility:edit" size="xx-small" />
                            </button>
                            <aura:set attribute="else">
                                <section tabindex="0" class="slds-popover slds-popover_edit" role="dialog"
                                         style="position: absolute; top: 0px;width:max-content;">
                                    <div class="slds-popover__body">
                                        <div class="slds-form-element slds-grid slds-wrap">
                                            <div class="slds-form-element__control slds-grow">
                                                <lightning:select name="MarketLeadApproval" aura:id="inputMarketLeadApprovalId"
                                                                  onblur="{!c.closeMarketLeadApprovalBox}" onchange="{!c.onCISUChange}">
                                                    <option value="{!v.singleRec.Phoenix_Marketing_Lead_OTC__c}">
                                                        {!v.singleRec.Phoenix_Marketing_Lead_OTC__c}</option>
                                                    <aura:if
                                                             isTrue="{!(v.singleRec.Phoenix_Marketing_Lead_OTC__c != '--None--')}">
                                                        <option value="">--None--</option>
                                                    </aura:if>
                                                    <aura:if
                                                             isTrue="{!(v.singleRec.Phoenix_Marketing_Lead_OTC__c != 'Approved')}">
                                                        <option value="Approved">Approved</option>
                                                    </aura:if>
                                                    <aura:if
                                                             isTrue="{!(v.singleRec.Phoenix_Marketing_Lead_OTC__c != 'Not Approved')}">
                                                        <option value="Not Approved">Not Approved</option>
                                                    </aura:if>
                                                </lightning:select>
                                            </div>
                                        </div>
                                    </div>
                                    <span id="form-end" tabindex="0"></span>
                                </section>
                            </aura:set>
                        </aura:if>
                    </span>
                </td>
                <td ondblclick="{!c.inlineEditMarketingLeadNotes}">
                    <span class="slds-grid slds-grid_align-spread">
                        <aura:if isTrue="{!v.MarkLeadNotesEditMode == false}">
                            <span class="">{!v.singleRec.Phoenix_Pricing_Notes__c}</span>
                            <button onclick="{!c.inlineEditMarketingLeadNotes}"
                                    class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small"
                                    tabindex="0">
                                <lightning:icon iconName="utility:edit" size="xx-small" />
                            </button>
                            <aura:set attribute="else">
                                <section tabindex="0" class="slds-popover slds-popover_edit" role="dialog"
                                         style="position: absolute; top: 0px;width:max-content;">
                                    <div class="slds-popover__body">
                                        <div class="slds-form-element slds-grid slds-wrap">
                                            <div class="slds-form-element__control slds-grow">
                                                <ui:inputText class="slds-input inputWidth"
                                                              labelClass="slds-form-element__label slds-form-element__label_edit slds-no-flex"
                                                              aura:id="inputMarketLeadNotesId" blur="{!c.closeMarketLeadNotesBox}"
                                                              change="{!c.onCISUChange}"
                                                              value="{!v.singleRec.Phoenix_Pricing_Notes__c}" />
                                            </div>
                                        </div>
                                    </div>
                                    <span id="form-end" tabindex="0"></span>
                                </section>
                            </aura:set>
                        </aura:if>
                    </span>
                </td>
                <aura:set attribute="else">
                    <td> {!v.singleRec.Phoenix_Marketing_Lead_OTC__c}</td>
                    <td>{!v.singleRec.Phoenix_Pricing_Notes__c}</td>
                </aura:set>
            </aura:if>  
        </aura:if>    
        <!--Customer-->
        <aura:if isTrue="{!and(v.BidAprrovalStatus=='Customer\'s Update',and(v.isCustomersApprovePerson,v.singleRec.Phoenix_Customer_Final_Approval__c !=true))}">
            <td ondblclick="{!c.EditcustApproval}">
                <span class="slds-grid slds-grid_align-spread">
                    <aura:if isTrue="{!v.custAppEditMode == false}">
                        <span class="">{!v.singleRec.Phoenix_Customer_Approval_OTC__c}</span>
                        <button onclick="{!c.EditcustApproval}"
                                class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small"
                                tabindex="0">
                            <lightning:icon iconName="utility:edit" size="xx-small" />
                        </button>
                        <aura:set attribute="else">
                            <section tabindex="0" class="slds-popover slds-popover_edit" role="dialog"
                                     style="position: absolute; top: 0px;width:max-content;">
                                <div class="slds-popover__body">
                                    <div class="slds-form-element slds-grid slds-wrap">
                                        <div class="slds-form-element__control slds-grow">
                                            <lightning:select name="custApproval" aura:id="inputCustApproval"
                                                              onblur="{!c.closeCustApp}" onchange="{!c.onCISUChange}">
                                                <option value="{!v.singleRec.Phoenix_Customer_Approval_OTC__c}">
                                                    {!v.singleRec.Phoenix_Customer_Approval_OTC__c}</option>
                                                <aura:if
                                                         isTrue="{!(v.singleRec.Phoenix_Customer_Approval_OTC__c != '--None--')}">
                                                    <option value="">--None--</option>
                                                </aura:if>
                                                <aura:if
                                                         isTrue="{!(v.singleRec.Phoenix_Customer_Approval_OTC__c != 'Approved')}">
                                                    <option value="Approved">Approved</option>
                                                </aura:if>
                                                <aura:if
                                                         isTrue="{!(v.singleRec.Phoenix_Customer_Approval_OTC__c != 'Not Approved')}">
                                                    <option value="Not Approved">Not Approved</option>
                                                </aura:if>
                                                <aura:if
                                                         isTrue="{!(v.singleRec.Phoenix_Customer_Approval_OTC__c != 'Send Back to Marketing')}">
                                                    <option value="Send Back to Marketing">Send Back to Marketing</option>
                                                </aura:if>
                                                
                                            </lightning:select>
                                        </div>
                                    </div>
                                </div>
                                <span id="form-end" tabindex="0"></span>
                            </section>
                        </aura:set>
                    </aura:if>
                </span>
            </td>
            <aura:set attribute="else">
                <td>{!v.singleRec.Phoenix_Customer_Approval_OTC__c}</td>
            </aura:set>
        </aura:if>
        <aura:if isTrue="{!and(v.BidAprrovalStatus=='Customer\'s Update',v.isCustomersApprovePerson)}">
            <td ondblclick="{!c.inlineEditCustComments}">
                <span class="slds-grid slds-grid_align-spread">
                    <aura:if isTrue="{!v.custCommentsEditMode == false}">
                        <span class="">{!v.singleRec.Phoenix_Customer_Service_Comments__c}</span>
                        <button onclick="{!c.inlineEditCustComments}"
                                class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small"
                                tabindex="0">
                            <lightning:icon iconName="utility:edit" size="xx-small" />
                        </button>
                        <aura:set attribute="else">
                            <section tabindex="0" class="slds-popover slds-popover_edit" role="dialog"
                                     style="position: absolute; top: 0px;width:max-content;">
                                <div class="slds-popover__body">
                                    <div class="slds-form-element slds-grid slds-wrap">
                                        <div class="slds-form-element__control slds-grow">
                                            <ui:inputText class="slds-input inputWidth"
                                                          labelClass="slds-form-element__label slds-form-element__label_edit slds-no-flex"
                                                          aura:id="inputCustCommentsId"
                                                          blur="{!c.closeCustCommentslBox}" change="{!c.onCISUChange}"
                                                          value="{!v.singleRec.Phoenix_Customer_Service_Comments__c}" />
                                        </div>
                                    </div>
                                </div>
                                <span id="form-end" tabindex="0"></span>
                            </section>
                        </aura:set>
                    </aura:if>
                </span>
            </td>
            <aura:if  isTrue="{!v.bidType !='OTC Rebate Change'}">
                <td >
                    <span class="slds-grid slds-grid_align-spread">
                        <aura:if isTrue="{!v.SEDEditMode == false}">
                            <span><lightning:formattedDateTime value="{!v.singleRec.Phoenix_Supply_Effective_Date__c}" year="numeric" month="numeric" day="numeric" timeZone="UTC"></lightning:formattedDateTime></span>
                            <button onclick="{!c.editSED}" class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small" tabindex="0"  >
                                <lightning:icon iconName="utility:edit" size="xx-small" />
                            </button>
                            <aura:set attribute="else">
                                <ui:inputDate class="dateInputWidth"
                                              aura:id="inputSEDId"
                                              labelClass="{!v.sNo}"
                                              displayDatePicker="true"
                                              change="{!c.onCISUChange}"
                                              value="{!v.singleRec.Phoenix_Supply_Effective_Date__c}"
                                              />
                                <!-- <lightning:input aura:id="inputSEDId" type="date" name="supplytype"  value="{!v.singleRec.Phoenix_Supply_Effective_Date__c}" 
                                             onblur="{!c.closeSED}" onchange="{!c.onCISUChange}" />-->
                                <!-- <ui:inputDate aura:id="inputSEDId"
                                          blur="{!c.closeSED}"
                                          displayDatePicker="true"
                                          value="{!v.singleRec.Phoenix_Supply_Effective_Date__c}"
                                          change="{!c.changeSEDDate}"
                                          />    -->  
                            </aura:set>
                        </aura:if>
                    </span>
                </td>
            </aura:if>
            <aura:if  isTrue="{!v.bidType !='OTC Volume Review'}">
                <td >
                    <span class="slds-grid slds-grid_align-spread">
                        <aura:if isTrue="{!v.PEDEditMode == false}">
                            <span><lightning:formattedDateTime value="{!v.singleRec.Phoenix_Price_Effective_Date__c}" year="numeric" month="numeric" day="numeric" timeZone="UTC"></lightning:formattedDateTime></span>
                            <button onclick="{!c.editPED}" class="slds-button slds-button_icon slds-cell-edit__button slds-m-left_x-small" tabindex="0"  >
                                <lightning:icon iconName="utility:edit" size="xx-small" />
                            </button>
                            <aura:set attribute="else">
                                <ui:inputDate class="dateInputWidth"
                                              aura:id="inputPEDId"
                                              labelClass="{!v.sNo}"
                                              displayDatePicker="true"
                                              change="{!c.onCISUChange}"
                                              value="{!v.singleRec.Phoenix_Price_Effective_Date__c}"
                                              />
                            </aura:set>
                        </aura:if>
                    </span>
                </td>
            </aura:if>
            <aura:set attribute="else">
                <td>{!v.singleRec.Phoenix_Customer_Service_Comments__c}</td>
                <aura:if  isTrue="{!v.bidType !='OTC Rebate Change'}">
                    <td><lightning:formattedDateTime value="{!v.singleRec.Phoenix_Supply_Effective_Date__c}" year="numeric" month="numeric" day="numeric" timeZone="UTC"></lightning:formattedDateTime></td>
                </aura:if>
                <aura:if  isTrue="{!v.bidType !='OTC Volume Review'}">
                    <td><lightning:formattedDateTime value="{!v.singleRec.Phoenix_Price_Effective_Date__c}" year="numeric" month="numeric" day="numeric" timeZone="UTC"></lightning:formattedDateTime></td>
                </aura:if>
            </aura:set>
        </aura:if>
        
        <!--end-->
        <aura:if  isTrue="{!v.bidType !='OTC Volume Review'}">
            <aura:if isTrue="{!v.singleRec.Phoenix_Final_Finance_Approval__c==true}">
                <td >{!v.singleRec.Phoenix_Finance_Approval__c}</td>
                <td>{!v.singleRec.Phoenix_Finance_Comments__c}</td>
                <aura:set attribute="else">
                    <td class="slds-text-align_right"></td>
                    <td class="slds-text-align_right"></td>
                </aura:set>
            </aura:if>
            <td class="slds-text-align_right"> {!v.singleRec.Phoenix_Contract_Approval__c}</td>
            <td class="slds-text-align_right">{!v.singleRec.Phoenix_Contract_Comments__c}</td>
        </aura:if>
        
        <td><lightning:button variant="base" label="PH" title="PH" onclick="{!c.displayBidHist}" name="{!v.singleRec.Id}"/></td>
        
        
        
    </tr>
    <aura:if isTrue="{!v.sNo==v.ItemsLength}">
        <tr>
            <th scope="row"><!--Delete --></th>
            <th scope="row"><!--NDC --></th>
            <th scope="row"><!--SAP --></th>
            <th scope="row"><!--Product name --></th>
            <th scope="row"><!--Pkg Size --></th>
            <th scope="row">Totals</th>
            <aura:if isTrue="{!v.isReBid}">
                <td class="slds-text-align_right"></td>
                <td class="slds-text-align_right"></td>
            </aura:if>
            <!-- <td></td>-->
            
            <td class="slds-text-align_right">  <lightning:icon iconName="standard:collection_variable" alternativeText="Summary of Bid" title="Summary of Bid"  size="medium" onclick="{!c.showTotalsMethod}"/></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <aura:if  isTrue="{!and(v.bidType !='OTC OTB Good Dated',and(v.bidType !='OTC OTB Short Dated',v.bidType !='OTC New Product'))}">
                <td></td>
            </aura:if>
            <td></td>
            <aura:if  isTrue="{!and(v.bidType !='OTC OTB Good Dated',and(v.bidType !='OTC OTB Short Dated',v.bidType !='OTC New Product'))}">
                <td class="slds-text-align_right"> <lightning:formattedNumber value="{!v.actSaDir12Months}" minimumFractionDigits="0" maximumFractionDigits="0"/></td>
                <td class="slds-text-align_right"> <lightning:formattedNumber value="{!v.CDSUTotal}" minimumFractionDigits="0" maximumFractionDigits="0"/><!--3M mon Anul Indir Units --></td>
                <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.overRideDirectUnits}" minimumFractionDigits="0" maximumFractionDigits="0"/></td>            
                <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.current52week}" minimumFractionDigits="0" maximumFractionDigits="0"/></td>   
                <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.currentMonthly}" minimumFractionDigits="0" maximumFractionDigits="0"/></td>   
            </aura:if>
            <aura:if isTrue="{!and(v.bidType!='OTC Price Change',v.bidType!='OTC Rebate Change')}">
                <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.actSalInd12months}" minimumFractionDigits="0" maximumFractionDigits="0"/></td>
                <td></td>
                <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.PDSUTotal}" minimumFractionDigits="0" maximumFractionDigits="0"/></td>
                
                <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.proposed52wk}" minimumFractionDigits="0" maximumFractionDigits="0"/></td>
                
                <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.proposedMonthly}" minimumFractionDigits="0" maximumFractionDigits="0"/></td>
                <aura:if  isTrue="{!and(v.bidType !='OTC OTB Good Dated',v.bidType !='OTC OTB Short Dated')}">
                    <aura:if isTrue="{!v.singleRec.Phoenix_SCM_Final_Approval__c}">
                        <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.finalUnitsTotal}" minimumFractionDigits="0" maximumFractionDigits="0"/></td>
                        <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.finaAnnuallUnits}" minimumFractionDigits="0" maximumFractionDigits="0"/></td>
                        <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.finalMontlyUnits}" minimumFractionDigits="0" maximumFractionDigits="0"/></td>
                        <aura:set attribute="else">
                            <td></td>
                            <td></td>
                            <td></td>
                        </aura:set>
                    </aura:if>
                </aura:if>
            </aura:if>
            <aura:if  isTrue="{!and(v.bidType !='OTC OTB Good Dated',and(v.bidType !='OTC OTB Short Dated',v.bidType !='OTC New Product'))}">
                <td><!--Current Sell Price --> </td>
            </aura:if>
            <aura:if  isTrue="{!and(v.bidType !='OTC OTB Good Dated',and(v.bidType !='OTC OTB Short Dated',v.bidType !='OTC New Product'))}">
                <td><!--Current Net Price --> </td>
                <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.currentSalesFinance}" style="currency" currencyCode="USD"
                                                                             minimumFractionDigits="0" maximumFractionDigits="0"/></td>
                
                <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.currentTPMargin}" style="currency" currencyCode="USD"
                                                                             minimumFractionDigits="0" maximumFractionDigits="0"/></td>
                <td class="slds-text-align_right"><lightning:formattedNumber value="{!(and(v.currentTPMargin != null,and(v.currentSalesFinance !=0 ,v.currentSalesFinance!=null)) ? (v.currentTPMargin/v.currentSalesFinance):0)}" style="percent" 
                                                                             minimumFractionDigits="2" maximumFractionDigits="2"/></td>
            </aura:if>
            
            <aura:if  isTrue="{!v.bidType =='OTC Rebate Change'}">
                <td><!-- Current Asp--></td>
            </aura:if>
            <aura:if  isTrue="{!and(v.bidType !='OTC Volume Review',v.bidType !='OTC Rebate Change')}">
                <td><!--Guidance Price --></td>
                <td><!--Sales Price --></td>
            </aura:if>
            <aura:if  isTrue="{!v.bidType !='OTC Rebate Change'}">
                <td><!-- Supply Tpe --></td>
            </aura:if>
            <aura:if  isTrue="{!v.bidType !='OTC Rebate Change'}">
                <aura:if  isTrue="{!v.bidType !='OTC Volume Review'}">
                    <aura:if  isTrue="{!and(v.bidType !='OTC OTB Good Dated',and(v.bidType !='OTC OTB Short Dated',v.bidType !='OTC New Product'))}">
                        <td><!-- Sell Price % Change--></td>
                    </aura:if>
                </aura:if>
                <aura:if  isTrue="{!v.bidType !='OTC Volume Review'}">
                    <td></td>
                    <td></td>
                </aura:if>
            </aura:if>
            <aura:if  isTrue="{!v.bidType =='OTC Rebate Change'}">
                <td><!-- Net Price % Change--></td>
            </aura:if>
            <td></td>
            <td></td>
            <td></td>
            <aura:if  isTrue="{!and(v.bidType !='OTC OTB Good Dated',and(v.bidType !='OTC OTB Short Dated',v.bidType !='OTC New Product'))}">
                <td></td>
            </aura:if>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td class="slds-text-align_right"><lightning:formattedNumber value="{!(and(v.ThptMrgnDTotal != null,and(v.netSalesIntTotal !=0 ,v.netSalesIntTotal!=null)) ? (v.ThptMrgnDTotal/v.netSalesIntTotal):0)}" style="percent" 
                                                                         minimumFractionDigits="2" maximumFractionDigits="2"/></td>
            
            <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.grossSalesTotal}" style="currency" currencyCode="USD"
                                                                         minimumFractionDigits="0" maximumFractionDigits="0"/></td>
            
            <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.netSalesIntTotal}" style="currency" currencyCode="USD"
                                                                         minimumFractionDigits="0" maximumFractionDigits="0"/></td>
            
            <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.ThptMrgnDTotal}" style="currency" currencyCode="USD"
                                                                         minimumFractionDigits="0" maximumFractionDigits="0"/></td>
            <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.totalProfit}" style="currency" currencyCode="USD"
                                                                         minimumFractionDigits="0" maximumFractionDigits="0"/></td>
            
            <td></td>
            <td></td>
            <td></td>
            <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.OpeningOrderNetSalesTotal}" style="currency" currencyCode="USD"
                                                                         minimumFractionDigits="0" maximumFractionDigits="0"/></td>
            
            <td class="slds-text-align_right"><lightning:formattedNumber value="{!v.OpeningOrderTPTTotal}" style="currency" currencyCode="USD"
                                                                         minimumFractionDigits="0" maximumFractionDigits="0"/></td>
            
            <td class="slds-text-align_right"><lightning:formattedNumber value="{!(and(v.OpeningOrderTPTTotal != null,and(v.OpeningOrderNetSalesTotal !=0 ,v.OpeningOrderNetSalesTotal!=null)) ? (v.OpeningOrderTPTTotal/v.OpeningOrderNetSalesTotal):0)}" style="percent" 
                                                                         minimumFractionDigits="2" maximumFractionDigits="2"/></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <aura:if  isTrue="{!and(v.bidType !='OTC OTB Good Dated',and(v.bidType !='OTC OTB Short Dated',and(v.bidType !='OTC Price Change',v.bidType !='OTC Rebate Change')))}">
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </aura:if>
            <td></td>
            <td></td>
            <td></td>
            <aura:if  isTrue="{!or(v.bidType =='OTC Volume Review',v.bidType =='OTC OTB Short Dated')}">
                <td></td>
                <td></td>
            </aura:if>
            <td></td>
            <td></td>
            <aura:if  isTrue="{!v.bidType !='OTC Rebate Change'}">
                <td></td>
            </aura:if>
            <aura:if  isTrue="{!v.bidType !='OTC Volume Review'}">
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </aura:if>
            <td></td>
        </tr>
    </aura:if>
</aura:component>